# -*- coding: utf-8 -*-
#
# Author:  Dominik Gresch <greschd@gmx.ch>
# Date:    15.10.2014 14:49:25 CEST
# File:    fp_phony.py

from common import *

import os
import re
import types
import shutil
import unittest

class BiEspressoTestCase(EspressoTestCase):
    def __init__(self, *args, **kwargs):
        self._input_folder = 'samples/espresso'

        self._input_files = [self._input_folder + '/input/' + name for name in
                             ['bi.nscf.in', 'bi.pw2wan.in', 'bi.win' ]]

        qedir = '/home/greschd/software/espresso-5.1.2/bin/'
        wandir = '/home/greschd/software/wannier90-1.2'
        mpirun = 'mpirun -np 4 '
        pwcmd = mpirun + qedir + '/pw.x '
        pw2wancmd = mpirun + qedir + '/pw2wannier90.x '
        wancmd = wandir + '/wannier90.x'
        self._z2cmd = (wancmd + ' bi -pp;' +
                       pwcmd + '< bi.nscf.in >& pw.log;' +
                       pw2wancmd + '< bi.pw2wan.in >& pw2wan.log;')

        super(BiEspressoTestCase, self).__init__(*args, **kwargs)

        self.system = z2pack.fp.System(
            self._input_files,
            [z2pack.fp.kpts.qe, z2pack.fp.kpts.wannier90],
            ['bi.nscf.in','bi.win'],
            self._z2cmd,
            executable='/bin/bash',
            mmn_path='bi.mmn',
            build_folder=self._build_folder + '/build')

    def setUp(self):
        scfdir = self._build_folder + '/scf'
        if os.path.isdir(scfdir):
            shutil.rmtree(scfdir)
        shutil.copytree(self._input_folder + '/scf', scfdir)

    def test_bismuth_0(self):
        surface = self.system.surface(lambda kx: [0, kx / 2, 0], [0, 0, 1], pickle_file=None)
        surface.wcc_calc(pos_tol=None, move_tol=None, verbose=False, num_strings=4)
        res = {'t_par': [0.0, 0.33333333333333331, 0.66666666666666663, 0.83333333333333326, 1.0], 'wcc': [[6.3141588123368836e-07, 0.15696321723245391, 0.15696529415637697, 0.49999732230739502, 0.49999951934079495, 0.50000090703032507, 0.50000473023724867, 0.84303590559080466, 0.84303792242658449, 0.99999970032178997], [0.043110891313918438, 0.067109240307916693, 0.26088416630186856, 0.30091006181872787, 0.46702190095532869, 0.53297834188854454, 0.69909001308081165, 0.73911609141989021, 0.93289156864550427, 0.95688886812685658], [0.046163238155185859, 0.10894340026789005, 0.24088700608583719, 0.30711836412209642, 0.43407042638237919, 0.5659279368231549, 0.69288085491668405, 0.75911157673224239, 0.89105562074174594, 0.95383637331072701], [0.042060120074314471, 0.12734787482949683, 0.22327722693897237, 0.31518186236438289, 0.41471238633216495, 0.58528840319460862, 0.68481812449954971, 0.77672480618694395, 0.87265210446775798, 0.95794097430441238], [1.6173479244672358e-05, 0.17388136651119304, 0.17390112393886878, 0.3590036931081127, 0.35902723956332339, 0.64096922155393043, 0.64099462408036567, 0.82609344277102137, 0.82611188380614353, 0.99999064806583127]], 'lambda_': [array([[  6.44710492e-02 +1.59234037e-07j,
         -1.92847568e-07 -7.75890968e-08j,
         -1.37011710e-01 -5.20304188e-01j,
          1.65343374e-01 -1.73885274e-01j,
          3.59399889e-01 +7.87354188e-02j,
          1.24027870e-01 -3.16632991e-01j,
         -2.75929456e-01 +1.06066194e-01j,
         -1.76460849e-01 -2.00481685e-01j,
         -1.57522263e-01 +6.82975654e-02j,
          3.50688466e-01 -2.94269837e-01j],
       [  1.44875624e-07 -9.59592194e-08j,
          6.44712214e-02 -3.45108171e-08j,
          1.55663435e-01 -1.82601706e-01j,
         -5.31770967e-01 -8.19164293e-02j,
          1.92715608e-01 +2.80178795e-01j,
         -3.32116815e-01 +1.58322455e-01j,
         -1.42583824e-01 +2.25833788e-01j,
          2.89216107e-01 +6.11563259e-02j,
          2.70191102e-01 +3.69557643e-01j,
          1.36633061e-01 +1.03968714e-01j],
       [  1.37013841e-01 -5.20306077e-01j,
         -1.55664524e-01 -1.82602126e-01j,
          5.51836494e-01 -9.76982274e-06j,
          1.76658206e-07 -1.06812589e-05j,
         -1.00282832e-01 -1.89610664e-02j,
          3.06407048e-02 -6.68861194e-02j,
          5.39981114e-02 -3.52871068e-03j,
         -1.77467983e-01 +6.42254070e-02j,
          2.66590500e-01 +2.78727051e-02j,
         -6.07500137e-02 -4.67435066e-01j],
       [ -1.65344004e-01 -1.73885913e-01j,
          5.31769933e-01 -8.19165460e-02j,
         -5.71622182e-07 -1.08029734e-05j,
          5.51835996e-01 -3.11422235e-09j,
          6.25593626e-02 -3.87085843e-02j,
         -3.12653704e-02 -9.71511558e-02j,
         -5.45539030e-02 +1.80685133e-01j,
         -6.08785987e-04 +5.41096785e-02j,
          4.19136061e-01 +2.15663720e-01j,
         -6.41832942e-02 +2.60245567e-01j],
       [  3.59399884e-01 -7.87357581e-02j,
          1.92716352e-01 -2.80178652e-01j,
          1.00281964e-01 -1.89590347e-02j,
         -6.25571001e-02 -3.87027949e-02j,
          5.00747532e-02 +1.83718185e-07j,
         -1.01680435e-06 +1.72241264e-06j,
         -2.89484988e-01 +3.65846783e-01j,
          1.73887690e-01 -2.87631452e-01j,
         -2.60570939e-01 -2.91814368e-01j,
         -4.86530343e-01 +1.01386478e-01j],
       [  1.24028215e-01 +3.16633015e-01j,
         -3.32116826e-01 -1.58322398e-01j,
         -3.06311062e-02 -6.68774332e-02j,
          3.12736704e-02 -9.71527957e-02j,
          4.83725876e-07 +2.38658705e-06j,
          5.00754497e-02 +1.62976781e-06j,
         -1.53171896e-01 -2.99170321e-01j,
         -2.62967823e-01 -3.85350638e-01j,
          3.87702700e-01 +3.10936192e-01j,
         -3.64547697e-01 +1.41973345e-01j],
       [ -2.75927327e-01 -1.06063564e-01j,
         -1.42582477e-01 -2.25834025e-01j,
         -5.39683871e-02 -3.53029136e-03j,
          5.45553341e-02 +1.80688502e-01j,
         -2.89477208e-01 -3.65849939e-01j,
         -1.53172833e-01 +2.99184002e-01j,
         -6.41443916e-01 +2.38015366e-06j,
         -1.84677247e-05 +1.06113461e-05j,
         -1.02538474e-01 +8.39994926e-02j,
          2.06520289e-01 -2.11422779e-02j],
       [ -1.76459785e-01 +2.00480906e-01j,
          2.89216237e-01 -6.11555316e-02j,
          1.77495522e-01 +6.42146470e-02j,
          6.19144687e-04 +5.40813034e-02j,
          1.73891558e-01 +2.87632803e-01j,
         -2.62954519e-01 +3.85352675e-01j,
          1.71246095e-05 +9.97536658e-06j,
         -6.41442559e-01 +8.39249111e-06j,
         -1.81986557e-01 -9.98861422e-02j,
         -6.17464027e-02 -1.17302080e-01j],
       [ -1.57519553e-01 -6.83014570e-02j,
          2.70192106e-01 -3.69558675e-01j,
         -2.66589266e-01 +2.78827906e-02j,
         -4.19134781e-01 +2.15667739e-01j,
         -2.60573129e-01 +2.91820637e-01j,
          3.87692135e-01 -3.10930595e-01j,
         -1.02544009e-01 -8.40011891e-02j,
         -1.82002511e-01 +9.98766158e-02j,
          7.87330686e-02 +5.34488260e-07j,
          2.13598809e-06 -3.06798415e-06j],
       [  3.50690068e-01 +2.94267270e-01j,
          1.36629095e-01 -1.03970975e-01j,
          6.07415668e-02 -4.67436103e-01j,
          6.41797791e-02 +2.60246947e-01j,
         -4.86526096e-01 -1.01379961e-01j,
         -3.64556688e-01 -1.41977741e-01j,
          2.06524082e-01 +2.11294127e-02j,
         -6.17412741e-02 +1.17293774e-01j,
         -2.99220913e-06 -2.59085372e-06j,
          7.87334246e-02 +1.90731622e-06j]]), array([[ 0.05758578-0.00205603j, -0.00147337+0.00298528j,
         0.12328696+0.06583025j,  0.15823877-0.34290962j,
        -0.40387413+0.01171059j,  0.38330011+0.24895337j,
        -0.26394517-0.06028902j, -0.37919038-0.03712858j,
         0.19391823+0.00635381j,  0.29120398+0.3484974j ],
       [ 0.00147332+0.00298531j,  0.05758588+0.00205597j,
         0.34705341+0.14893114j, -0.04756391+0.1314192j ,
         0.45584417-0.03320766j,  0.34814288+0.2050552j ,
        -0.09070259-0.37004867j,  0.09723084+0.25268267j,
         0.45360131+0.02229508j, -0.12195753-0.15089968j],
       [-0.22294584+0.10610276j, -0.52233699+0.24940792j,
        -0.00333196+0.07389139j,  0.05711044-0.0501419j ,
         0.18852481-0.05987655j, -0.05238450+0.25449426j,
         0.02380463+0.04539368j,  0.35178295+0.28949367j,
        -0.19699656-0.16516752j,  0.32979127+0.31792559j],
       [-0.22125839-0.53486977j,  0.09467260+0.2280341j ,
        -0.05711076-0.05014112j, -0.00333168-0.07389211j,
        -0.22320243+0.1330105j ,  0.00531568+0.19773375j,
        -0.04469019-0.45338873j,  0.02446294+0.04504273j,
        -0.28837878-0.35591463j, -0.14761128-0.21047378j],
       [-0.18586575-0.39577409j,  0.26329219-0.10249821j,
        -0.29374519-0.20433832j,  0.17950149+0.16331236j,
         0.19916412-0.09041351j, -0.15937774-0.09086638j,
        -0.15672976-0.10281211j,  0.08871331-0.01117958j,
         0.22985943+0.22933394j,  0.55083677+0.09261197j],
       [ 0.28007915-0.03720356j, -0.02807305-0.43634297j,
         0.09535290+0.22315716j,  0.09661135+0.34453801j,
         0.15937818-0.09086687j,  0.19916465+0.09041407j,
        -0.04448499-0.07756544j, -0.17645176-0.06324231j,
        -0.54065255-0.14033183j,  0.30345571-0.11551471j],
       [-0.27144080+0.14138129j,  0.06059762+0.13677206j,
         0.19711697+0.09247665j,  0.60101356+0.21363573j,
        -0.00093675+0.35926775j,  0.10834137-0.31966391j,
         0.33645205-0.05501049j, -0.06670340-0.13981554j,
         0.06242132-0.1856186j ,  0.05758173+0.06928722j],
       [-0.12675765-0.07944237j,  0.17856520-0.24856445j,
         0.51202055+0.38038283j, -0.18654608-0.11228302j,
        -0.32046492-0.10594842j, -0.28742149-0.21555021j,
         0.06670432-0.13981562j,  0.33645361+0.05501015j,
        -0.01694411+0.08848437j,  0.14432803+0.13236501j],
       [-0.34656196-0.16156495j,  0.13797126+0.2199132j ,
         0.37813572-0.06632806j, -0.19276234+0.02923748j,
         0.24651361-0.33136416j, -0.13233866+0.09291374j,
         0.16194997+0.30590094j, -0.51552664-0.04922623j,
        -0.07531419-0.08176213j,  0.05127185+0.03602311j],
       [-0.09230765-0.24264552j,  0.07998043-0.37391266j,
         0.01254590-0.19456374j,  0.03355455-0.38243795j,
         0.15874020+0.03079253j,  0.36031546+0.20185383j,
         0.47515935+0.20595131j,  0.28957730-0.1895995j ,
        -0.05127145+0.03602393j, -0.07531410+0.08176127j]]), array([[ 0.02392688+0.00427077j, -0.00309274+0.00247799j,
         0.19571759+0.07667843j,  0.10427381+0.04781972j,
        -0.34651675+0.42866624j, -0.32662796+0.18154396j,
        -0.18554737+0.23332747j, -0.06191074-0.3062118j ,
        -0.26594047-0.34306905j,  0.23345840-0.26302955j],
       [ 0.00309285+0.00247798j,  0.02392706-0.00427084j,
         0.05601326+0.10011155j, -0.09209886-0.18895095j,
        -0.03948185+0.37159702j,  0.25918614-0.48646744j,
         0.17419439-0.2593371j , -0.08234109-0.28651551j,
        -0.33505728-0.10688063j, -0.05339527+0.43077765j],
       [-0.48250595+0.22445307j, -0.10766689+0.26095092j,
         0.07931285-0.00986572j,  0.00571717-0.02954892j,
        -0.01338163+0.02877204j,  0.10391446-0.21611414j,
        -0.32566563+0.30852344j,  0.26571103-0.31169992j,
         0.01619488+0.41819309j, -0.14291738-0.08209778j],
       [-0.26873167+0.08643194j,  0.26235739-0.46298959j,
        -0.00571664-0.02955057j,  0.07931364+0.00986596j,
         0.16684573+0.17223904j,  0.02178255+0.02307478j,
         0.39843929-0.09489449j,  0.42287695-0.14973181j,
         0.13664314+0.09216996j,  0.38260108-0.16959902j],
       [-0.00345751-0.42200531j,  0.29160657+0.19467356j,
         0.20433974+0.29052064j, -0.28100236-0.00230861j,
         0.18286153+0.10659582j, -0.15715739-0.23411107j,
         0.06622544-0.09259745j,  0.08265900-0.06172128j,
         0.25134882-0.11643519j, -0.33654934-0.39488522j],
       [ 0.06525378+0.34449049j,  0.38710637+0.16807772j,
        -0.26735032-0.08655363j, -0.28562879+0.2111187j ,
         0.15716196-0.23410919j,  0.18286282-0.10659565j,
        -0.10220960+0.01398611j,  0.11215350+0.01954767j,
        -0.43649019-0.28049223j,  0.08164027-0.26470374j],
       [ 0.02617058-0.21491336j, -0.14604964+0.09035134j,
         0.43109355-0.31224305j,  0.28166779+0.28721955j,
         0.01365421-0.27077527j,  0.24464012-0.3800172j ,
         0.22628131+0.18603039j, -0.13569475-0.03664919j,
        -0.02062261-0.11945473j,  0.22179999-0.17674848j],
       [ 0.16949020+0.02770519j,  0.10628561+0.18861642j,
         0.38389486+0.12023375j,  0.08203842-0.52593343j,
         0.09218309-0.44245199j, -0.18019476+0.2025743j ,
         0.13569431-0.03665029j,  0.22628428-0.18603179j,
        -0.27442048+0.07160433j,  0.08325781+0.08810682j],
       [ 0.14067688-0.47358895j, -0.03406855-0.11780714j,
        -0.43964918-0.26788388j, -0.00840572-0.14122179j,
         0.28795336-0.08490127j, -0.06852735-0.03348624j,
        -0.14462706+0.34403457j,  0.11260324-0.40422855j,
         0.01114164-0.13311094j,  0.03535218+0.15945156j],
       [ 0.08946550-0.08387665j, -0.12097151+0.47900068j,
        -0.12309228-0.06973585j,  0.04691352+0.51269482j,
         0.02398168+0.07240097j, -0.12280178+0.27394094j,
         0.25609047-0.33241399j,  0.18870941-0.32196872j,
        -0.03535562+0.15944883j,  0.01113409+0.13310848j]]), array([[-0.02296214+0.0033263j ,  0.00614421-0.00304029j,
        -0.04906406-0.16963561j, -0.07970884-0.08225647j,
        -0.40736832-0.19443292j, -0.32077678-0.35552641j,
        -0.06006745-0.06169501j, -0.13436541-0.38366768j,
        -0.44475122-0.19901486j,  0.31263361+0.11933981j],
       [-0.00614417-0.00304085j, -0.02296315-0.00332651j,
         0.11441042-0.00547243j, -0.15183103+0.09017173j,
         0.16335465+0.45012388j,  0.01953306-0.45096669j,
        -0.34343503-0.21750743j,  0.04654532+0.072448j  ,
        -0.24964789-0.22284134j, -0.38111739-0.30357455j],
       [ 0.14968463-0.48372751j, -0.28146233-0.02404088j,
         0.13962759-0.01271926j, -0.01248017-0.01743868j,
        -0.03349744+0.07276728j, -0.22106407-0.07104512j,
        -0.01553824-0.41744673j,  0.06968178+0.4710419j ,
         0.03708522+0.0657473j ,  0.19867519+0.37005775j],
       [ 0.18885768-0.21007653j,  0.44008628+0.25044357j,
         0.01247947-0.01743823j,  0.13962769+0.01271864j,
         0.12640946+0.19477409j,  0.06146672-0.0513716j ,
         0.44242187-0.17607171j,  0.36889642-0.19601404j,
        -0.31072151+0.28259796j,  0.05688779-0.04961472j],
       [-0.07312852+0.47283783j, -0.30589764+0.01867495j,
         0.26055494+0.09540227j, -0.34432950-0.09403654j,
         0.17378480+0.15134948j,  0.22146810-0.17367186j,
         0.02904343-0.07008293j,  0.06869075-0.11982186j,
        -0.06179053+0.41827446j,  0.29224099+0.22678904j],
       [-0.12709332-0.27886848j, -0.38318603+0.28651554j,
        -0.00067033-0.35693857j, -0.02390727-0.27644368j,
        -0.22147132-0.17367067j,  0.17378072-0.1513484j ,
         0.09727049+0.09804492j, -0.04612906-0.06022076j,
         0.02040584+0.36935431j, -0.37921998-0.186992j  ],
       [-0.24986192+0.0506442j ,  0.07424300+0.10552082j,
         0.40918255+0.4089986j , -0.26772358+0.22237725j,
        -0.14897525-0.42205783j, -0.26985689+0.05406747j,
         0.18925274-0.16413241j,  0.08597700+0.11836562j,
        -0.07183332+0.04849866j, -0.21653633-0.21883473j],
       [-0.11955550-0.04850697j, -0.00706506-0.2548468j ,
        -0.32668903+0.12000548j,  0.14847697+0.55916011j,
        -0.24678091-0.12184476j,  0.25279839-0.36935019j,
        -0.08597640+0.11836766j,  0.18925731+0.16413155j,
        -0.02305824+0.30699582j,  0.08613733-0.00962403j],
       [ 0.44861101+0.02729237j,  0.22349259-0.08237601j,
        -0.05846242+0.22392344j, -0.23983598-0.40529823j,
        -0.29597571-0.08992275j, -0.04955392-0.00904622j,
        -0.39374914+0.14359079j,  0.37119985+0.06043845j,
         0.09129047+0.18256727j, -0.09379094-0.01164262j],
       [-0.17585371+0.16065581j,  0.18188799-0.41098837j,
         0.09091489-0.46208324j, -0.12980884-0.19159756j,
         0.03561880+0.03561598j, -0.24226838-0.19234523j,
         0.32185758+0.19454966j,  0.20679069+0.36454516j,
         0.09379933-0.01164836j,  0.09128315-0.1825711j ]]), array([[ -1.51756078e-01 -1.16089895e-06j,
          3.49582394e-06 +1.82554450e-06j,
         -1.55302947e-01 +3.10338596e-01j,
         -1.39003170e-01 +1.02133527e-01j,
          4.58157401e-02 -5.31773330e-02j,
         -2.43513190e-01 +4.79615277e-01j,
         -1.49010572e-01 +3.66600009e-01j,
          2.99446882e-01 +5.01573678e-03j,
         -2.04161536e-01 -1.16920787e-02j,
          2.43150026e-01 +4.30462104e-01j],
       [ -2.74080607e-06 +1.74867570e-06j,
         -1.51755993e-01 -1.14125451e-07j,
         -1.70763410e-01 -2.43319630e-02j,
          2.83513310e-01 +2.00127582e-01j,
         -4.43147247e-01 +3.04880413e-01j,
         -4.66569034e-02 +5.24654573e-02j,
          2.28812647e-01 +1.93245856e-01j,
         -1.28979927e-01 +3.74111726e-01j,
         -4.28806991e-01 +2.46031376e-01j,
         -1.81536418e-01 -9.41759430e-02j],
       [  1.55289429e-01 +3.10344695e-01j,
          1.70760727e-01 -2.43337155e-02j,
          2.66462193e-01 +1.29655652e-06j,
          1.08620945e-05 -7.95558055e-07j,
          4.35597080e-01 +2.56187249e-01j,
          4.61791620e-02 -7.74372416e-02j,
         -2.33070782e-01 +4.54338547e-01j,
          1.30510462e-01 +4.26073052e-02j,
         -2.60688564e-01 -1.16816631e-01j,
         -2.70909500e-01 -2.84115585e-01j],
       [  1.38992832e-01 +1.02134444e-01j,
         -2.83504602e-01 +2.00129161e-01j,
         -1.06114302e-05 -8.53865316e-07j,
          2.66462289e-01 +1.30064012e-06j,
         -8.87358733e-02 +1.60130056e-02j,
         -8.66302753e-02 -4.97869486e-01j,
         -8.59484178e-02 -1.07076685e-01j,
          3.42863053e-01 -3.78394414e-01j,
         -3.83230607e-01 -8.51178328e-02j,
          2.34696530e-01 +1.62875402e-01j],
       [  4.58355670e-02 +5.32019446e-02j,
         -4.43152229e-01 -3.04905073e-01j,
         -4.35566669e-01 +2.56232964e-01j,
          8.87468169e-02 +1.59986284e-02j,
         -2.07277804e-02 -2.17574472e-05j,
         -3.75488749e-05 -4.35180306e-06j,
         -1.50288851e-01 +2.27291268e-01j,
          3.84078687e-02 -3.42272536e-01j,
          3.30867696e-01 +1.06385102e-01j,
         -2.17291181e-01 -2.84432784e-01j],
       [ -2.43570009e-01 -4.79619706e-01j,
         -4.66511555e-02 -5.24624348e-02j,
         -4.62066476e-02 -7.74533705e-02j,
          8.66826021e-02 -4.97847008e-01j,
          4.11391887e-05 +1.25341222e-06j,
         -2.07243921e-02 -1.43523194e-05j,
          2.54557225e-01 +2.32014757e-01j,
          2.62872343e-01 +7.17566449e-02j,
         -8.85509682e-02 -3.46819807e-01j,
          1.21575417e-01 -3.25567051e-01j],
       [  1.48985286e-01 +3.66608931e-01j,
         -2.28797399e-01 +1.93246026e-01j,
         -2.33102055e-01 -4.54329796e-01j,
         -8.59315086e-02 +1.07087605e-01j,
          1.50328983e-01 +2.27302268e-01j,
         -2.54557499e-01 +2.31974563e-01j,
          3.26936861e-01 +1.42929488e-05j,
          1.26243963e-06 +9.89511701e-07j,
          1.84035721e-01 -3.00775075e-01j,
          2.10876097e-01 -7.44097732e-02j],
       [ -2.99453619e-01 +4.96721958e-03j,
          1.28965912e-01 +3.74126513e-01j,
          1.30528258e-01 -4.26436293e-02j,
          3.42857407e-01 +3.78430805e-01j,
         -3.84008176e-02 -3.42258417e-01j,
         -2.62884687e-01 +7.17793272e-02j,
          7.86820193e-08 +1.05098896e-06j,
          3.26937329e-01 -3.62141574e-05j,
          2.20852666e-01 +3.49569901e-02j,
         -2.35522601e-01 -2.62392720e-01j],
       [  2.04221969e-01 -1.15537456e-02j,
          4.28814622e-01 +2.45967785e-01j,
         -2.60663623e-01 +1.16957237e-01j,
         -3.83216989e-01 +8.50046231e-02j,
         -3.30897681e-01 +1.06277214e-01j,
          8.84419653e-02 -3.46853189e-01j,
          1.84103531e-01 +3.00749378e-01j,
          2.20878010e-01 -3.48372671e-02j,
          2.34115206e-01 -1.87237376e-05j,
          1.00527204e-05 -6.24125369e-05j],
       [ -2.43222146e-01 +4.30354814e-01j,
          1.81514075e-01 -9.42759878e-02j,
         -2.70765086e-01 +2.84187334e-01j,
          2.34841584e-01 -1.62701326e-01j,
          2.17402821e-01 -2.84380068e-01j,
         -1.21665285e-01 -3.25576015e-01j,
          2.10871792e-01 +7.43359465e-02j,
         -2.35594797e-01 +2.62402434e-01j,
         -7.61568486e-06 -6.55547272e-05j,
          2.34121861e-01 +4.70396726e-05j]])], 'kpt': [[0.0, 0.0, 0.0], [0.0, 0.16666666666666666, 0.0], [0.0, 0.33333333333333331, 0.0], [0.0, 0.41666666666666663, 0.0], [0.0, 0.5, 0.0]], 'gap': [0.32848130823188604, 0.83600383003269729, 0.82508359873699422, 0.50000039476338676, 0.49999823055862691]}
        self.assertFullAlmostEqual(res, surface.get_res())

    def test_bismuth_1(self):
        surface = self.system.surface(lambda kx: [0, kx, kx], [1, 0, 0], pickle_file=None)
        surface.wcc_calc(pos_tol=None, gap_tol=None, verbose=False, num_strings=4)
        res = {'t_par': [0.0, 0.083333333333333329, 0.16666666666666666, 0.33333333333333331, 0.66666666666666663, 0.83333333333333326, 0.91666666666666663, 1.0], 'wcc': [[2.7026851894081296e-07, 0.15696295820409689, 0.15696766840381948, 0.49999835561701766, 0.49999970805538824, 0.49999998032910276, 0.50000798541547353, 0.84303572291160167, 0.84304067515950365, 0.99999968600598133], [0.0058798871053203803, 0.12754249893106184, 0.17334269139277797, 0.4322060693601264, 0.4646057527543862, 0.53539404775349997, 0.56779284268556507, 0.82665701314091722, 0.87245724758564891, 0.9941205140687166], [0.0032773470122433555, 0.13101723445411356, 0.16296228556732675, 0.38269560824843341, 0.43812987721241542, 0.56187055891363147, 0.61730480340988336, 0.83703795509553247, 0.86898339161099991, 0.99672309075785614], [0.013181953422015748, 0.12520799474151637, 0.1353770870562645, 0.3533117142464488, 0.42255114473512118, 0.57744635983435333, 0.64668699082359848, 0.86462235558571865, 0.87479079910540325, 0.98681407751024997], [0.013183253173138136, 0.12520874383562927, 0.13537738670115521, 0.35331225320504056, 0.42255261531673827, 0.57744798236665273, 0.64668774469545798, 0.86462232964677022, 0.87479135295701116, 0.98681715960456928], [0.0032772365990767337, 0.13101707151215514, 0.16296219900420267, 0.38269540347750786, 0.43812968086918463, 0.56187041641440971, 0.61730454293755577, 0.83703784459801078, 0.86898330902153509, 0.99672347511891712], [0.005878935597787625, 0.12754169151937733, 0.17334315451131846, 0.43220694570678103, 0.46460493325647279, 0.53539449505100145, 0.56779170462083095, 0.82665625341476701, 0.87245748611341112, 0.99412041520731476], [2.1848444606495693e-07, 0.15695691297115147, 0.15696932364812652, 0.49998804349669396, 0.49999968715366844, 0.50000043635922331, 0.50001512826608474, 0.84302992648503516, 0.84304170695962755, 0.99999979223793745]], 'lambda_': [array([[  6.44716262e-02 -2.35506910e-07j,
         -1.66249135e-07 -8.92406068e-08j,
         -1.33212311e-01 -5.14595856e-01j,
          1.60211144e-01 -1.97082673e-01j,
         -7.91171607e-02 -2.56355230e-01j,
         -4.19757889e-01 -5.32309658e-02j,
          3.18915009e-01 +1.39467822e-01j,
         -9.51211717e-02 -1.68852294e-01j,
         -6.80087748e-02 -7.05252003e-02j,
          4.49777310e-02 +4.76899224e-01j],
       [  1.57493979e-07 -4.83486480e-08j,
          6.44712891e-02 +8.25422952e-08j,
          1.80241717e-01 -1.78948571e-01j,
         -5.25261024e-01 -8.15766485e-02j,
         -3.95848851e-01 +1.49444044e-01j,
          1.72935919e-02 -2.67728011e-01j,
         -6.63825397e-02 +1.82077871e-01j,
         -2.91976271e-01 +1.89494859e-01j,
          1.55480547e-01 -4.53080440e-01j,
          8.26421277e-02 -5.26256400e-02j],
       [  1.33212292e-01 -5.14597901e-01j,
         -1.80243020e-01 -1.78947203e-01j,
          5.51837074e-01 -2.74030906e-05j,
          1.22555529e-05 -1.64298757e-05j,
         -1.19424745e-01 +1.88921778e-02j,
          2.14843675e-02 -2.73366979e-02j,
          7.64204879e-02 -9.27732814e-02j,
         -1.34627120e-01 +7.73192050e-02j,
         -3.64969212e-01 +3.01959834e-01j,
          2.48812459e-01 +8.79887698e-02j],
       [ -1.60211385e-01 -1.97084905e-01j,
          5.25263594e-01 -8.15759470e-02j,
         -1.21002942e-05 -1.69786860e-05j,
          5.51836606e-01 -8.06515259e-06j,
          2.41846189e-02 -2.49808046e-02j,
          2.58416752e-03 -1.20882617e-01j,
         -6.85007700e-02 +1.39321073e-01j,
         -8.76604789e-02 +8.22310892e-02j,
         -1.10424693e-03 -2.63911654e-01j,
          4.05345200e-01 -2.45106450e-01j],
       [ -7.91173242e-02 +2.56355242e-01j,
         -3.95847334e-01 -1.49443537e-01j,
          1.19420508e-01 +1.89068423e-02j,
         -2.41939302e-02 -2.49764742e-02j,
          5.00755245e-02 +1.78317439e-06j,
         -7.46877359e-07 -2.76261963e-06j,
         -2.16190850e-01 +1.57725562e-01j,
          4.84371273e-01 -1.56150826e-01j,
         -1.57817703e-02 -2.23665359e-01j,
          5.79026846e-01 +1.20402277e-01j],
       [ -4.19757164e-01 +5.32305758e-02j,
          1.72933728e-02 +2.67728790e-01j,
         -2.14746320e-02 -2.73473341e-02j,
         -2.57811678e-03 -1.20879620e-01j,
          9.43749451e-08 -1.38498293e-06j,
          5.00755245e-02 +1.07975926e-06j,
         -4.71994434e-01 -1.90313141e-01j,
         -2.04391422e-01 -1.72746044e-01j,
         -5.70555853e-01 -1.55675676e-01j,
         -1.15625638e-01 +1.92105354e-01j],
       [  3.18916386e-01 -1.39465300e-01j,
         -6.63814809e-02 -1.82075377e-01j,
         -7.64453026e-02 -9.27776624e-02j,
          6.84808136e-02 +1.39320764e-01j,
         -2.16200373e-01 -1.57726517e-01j,
         -4.71987377e-01 +1.90305592e-01j,
         -6.41446182e-01 -9.49369172e-07j,
          1.82650701e-05 -6.43779693e-06j,
          8.90636108e-02 +2.12378871e-02j,
         -1.30527881e-01 -1.87748991e-01j],
       [ -9.51200727e-02 +1.68849641e-01j,
         -2.91977089e-01 -1.89493835e-01j,
          1.34656871e-01 +7.72513872e-02j,
          8.77024390e-02 +8.22208376e-02j,
          4.84369203e-01 +1.56133288e-01j,
         -2.04385768e-01 +1.72764297e-01j,
         -1.82313912e-05 -8.75608459e-06j,
         -6.41442972e-01 +3.89275911e-05j,
          1.93329408e-01 -1.22103270e-01j,
          9.03128642e-02 +1.51016319e-02j],
       [ -6.80080701e-02 +7.05272285e-02j,
          1.55479305e-01 +4.53080139e-01j,
          3.64974025e-01 +3.01949060e-01j,
          1.11732747e-03 -2.63916199e-01j,
         -1.57828603e-02 +2.23661498e-01j,
         -5.70555475e-01 +1.55682198e-01j,
          8.90569105e-02 -2.12375559e-02j,
          1.93325039e-01 +1.22119752e-01j,
          7.87341823e-02 -6.14868526e-07j,
          6.03477240e-07 -5.04227721e-06j],
       [  4.49812914e-02 -4.76897107e-01j,
          8.26414916e-02 +5.26265881e-02j,
         -2.48807268e-01 +8.80218098e-02j,
         -4.05352765e-01 -2.45091458e-01j,
          5.79032104e-01 -1.20390331e-01j,
         -1.15635660e-01 -1.92107412e-01j,
         -1.30516978e-01 +1.87748592e-01j,
          9.02876787e-02 -1.51317964e-02j,
         -5.54484027e-07 -2.61296809e-06j,
          7.87346932e-02 +9.19695979e-06j]]), array([[  7.53535885e-02 +2.59920434e-03j,
          2.02423741e-03 -6.28078282e-03j,
         -4.04512117e-01 -1.54018598e-01j,
         -1.78753151e-01 -8.26069359e-02j,
         -3.61790659e-01 +3.76954894e-01j,
          2.31098242e-02 -1.28222618e-01j,
          6.97933842e-02 -2.21095767e-01j,
          1.85724228e-01 -5.97020112e-02j,
         -3.63052621e-01 +6.11888837e-02j,
          4.38864350e-01 -2.41278068e-01j],
       [ -2.02439338e-03 -6.28064869e-03j,
          7.53538674e-02 -2.59949505e-03j,
         -1.39899103e-01 -1.38581313e-01j,
          2.85747538e-01 +3.25114607e-01j,
         -5.74274898e-02 -1.16949940e-01j,
         -4.51385974e-01 -2.63132251e-01j,
          1.89420312e-01 +4.66628687e-02j,
         -8.49766281e-02 -2.15716130e-01j,
         -4.78678063e-01 -1.47257607e-01j,
         -3.67917398e-01 +1.37130916e-02j],
       [  5.58158595e-01 -2.10818514e-01j,
          1.90502374e-01 -2.26718457e-01j,
          4.60341011e-01 -5.87887155e-02j,
         -1.39160279e-01 +1.43164886e-01j,
         -3.56971912e-02 +6.81548566e-02j,
         -3.23821058e-02 -2.25375938e-02j,
          1.12456047e-01 -4.92211208e-01j,
         -1.94963263e-01 -2.58999103e-02j,
          2.40439981e-03 +1.33175998e-04j,
         -9.58734121e-04 +2.83655616e-03j],
       [  2.79020632e-01 -9.91942701e-02j,
         -3.92690211e-01 +4.49199316e-01j,
          1.39158203e-01 +1.43167202e-01j,
          4.60340058e-01 +5.87929601e-02j,
          1.99084689e-02 +3.40649775e-02j,
          7.07623711e-02 -3.01960403e-02j,
          3.04951983e-02 -1.94298859e-01j,
          5.03888291e-01 +3.18566575e-02j,
         -2.95008637e-03 +5.10454489e-04j,
         -2.36292675e-04 +2.39952867e-03j],
       [ -1.85377568e-01 -3.69275394e-01j,
         -2.29004962e-01 +2.05425927e-01j,
          6.22862356e-02 +7.34253497e-02j,
          9.18092367e-02 +7.34069266e-02j,
          1.43128401e-01 -4.48507733e-02j,
         -6.02871577e-02 +9.81952435e-03j,
          4.93302629e-01 +8.77679991e-02j,
         -4.45702756e-01 -7.02120340e-02j,
          6.73830240e-02 -3.31059632e-02j,
          4.29985816e-01 -2.00388200e-01j],
       [  1.63800217e-01 +2.60408554e-01j,
         -2.79643746e-01 +3.04184082e-01j,
          8.04321854e-02 +8.57222723e-02j,
         -7.81174647e-02 -5.62879224e-02j,
          6.02853115e-02 +9.82058632e-03j,
          1.43128687e-01 +4.48484727e-02j,
         -4.50580427e-01 -2.36328100e-02j,
         -5.00785412e-01 -1.63149990e-02j,
         -4.14013549e-01 -2.31591577e-01j,
          6.47553644e-02 +3.79926124e-02j],
       [  1.96295229e-01 +4.07498221e-01j,
          1.95104895e-01 -3.84973350e-02j,
         -6.07037419e-02 -2.70043197e-01j,
          3.09613458e-01 +9.23219482e-02j,
          3.54239785e-01 -7.39218676e-02j,
         -3.44335714e-01 +1.39198161e-02j,
         -1.79307113e-01 -3.41106230e-03j,
          9.29495127e-03 +6.50320563e-03j,
          2.26040900e-01 -2.41955730e-02j,
          4.71510466e-01 -1.37363746e-01j],
       [  1.91961696e-01 +5.19508527e-02j,
         -2.24115334e-01 +3.92885576e-01j,
         -1.76388627e-01 -2.70685823e-01j,
         -2.76167540e-01 +1.84241250e-02j,
         -3.39751825e-01 +5.77044118e-02j,
         -3.61867998e-01 +1.05416641e-03j,
         -9.29562416e-03 +6.50361035e-03j,
         -1.79307137e-01 +3.40257778e-03j,
          4.85689075e-01 +7.27859259e-02j,
         -2.27241926e-01 +6.38605050e-03j],
       [ -1.41683332e-01 -4.39378063e-02j,
         -1.38117443e-01 -2.39196673e-03j,
          3.99712120e-01 +8.92746589e-02j,
         -3.68527499e-01 -1.04918122e-01j,
          5.37393763e-02 +5.49073802e-02j,
         -5.82736667e-01 +2.84847479e-01j,
         -4.40678112e-02 +1.29529649e-01j,
          3.16413777e-01 +9.39485909e-02j,
         -2.27250649e-01 -1.45523377e-01j,
          1.10953655e-01 -7.02544466e-02j],
       [  1.35732722e-01 +2.56690683e-02j,
         -1.47650508e-01 +1.42912686e-02j,
         -1.59861871e-01 -3.48229477e-01j,
         -1.49155532e-01 -3.81435729e-01j,
          6.02180287e-01 +2.41035010e-01j,
          4.95379256e-02 -5.87253610e-02j,
          3.26166714e-01 -5.05952916e-02j,
          2.62667904e-02 +1.34275124e-01j,
         -1.10954167e-01 -7.02551594e-02j,
         -2.27251626e-01 +1.45522210e-01j]]), array([[ 0.11149611 +5.98039931e-04j, -0.00251216 -1.34631017e-03j,
        -0.19878531 -2.52103741e-01j, -0.25170235 -7.58449296e-02j,
        -0.34433330 +2.70465303e-01j,  0.16604689 +1.76106869e-01j,
        -0.16517335 -2.26121502e-01j, -0.01989099 -2.35713978e-01j,
        -0.09398220 +3.55657759e-01j,  0.15895912 +5.19727448e-01j],
       [ 0.00251217 -1.34637224e-03j,  0.11149624 -5.98131045e-04j,
         0.21481026 -1.51534679e-01j, -0.10888069 +3.02021471e-01j,
        -0.16745728 -1.74765884e-01j,  0.28758394 -3.30171972e-01j,
        -0.07110543 -2.25611359e-01j, -0.06693602 +2.71906002e-01j,
        -0.28206639 -4.64567251e-01j,  0.32798168 +1.66591985e-01j],
       [ 0.32725158 -4.16495846e-01j, -0.35681725 -2.49379364e-01j,
         0.37062483 +1.53887455e-01j,  0.04063572 -1.16678141e-01j,
         0.06745917 +1.89509497e-01j, -0.06163099 +6.67028916e-02j,
        -0.46036323 -4.10624889e-02j,  0.01284777 -1.46279264e-01j,
        -0.07947812 -2.31235763e-01j, -0.09415144 +3.27601411e-02j],
       [ 0.41735959 -1.23771158e-01j,  0.17878056 +4.98597630e-01j,
        -0.04063727 -1.16677531e-01j,  0.37062288 -1.53891925e-01j,
        -0.08455572 +3.31366387e-02j,  0.15197388 +1.31790380e-01j,
        -0.02273031 -1.45072713e-01j, -0.45652163 +7.21649725e-02j,
        -0.09797252 +1.84298978e-02j, -0.04611616 -2.40126068e-01j],
       [-0.31035448 -3.43791266e-01j, -0.28026013 -1.00587662e-01j,
        -0.06188913 +7.33286408e-02j,  0.06623149 +1.90479713e-02j,
         0.19961086 -8.66024092e-02j,  0.09052005 +4.15763447e-02j,
         0.25355686 -6.76265722e-01j, -0.06082150 +1.15889621e-02j,
        -0.10727326 +2.31915917e-01j,  0.08228078 -1.67563928e-01j],
       [-0.11467425 -2.74797160e-01j,  0.35909137 +2.92516190e-01j,
         0.04184276 +5.47593865e-02j, -0.04578001 +8.43290460e-02j,
        -0.09052010 +4.15769211e-02j,  0.19961152 +8.66032895e-02j,
        -0.01543622 -5.99608256e-02j,  0.50372367 -5.17578920e-01j,
         0.04094104 -1.82131731e-01j,  0.06181128 -2.47935796e-01j],
       [-0.20078316 +3.02802191e-01j, -0.04281893 +2.58149516e-01j,
         0.20961168 +3.45754853e-01j, -0.02876073 -3.77900998e-01j,
         0.07302104 +5.71354318e-01j,  0.00980544 -1.00777535e-01j,
         0.16267443 -7.04069030e-02j,  0.04254488 +6.55061542e-02j,
        -0.29093327 -1.18717380e-01j,  0.10657998 +5.24968113e-02j],
       [-0.05841526 +2.55073520e-01j, -0.07076190 -3.56365225e-01j,
         0.05429633 -3.75084421e-01j,  0.23255360 -3.30759881e-01j,
         0.09534622 +3.40759956e-02j,  0.48575835 +3.09541970e-01j,
        -0.04254228 +6.55071628e-02j,  0.16267594 +7.04097071e-02j,
         0.07285550 -9.38443750e-02j,  0.20963256 -2.34072729e-01j],
       [ 0.01137198 +1.50349588e-02j,  0.04403662 -1.07428170e-01j,
         0.02218525 +4.44647276e-01j, -0.29666167 -2.10297164e-01j,
        -0.26346061 -4.08888171e-01j,  0.02882692 +2.53487836e-01j,
        -0.07860207 +1.77571689e-01j, -0.16816244 -3.84357627e-02j,
        -0.31056610 +1.54905297e-01j,  0.32697424 -2.43341418e-01j],
       [-0.05086278 +1.04370225e-01j, -0.01878969 +1.52020435e-03j,
        -0.36196851 +3.48067430e-02j, -0.24048750 +3.74658341e-01j,
         0.13645356 +2.15564922e-01j,  0.05106929 +4.83727363e-01j,
        -0.16802445 -3.90364820e-02j, -0.00703863 +1.94064166e-01j,
        -0.32697485 -2.43340992e-01j, -0.31056526 -1.54906180e-01j]]), array([[ 0.17981492 -1.86039600e-02j, -0.07219539 -2.08996007e-02j,
        -0.33805198 +1.98607136e-01j,  0.05529312 +1.11477252e-01j,
        -0.45186994 +2.29561287e-01j, -0.12923343 +1.04990282e-01j,
        -0.03470701 -2.52463628e-01j, -0.12304713 -3.86773743e-01j,
        -0.35879471 +4.73667892e-03j,  0.38333379 -4.97610365e-02j],
       [ 0.07219580 -2.08978192e-02j,  0.17981394 +1.86059942e-02j,
         0.03895406 +1.18173753e-01j, -0.38011075 +9.61319874e-02j,
        -0.16156779 -4.02628395e-02j,  0.50657389 +1.62177244e-02j,
         0.34056475 -2.20792648e-01j, -0.18706256 +1.73073329e-01j,
        -0.31585264 +2.22842064e-01j, -0.26731782 +2.39369268e-01j],
       [ 0.59472590 +3.57093549e-01j, -0.22485641 +4.28629169e-02j,
         0.20672707 -6.03064708e-02j,  0.16317521 +1.05528403e-01j,
        -0.22061170 -9.45686147e-02j,  0.08768029 +2.61325629e-01j,
        -0.10142263 +1.08747571e-01j, -0.06703450 +4.38429779e-01j,
         0.06306989 -2.54436659e-02j,  0.15748516 +2.01744716e-02j],
       [ 0.12992026 +1.88462553e-01j,  0.67411947 +1.63639112e-01j,
        -0.16317888 +1.05524851e-01j,  0.20672629 +6.03076750e-02j,
         0.16998935 -2.16987731e-01j,  0.23953140 -1.53847388e-02j,
        -0.42906629 +1.12324465e-01j,  0.09759152 -1.12191546e-01j,
        -0.15810518 +1.46004187e-02j,  0.06212671 +2.76453012e-02j],
       [-0.36506177 -1.77303196e-01j, -0.11868095 +4.04326017e-02j,
         0.35000293 +5.47851856e-02j,  0.54942884 +2.11517565e-02j,
         0.03083966 -2.46478442e-01j,  0.22731426 +1.42354872e-01j,
         0.20901953 +6.54012914e-03j, -0.01249595 +8.17963196e-05j,
        -0.28832893 -1.85595917e-02j,  0.32829954 +1.51540433e-01j],
       [-0.09032477 -8.69582076e-02j,  0.40580189 -5.71164456e-03j,
         0.51075889 -2.03576495e-01j, -0.31156022 +1.68618117e-01j,
        -0.22731287 +1.42357687e-01j,  0.03084780 +2.46469949e-01j,
        -0.00530991 -1.13106093e-02j, -0.09589739 -1.85837833e-01j,
         0.26753777 -2.43255369e-01j,  0.26940421 -1.04401951e-01j],
       [-0.26427467 -7.67247902e-02j, -0.03245941 +8.47288827e-02j,
        -0.41015474 +1.15403746e-02j, -0.32722004 +1.57672837e-01j,
         0.01546619 -1.25412562e-01j,  0.10336121 +6.24283485e-02j,
         0.06593222 +3.87439972e-01j, -0.02112908 +3.31502776e-01j,
         0.08801493 +1.73865711e-01j,  0.51611376 -1.26691905e-01j],
       [ 0.07885928 +4.48753511e-02j, -0.15553155 +2.27019834e-01j,
         0.19089703 -3.09023195e-01j, -0.05419097 +4.06725439e-01j,
        -0.01183830 -1.20169992e-01j, -0.11985280 -4.00422483e-02j,
         0.02112852 +3.31500572e-01j,  0.06593143 -3.87442262e-01j,
        -0.19730583 +4.93446998e-01j, -0.15991273 -1.11363956e-01j],
       [-0.05322617 +1.40068879e-02j, -0.37259904 -1.47687777e-01j,
        -0.10799114 +7.14029670e-02j, -0.04177958 -5.74789505e-03j,
        -0.05976328 -1.20927133e-01j,  0.60757372 +1.74003700e-01j,
        -0.27625071 -2.65699451e-02j,  0.09388698 -3.96198213e-01j,
         0.39054783 +2.23882771e-02j, -0.06191681 +2.23860643e-02j],
       [ 0.37423146 +1.43505535e-01j, -0.02969466 -4.63403131e-02j,
         0.04155407 -7.21145627e-03j, -0.11043665 -6.75481579e-02j,
         0.63176904 +1.67909969e-02j,  0.09337333 -9.73572304e-02j,
         0.37927840 -1.48122017e-01j, -0.06475805 -2.69860715e-01j,
         0.06191424 +2.23945200e-02j,  0.39055491 -2.23669958e-02j]]), array([[  1.79814056e-01 +5.88514150e-02j,
          1.10549768e-02 -4.90852259e-02j,
         -4.48750540e-01 +3.55398714e-01j,
         -1.55513453e-01 -4.26312229e-01j,
         -1.78956822e-01 +1.72187235e-01j,
          3.39175034e-01 +6.09410607e-02j,
          1.96312946e-01 -1.09456393e-01j,
         -1.40654094e-01 -1.16864520e-01j,
          1.59894978e-01 +1.92886468e-01j,
         -2.85378451e-01 +1.39497947e-01j],
       [ -1.10550927e-02 -4.90856826e-02j,
          1.79814017e-01 -5.88518927e-02j,
          4.04001431e-01 +2.06663306e-01j,
          4.07791914e-01 -4.01735324e-01j,
         -2.84633611e-01 -1.94261904e-01j,
         -6.95598129e-03 -2.48244639e-01j,
          1.81971060e-01 -1.81004319e-02j,
          1.01399611e-01 +2.00593672e-01j,
         -3.03420920e-01 +9.39938594e-02j,
          1.57521143e-02 +2.50047135e-01j],
       [  2.26179198e-01 +2.89081673e-01j,
         -1.38735819e-01 +1.23435669e-01j,
          2.06727870e-01 -6.16998301e-02j,
          1.77762432e-01 -7.74165975e-02j,
          2.50240540e-01 +3.16365382e-01j,
          3.80136676e-01 +3.47286373e-01j,
         -2.35118002e-03 -2.53728912e-02j,
          3.59054245e-01 +4.13192214e-01j,
          1.02269911e-01 -4.75242264e-02j,
          6.15001489e-02 +4.51502745e-02j],
       [  1.05478007e-01 -1.52834909e-01j,
         -3.14656968e-01 -1.88986216e-01j,
         -1.77761167e-01 -7.74157907e-02j,
          2.06727081e-01 +6.17017246e-02j,
          4.45670325e-02 +5.12956950e-01j,
         -9.90053175e-02 -3.91034860e-01j,
          2.05228734e-01 +5.07472902e-01j,
          2.15442788e-02 +1.36124817e-02j,
         -7.61597082e-02 -4.52339506e-03j,
          4.83436343e-02 +1.01879269e-01j],
       [ -2.11486090e-01 -2.15378117e-01j,
         -3.56680430e-01 +2.57429445e-01j,
          1.98518319e-01 -2.16563646e-01j,
         -1.38284571e-01 +1.67806141e-01j,
          3.08471368e-02 -8.40630104e-02j,
          3.52501755e-01 +3.69102328e-02j,
          3.37309944e-02 +4.87468004e-02j,
         -1.64423049e-01 -8.97717990e-05j,
         -2.50087342e-01 +4.98665363e-01j,
         -2.53060081e-01 +2.05832454e-01j],
       [  4.34842039e-01 -6.63836594e-02j,
          1.17922829e-04 +3.01850411e-01j,
         -4.91388483e-02 +2.11818990e-01j,
         -5.12182368e-02 +2.89286087e-01j,
         -3.52497196e-01 +3.69109580e-02j,
          3.08421594e-02 +8.40640541e-02j,
          1.61673842e-01 -2.99347210e-02j,
          2.43243815e-02 -5.40617823e-02j,
         -2.15564348e-01 +2.44831220e-01j,
          5.08052544e-01 -2.30410503e-01j],
       [  1.55616758e-01 -5.50236538e-02j,
         -1.89365463e-01 +4.08138239e-01j,
          2.38963325e-01 -2.27320789e-01j,
          5.04224509e-03 -3.31693081e-01j,
         -1.98643024e-01 -3.09783997e-02j,
          5.88028569e-02 -3.54938219e-03j,
          6.59315290e-02 +1.83277375e-01j,
         -4.75596531e-01 -2.59036880e-02j,
          2.37950664e-01 -4.05666724e-01j,
          2.65818099e-02 -1.44614917e-01j],
       [  3.85383079e-01 +2.32188416e-01j,
          1.59752369e-01 -4.15177198e-02j,
          2.93281761e-01 -1.55032132e-01j,
         -9.41102910e-02 +3.16106125e-01j,
         -5.71836120e-02 -1.41665293e-02j,
         -2.00962891e-01 -5.58607031e-03j,
          4.75591985e-01 -2.59015110e-02j,
          6.59317477e-02 -1.83274062e-01j,
          1.46923430e-01 +5.85677170e-03j,
         -4.48052031e-01 +1.42970401e-01j],
       [  6.26316235e-02 -4.58770792e-01j,
         -1.79300070e-01 -1.77869645e-01j,
         -9.52507738e-02 +1.19231374e-02j,
         -1.41162607e-01 +2.63345939e-02j,
         -1.89119925e-01 -3.95004283e-01j,
         -4.79319136e-02 +1.41905985e-01j,
          1.62742280e-01 +1.93967776e-01j,
          2.87990288e-01 +4.16348558e-01j,
          3.90547924e-01 +1.29808259e-02j,
         -4.71418135e-02 -4.94382041e-02j],
       [ -2.52468889e-01 +6.65515107e-03j,
          2.68795355e-01 -3.77015610e-01j,
          1.25441787e-01 -6.98797874e-02j,
         -8.09123218e-02 +5.16518376e-02j,
          1.39923939e-01 -5.34412013e-02j,
          4.02089251e-01 +1.73535598e-01j,
          4.69469060e-01 +1.89441441e-01j,
         -2.24993075e-01 -1.16133744e-01j,
          4.71436843e-02 -4.94388979e-02j,
          3.90552608e-01 -1.29851264e-02j]]), array([[ 0.11149644 -1.88573373e-03j,  0.00221920 +3.98386362e-05j,
         0.25482898 -7.89313050e-02j, -0.23996351 -5.84226376e-01j,
         0.09040590 -2.46432215e-01j,  0.45633324 +1.61349895e-01j,
        -0.16628470 +1.65599139e-01j, -0.09314345 +3.69768101e-01j,
         0.05753026 -3.51842998e-02j, -0.09529325 -1.43869775e-02j],
       [-0.00221899 +4.01169426e-05j,  0.11149607 +1.88570918e-03j,
        -0.36991009 +5.11927481e-01j, -0.22931150 -1.36324880e-01j,
         0.28367844 -3.92173750e-01j, -0.21447693 -1.51333592e-01j,
         0.27332655 -2.65887889e-01j, -0.05998990 +2.26880606e-01j,
        -0.04102950 +8.72027634e-02j, -0.06123298 +2.82521401e-02j],
       [-0.15496056 -4.82455521e-02j,  0.22273736 +3.10203213e-01j,
         0.37062326 -1.52323814e-01j,  0.04086657 +1.18638249e-01j,
         0.08922140 +2.14275451e-03j, -0.03353084 -6.97688833e-02j,
         0.45242112 -1.40564046e-01j, -0.23054606 +1.71825991e-01j,
         0.53398301 -1.47413476e-01j,  0.13710408 +6.90681721e-02j],
       [ 0.14403530 -3.53683069e-01j,  0.13938491 -8.31392920e-02j,
        -0.04086487 +1.18638169e-01j,  0.37062491 +1.52320917e-01j,
        -0.02962058 -7.15163410e-02j,  0.05790704 -6.79096274e-02j,
         0.03452311 +2.85453964e-01j,  0.21015572 +4.24591395e-01j,
         0.01731500 +1.52539155e-01j,  0.32320978 -4.49893120e-01j],
       [ 0.09957559 +3.64461172e-01j,  0.30944315 +1.08631437e-01j,
        -0.12929170 +7.24229437e-02j,  0.07556089 -1.45059300e-01j,
         0.19960864 +7.09385513e-02j,  0.05466978 -9.69588486e-02j,
        -0.25394915 +5.79363736e-02j,  0.50456980 -1.39974934e-01j,
         0.43752718 +1.93357392e-01j,  0.18380757 +1.97700114e-01j],
       [ 0.31632741 +8.65590090e-02j, -0.28912233 +2.43218441e-01j,
         0.05768688 -1.53047898e-01j, -0.03226836 -1.44637075e-01j,
        -0.05467266 -9.69602741e-02j,  0.19960998 -7.09397714e-02j,
         0.17978053 -4.91795186e-01j,  0.07800958 -2.48517798e-01j,
        -0.09825101 +2.51430086e-01j,  0.33580037 -3.40669414e-01j],
       [-0.16677525 -1.43615549e-01j,  0.19271454 +2.20886916e-01j,
        -0.40679711 +1.40586124e-01j, -0.18835996 -1.20223604e-01j,
        -0.42994737 +1.31383208e-01j,  0.16047502 +5.45520804e-01j,
         0.16267784 +2.85529071e-02j,  0.03682887 -9.42662662e-02j,
         0.07624006 -1.15400853e-01j,  0.21914543 -1.76406237e-02j],
       [-0.09459242 -2.77457615e-01j, -0.04071964 -2.16289283e-01j,
         0.04280349 -2.19320076e-01j, -0.38231814 +1.97690222e-01j,
         0.55658524 +1.16438280e-01j, -0.09665942 +4.39058175e-01j,
        -0.03683217 -9.42696123e-02j,  0.16267705 -2.85521110e-02j,
         0.08073596 +2.04493490e-01j,  0.06999588 -1.19291819e-01j],
       [-0.42606307 -2.47487539e-01j, -0.04948536 +4.30674478e-01j,
         0.17296661 +1.39658462e-01j, -0.02312440 -1.40602299e-01j,
         0.24265052 -6.27450136e-02j, -0.06634760 -1.81442232e-01j,
        -0.26571508 +7.24796187e-02j,  0.12499473 -1.46181917e-01j,
        -0.31056583 -2.63638250e-01j,  0.34646257 +2.41347090e-02j],
       [ 0.33044273 -2.80601057e-01j,  0.44260821 +2.16514886e-01j,
         0.13990805 -2.69978427e-02j,  0.19091241 +1.13900744e-01j,
         0.12840715 -1.44343441e-01j,  0.20258984 +1.47561473e-01j,
         0.18630339 -4.77893281e-02j,  0.18215599 -2.06586249e-01j,
        -0.34646221 +2.41333858e-02j, -0.31056672 +2.63635673e-01j]]), array([[  7.53539020e-02 -1.62373017e-03j,
          5.75543451e-03 -3.81291731e-03j,
         -2.82880290e-01 -1.66343808e-01j,
          1.37018488e-02 -5.79481530e-01j,
         -4.74685736e-01 +2.46220452e-02j,
         -1.86214491e-01 -6.90167298e-02j,
         -3.85117911e-01 +1.76849330e-01j,
         -1.32029847e-01 +2.17051143e-01j,
         -1.42128243e-01 +1.39491693e-01j,
          3.77938382e-02 -3.61969428e-04j],
       [ -5.75542406e-03 -3.81314490e-03j,
          7.53538755e-02 +1.62365840e-03j,
          4.78084066e-01 -3.27751105e-01j,
         -2.93774943e-01 -1.46245330e-01j,
          1.79530712e-01 -8.48994651e-02j,
         -4.75032998e-01 +1.66196330e-02j,
          2.52706237e-01 +2.61325198e-02j,
         -3.73763662e-01 +1.99733231e-01j,
          2.49362099e-02 +2.84012517e-02j,
         -9.14544396e-03 +1.98934878e-01j],
       [  2.08095257e-01 -1.01670274e-01j,
         -3.32906064e-01 -2.48318869e-01j,
          4.60336997e-01 +1.96378381e-01j,
         -6.88285295e-02 +4.38514076e-03j,
         -6.19540817e-04 +1.36112599e-01j,
          6.58888911e-02 -1.48252197e-02j,
         -2.57768881e-01 -1.85119567e-01j,
          1.32651726e-01 +2.50362676e-01j,
         -2.60281611e-01 +3.96438509e-03j,
          4.80013809e-01 -1.27999805e-01j],
       [ -2.63787637e-02 -4.14478114e-01j,
          1.98766560e-01 -1.18879494e-01j,
          6.88283488e-02 +4.38556316e-03j,
          4.60338850e-01 -1.96373297e-01j,
         -4.41162468e-02 +5.11367586e-02j,
         -1.20354889e-01 -6.35763438e-02j,
          2.80429922e-01 +4.04666227e-02j,
          2.61194280e-01 +1.80253343e-01j,
          4.93901997e-01 +5.34613442e-02j,
          2.57854387e-01 -3.56905725e-02j],
       [ -4.88418748e-01 -5.10237171e-02j,
         -4.47059933e-02 +2.16352557e-01j,
          5.24565551e-02 +3.82020485e-02j,
         -5.44038023e-03 +5.68839665e-02j,
          1.43127980e-01 -3.12462297e-02j,
         -5.98761305e-02 +3.43681458e-02j,
         -4.47387299e-01 +1.45286905e-01j,
          1.60053184e-01 -5.31961368e-02j,
          1.18530215e-01 -4.21370916e-02j,
          2.53796767e-01 +5.88543660e-01j],
       [  2.57827121e-02 +2.19413917e-01j,
         -4.91002314e-01 +8.49300967e-03j,
         -4.76158752e-02 +3.15958461e-02j,
          5.84059531e-02 +2.82748285e-02j,
          5.98755961e-02 +3.43665822e-02j,
          1.43129120e-01 +3.12458356e-02j,
         -1.46902922e-01 +8.28625298e-02j,
         -4.08104138e-01 +2.33911504e-01j,
          6.23144431e-01 -1.49961972e-01j,
         -3.73842711e-02 -1.20113650e-01j],
       [ -1.76207658e-01 -9.82964270e-02j,
          2.22834626e-01 -3.80141048e-02j,
          2.50184777e-01 +1.63858803e-01j,
         -2.22097155e-01 +3.93484899e-01j,
         -6.10044050e-01 -1.93339776e-01j,
         -1.75886729e-01 -1.19010896e-01j,
         -1.79304233e-01 +7.58275088e-04j,
         -8.05420101e-03 +8.65838667e-03j,
          2.09931956e-01 -1.64844990e-01j,
         -1.15840978e-01 -2.07364636e-01j],
       [ -1.04501353e-01 -2.00449030e-01j,
         -1.84849707e-01 -8.08731893e-02j,
         -4.45332493e-01 +7.64036517e-02j,
          6.98981851e-02 +2.90786724e-01j,
          2.06301727e-01 +5.03983497e-02j,
         -5.52939365e-01 -3.22163708e-01j,
          8.05080358e-03 +8.66011644e-03j,
         -1.79307396e-01 -7.62460760e-04j,
         -1.81576150e-01 -1.53131330e-01j,
          2.01731732e-01 -1.74786788e-01j],
       [ -3.51118653e-01 -4.46805782e-01j,
          2.46127385e-01 -5.35680226e-02j,
         -2.01487608e-03 +3.91205507e-04j,
          3.22333986e-03 +4.27676119e-04j,
          1.13294330e-01 +5.19499830e-02j,
          4.46254657e-01 +1.26502523e-01j,
         -2.65148783e-02 +1.64802514e-01j,
         -4.63847855e-01 +2.23277644e-01j,
         -2.27252073e-01 -1.02086205e-01j,
          2.54262472e-02 -1.65392035e-01j],
       [  2.04067518e-01 -1.47663854e-01j,
         -9.87407782e-02 -5.59617417e-01j,
          3.25182797e-03 +6.57761338e-05j,
          1.93076724e-03 +6.95755237e-04j,
          1.66465909e-01 -4.32934139e-01j,
         -2.63936654e-02 +1.21809185e-01j,
         -1.31085586e-01 +4.97820788e-01j,
          1.56763164e-01 -5.73427591e-02j,
         -2.54248915e-02 -1.65394102e-01j,
         -2.27253300e-01 +1.02083941e-01j]]), array([[  6.44713923e-02 +2.80763299e-07j,
          3.61128226e-07 +2.47589884e-07j,
         -3.86831152e-01 +1.93758843e-01j,
          3.66689128e-01 -1.59451526e-01j,
         -2.22458898e-01 +3.82520037e-01j,
          2.29099774e-01 +5.20590994e-02j,
         -1.12509257e-01 +1.85651534e-01j,
          3.31508785e-01 -4.11540568e-02j,
          1.82733847e-01 +9.51009339e-02j,
         -8.20614419e-03 -4.43340463e-01j],
       [ -4.29964515e-07 +1.34298288e-07j,
          6.44710213e-02 +1.31261759e-07j,
         -2.87507161e-01 -2.77891800e-01j,
         -2.94339329e-01 -3.17085452e-01j,
          1.10194054e-01 +2.07495176e-01j,
         -3.10982988e-01 +3.14800527e-01j,
          2.41818269e-01 +2.30470099e-01j,
         -2.01655728e-02 +2.16146822e-01j,
          7.30965489e-02 +4.37350525e-01j,
         -1.62235139e-01 +1.26949618e-01j],
       [  3.86829709e-01 +1.93757944e-01j,
          2.87509049e-01 -2.77892538e-01j,
          5.51837177e-01 +5.94843880e-05j,
         -6.11876944e-06 -1.83367769e-05j,
         -1.13107350e-01 +7.10518173e-03j,
          7.00761873e-03 -5.41627888e-02j,
         -1.00821825e-01 +5.47959461e-02j,
          1.36502675e-01 +8.21826281e-02j,
          4.46992639e-01 +3.05327341e-01j,
          1.59613918e-02 +2.73423459e-02j],
       [ -3.66688630e-01 -1.59447947e-01j,
          2.94345155e-01 -3.17083830e-01j,
          5.96251366e-06 -1.86581099e-05j,
          5.51835513e-01 -4.77246515e-05j,
         -3.99102693e-02 +3.72904133e-02j,
          6.02230062e-02 +9.60113232e-02j,
          1.53886846e-01 -4.13080993e-02j,
          8.17731586e-02 +8.04769487e-02j,
         -4.41655575e-04 -3.16558831e-02j,
         -2.25271676e-01 +4.92222737e-01j],
       [ -2.22458142e-01 -3.82520898e-01j,
          1.10193464e-01 -2.07496382e-01j,
          1.13116189e-01 +7.07682409e-03j,
          3.98888172e-02 +3.73114488e-02j,
          5.00751248e-02 -2.02583761e-08j,
          5.45020293e-06 +2.56125406e-06j,
          3.27412643e-01 -1.59231409e-01j,
         -2.68221808e-01 -3.55127613e-01j,
          1.19892845e-02 +3.96396428e-01j,
          3.28773256e-01 -3.66985954e-01j],
       [  2.29100962e-01 -5.20588959e-02j,
         -3.10981331e-01 -3.14801845e-01j,
         -7.02302752e-03 -5.41686602e-02j,
         -6.02518090e-02 +9.59903004e-02j,
         -5.72259273e-06 +3.00256002e-06j,
          5.00749681e-02 +6.02509034e-06j,
         -9.48468471e-03 -4.44939656e-01j,
          3.55660989e-01 -7.78626822e-02j,
         -3.92274201e-01 +2.98142277e-01j,
         -3.94138900e-01 -4.38817905e-02j],
       [ -1.12509149e-01 -1.85656334e-01j,
          2.41812460e-01 -2.30471858e-01j,
          1.00754800e-01 +5.48602114e-02j,
         -1.53894874e-01 -4.12197912e-02j,
          3.27424888e-01 +1.59267784e-01j,
         -9.45451454e-03 +4.44916862e-01j,
         -6.41443839e-01 +2.78766378e-05j,
         -6.50073980e-05 +4.17002010e-05j,
         -1.77116090e-01 -1.09363173e-01j,
          7.62113921e-02 -1.07408177e-01j],
       [  3.31506548e-01 +4.11517980e-02j,
         -2.01724447e-02 -2.16145833e-01j,
         -1.36545210e-01 +8.20951257e-02j,
         -8.17081883e-02 +8.05627829e-02j,
         -2.68221858e-01 +3.55107219e-01j,
          3.55681868e-01 +7.78274800e-02j,
          6.31532930e-05 +4.28200216e-05j,
         -6.41443947e-01 -1.31884391e-05j,
         -1.30558077e-01 -1.72968204e-02j,
         -4.04747916e-02 +2.04179435e-01j],
       [  1.82734146e-01 -9.51012020e-02j,
          7.30978151e-02 -4.37349548e-01j,
         -4.47033501e-01 +3.05280745e-01j,
          4.59204754e-04 -3.16398453e-02j,
          1.19798435e-02 -3.96403119e-01j,
         -3.92268372e-01 -2.98153261e-01j,
         -1.77067269e-01 +1.09369530e-01j,
         -1.30572378e-01 +1.72545766e-02j,
          7.87358246e-02 -1.43612523e-05j,
         -7.09572388e-06 +2.57490883e-06j],
       [ -8.20429303e-03 +4.43342613e-01j,
         -1.62234791e-01 -1.26945148e-01j,
         -1.59366002e-02 +2.73334870e-02j,
          2.25317624e-01 +4.92205991e-01j,
          3.28781616e-01 +3.66967460e-01j,
         -3.94152406e-01 +4.38757327e-02j,
          7.62505470e-02 +1.07394956e-01j,
         -4.04185381e-02 -2.04169176e-01j,
          7.22401584e-06 +1.48092690e-06j,
          7.87321721e-02 +9.51914860e-06j]])], 'kpt': [[0.0, 0.0, 0.0], [0.0, 0.083333333333333329, 0.083333333333333329], [0.0, 0.16666666666666666, 0.16666666666666666], [0.0, 0.33333333333333331, 0.33333333333333331], [0.0, 0.66666666666666663, 0.66666666666666663], [0.0, 0.83333333333333326, 0.83333333333333326], [0.0, 0.91666666666666663, 0.91666666666666663], [0.0, 1.0, 1.0]], 'gap': [0.32848301201041857, 0.6972249279132412, 0.27282894690788007, 0.75565467320465851, 0.24434481995309787, 0.72717119376778327, 0.69722397901779898, 0.32847868357241028]}
        self.assertFullAlmostEqual(res, surface.get_res())
        
    def test_bismuth_2(self):
        surface = self.system.surface(lambda kx: [0, 0, kx / 2.], [1, 1, 0], pickle_file=None)
        surface.wcc_calc(move_tol=None, gap_tol=None, verbose=False, num_strings=4)
        res = {'t_par': [0.0, 0.33333333333333331, 0.66666666666666663, 1.0], 'wcc': [[0.43459558681939453, 0.43459564506264231, 0.49999866061437553, 0.49999927418832579, 0.50000012923811554, 0.50000064779317832, 0.56540438474555765, 0.56540446863617611, 0.99999898725867331, 0.99999984249565999], [0.087508164173130037, 0.40544593893763187, 0.44154187300286174, 0.45405195146792909, 0.48412634605796206, 0.51587397648491695, 0.54594826723054568, 0.55845814536349092, 0.5945539314555095, 0.91249237633273117], [0.10900519551536474, 0.36580296453401939, 0.41655494599900644, 0.42741003368501723, 0.44472813069440098, 0.5552712870223806, 0.57259002278198201, 0.58344410783013323, 0.63419657437992827, 0.89099266196508242], [8.4321399345095059e-06, 0.38534641664707359, 0.38535414764033166, 0.42483945812195067, 0.42484121822644672, 0.57515712932558882, 0.57515901917039391, 0.61464330287362934, 0.61464920766508357, 0.99998151305432303]], 'lambda_': [array([[ -3.60167867e-01 -4.59627863e-07j,
          2.04849445e-08 -1.81521832e-07j,
         -1.08208967e-01 +9.92984428e-02j,
         -1.73927683e-01 -9.88085663e-03j,
          5.77146265e-02 +1.15097335e-01j,
         -2.96859207e-01 -1.83011311e-02j,
          4.97336649e-01 +3.42595655e-02j,
          1.12932389e-01 -1.31465988e-01j,
          6.23751437e-01 +8.23070941e-03j,
         -9.22644442e-02 +1.92670088e-01j],
       [  2.82258628e-08 -8.39133408e-08j,
         -3.60167893e-01 -2.25690729e-07j,
          1.25086132e-01 -1.21252858e-01j,
         -1.46801205e-01 -4.31649068e-03j,
          9.54509637e-02 -2.81690774e-01j,
         -8.46784620e-02 -9.69941795e-02j,
         -1.69891656e-01 -3.42579656e-02j,
          3.71185194e-01 -3.32772780e-01j,
          2.13490033e-01 +7.53914256e-03j,
          2.81795024e-01 -5.56530280e-01j],
       [  1.08207648e-01 +9.92983566e-02j,
         -1.25085211e-01 -1.21252245e-01j,
         -9.16742547e-01 -7.90471903e-08j,
          2.14111983e-07 +1.14417221e-07j,
          1.81603156e-01 -1.71358734e-01j,
          1.88624887e-01 +7.11521524e-02j,
         -5.44943906e-03 -3.02047784e-02j,
          6.02208664e-02 -9.80571759e-03j,
          2.47785198e-03 +1.32064568e-03j,
         -2.59234293e-03 +8.90590545e-04j],
       [  1.73928269e-01 -9.88062182e-03j,
          1.46800916e-01 -4.31691829e-03j,
         -1.22822632e-07 +1.57486215e-07j,
         -9.16742512e-01 +3.27977162e-07j,
         -1.36033271e-01 +1.48784815e-01j,
          2.39476938e-01 +7.06696661e-02j,
         -5.96420556e-02 -1.28617955e-02j,
         -6.98041967e-03 +2.98872980e-02j,
          2.73861998e-03 -1.22936582e-04j,
          1.82001480e-03 -2.13787215e-03j],
       [  5.77153083e-02 -1.15096772e-01j,
          9.54509156e-02 +2.81689946e-01j,
         -1.81602702e-01 -1.71357994e-01j,
          1.36033165e-01 +1.48784637e-01j,
         -7.33196265e-01 +1.97031062e-07j,
         -5.95014801e-08 +6.63531190e-08j,
          5.85358717e-02 -1.85918260e-01j,
          2.36525113e-01 +9.98361188e-02j,
          1.05714447e-01 -1.11551086e-02j,
          3.62655907e-01 +8.76190701e-02j],
       [ -2.96859255e-01 +1.83014025e-02j,
         -8.46784303e-02 +9.69937766e-02j,
         -1.88624311e-01 +7.11523046e-02j,
         -2.39477172e-01 +7.06698132e-02j,
          2.67465014e-08 -1.75386970e-07j,
         -7.33196348e-01 -1.46667150e-07j,
         -2.54855362e-01 -3.09899714e-02j,
         -4.16592389e-02 +1.90410762e-01j,
         -3.69257652e-01 +5.33332610e-02j,
          1.04209630e-01 +2.09887358e-02j],
       [  4.97336229e-01 -3.42572743e-02j,
         -1.69888180e-01 +3.42587017e-02j,
          5.44791755e-03 -3.02045590e-02j,
          5.96425916e-02 -1.28621433e-02j,
          5.85353716e-02 +1.85916871e-01j,
         -2.54854968e-01 +3.09874908e-02j,
         -5.32022408e-01 +2.78970370e-06j,
         -6.57236572e-07 +5.51553908e-09j,
          4.54797655e-01 -2.08508041e-02j,
         -1.09861290e-01 +3.32395897e-01j],
       [  1.12929906e-01 +1.31463527e-01j,
          3.71189143e-01 +3.32772100e-01j,
         -6.02205286e-02 -9.80545105e-03j,
          6.98037512e-03 +2.98871983e-02j,
          2.36525008e-01 -9.98370642e-02j,
         -4.16575747e-02 -1.90410914e-01j,
          1.38386237e-06 +1.95887501e-07j,
         -5.32021768e-01 +1.23961471e-06j,
          2.37602707e-01 +2.57101597e-01j,
          4.22631159e-01 -1.69284300e-01j],
       [  6.23753030e-01 -8.22049135e-03j,
          2.13488045e-01 -7.53793594e-03j,
         -2.47835724e-03 +1.32066428e-03j,
         -2.73828762e-03 -1.22583595e-04j,
          1.05714156e-01 +1.11559933e-02j,
         -3.69258054e-01 -5.33372771e-02j,
          4.54796261e-01 +2.08531663e-02j,
          2.37604467e-01 -2.57099060e-01j,
         -2.91356479e-01 -1.86006462e-06j,
         -4.83920422e-07 -1.91147719e-06j],
       [ -9.22616135e-02 -1.92671647e-01j,
          2.81790444e-01 +5.56533082e-01j,
          2.59332463e-03 +8.91367968e-04j,
         -1.82071529e-03 -2.13793635e-03j,
          3.62655574e-01 -8.76173124e-02j,
          1.04208030e-01 -2.09872023e-02j,
         -1.09860144e-01 -3.32394136e-01j,
          4.22632409e-01 +1.69286332e-01j,
         -1.09754832e-07 -2.20704839e-06j,
         -2.91356031e-01 -2.03301973e-06j]]), array([[ -3.98278491e-01-0.01243141j,   1.49255529e-02+0.01067871j,
          3.52749600e-01+0.12439964j,  -3.93950369e-02+0.22956908j,
         -2.69117496e-02+0.0718638j ,  -1.84016740e-01-0.06397684j,
         -1.09678403e-01+0.01558046j,  -6.23516898e-01+0.18696231j,
         -3.70626294e-02-0.39815573j,  -6.63919702e-02-0.05067268j],
       [ -1.49256798e-02+0.01067855j,  -3.98278088e-01+0.01243135j,
         -2.32375599e-01-0.01596834j,   3.75207969e-02+0.37215502j,
          3.85701689e-02+0.19096464j,   7.48362890e-02-0.01697284j,
         -4.08071007e-01+0.50715275j,   5.57470824e-02-0.09573095j,
         -8.09625382e-02+0.02053173j,   1.90452791e-01-0.35161368j],
       [  5.54070775e-03-0.01183455j,   7.84745368e-03-0.0013605j ,
         -8.02864852e-01-0.00494023j,   4.94732875e-03+0.00690929j,
         -1.64644052e-01-0.25022767j,  -3.41463235e-01-0.10289175j,
          3.58426513e-02-0.07735733j,  -2.44187853e-01+0.24487692j,
         -4.24941897e-02-0.08347686j,  -3.77018900e-02+0.03339124j],
       [  5.33100251e-04+0.00794697j,   1.01900672e-02-0.00818039j,
         -4.94728036e-03+0.00690887j,  -8.02864771e-01+0.00494035j,
          3.29038652e-01-0.13754018j,  -1.37975020e-01+0.26586558j,
          2.05498027e-01+0.27814277j,   2.40707863e-02+0.08179007j,
         -3.91300342e-02+0.03170318j,  -7.53604094e-02-0.05563001j],
       [ -5.73021540e-02-0.20763494j,  -1.15454848e-02-0.27686656j,
          1.21478581e-01-0.19271508j,  -1.12528951e-01-0.11482392j,
         -7.51137138e-01+0.01775657j,   1.29159159e-02-0.03321556j,
          2.34414666e-01+0.3674181j ,   1.08783196e-02-0.00438187j,
         -9.17409214e-02+0.07577154j,  -1.54689165e-01-0.07148196j],
       [ -2.75893608e-01+0.02590592j,   2.13466257e-01+0.02877082j,
          1.23765166e-01-0.10261276j,   1.00966746e-01+0.20420867j,
         -1.29161484e-02-0.03321604j,  -7.51137228e-01-0.01775679j,
         -9.44867419e-03-0.00694882j,   3.18308145e-01-0.29770435j,
          2.79159249e-02+0.1681019j ,   9.73784148e-02-0.06837503j],
       [ -6.18671031e-01-0.23191908j,  -4.93995473e-01-0.00815627j,
         -1.12758938e-02-0.02028002j,   9.73503728e-02-0.20870484j,
          1.09700988e-01-0.34074512j,   9.32591254e-02+0.14314022j,
         -8.23576823e-02-0.06236139j,   1.08008727e-01+0.0204205j ,
         -1.31607008e-03+0.19095909j,  -1.49609142e-01+0.1638776j ],
       [ -1.93648765e-01-0.45453095j,   4.47894067e-01+0.48572885j,
         -1.27002043e-01-0.19210883j,  -8.16963280e-03+0.02171775j,
         -5.47936506e-02+0.16181485j,   1.90876855e-01+0.30283153j,
         -1.08007777e-01+0.02041971j,  -8.23552140e-02+0.06236035j,
         -1.66450431e-01+0.14674115j,   1.90951803e-01+0.00199808j],
       [ -7.26322018e-02+0.17056226j,   6.04504960e-03-0.04921611j,
         -5.79565183e-02+0.1364117j ,  -7.16341846e-02-0.05230022j,
          1.01833885e-02-0.02859636j,   8.45737971e-02-0.08975938j,
          6.41675533e-02-0.16313687j,  -1.27773380e-01-0.42100136j,
         -8.28346028e-01+0.06656952j,  -6.70366738e-03-0.04771403j],
       [  2.48904066e-02+0.04288949j,   1.33781922e-01+0.1283316j ,
         -6.33551048e-02-0.06206765j,  -1.25037053e-01+0.07958287j,
         -6.41274508e-02+0.10534119j,   2.48738775e-02-0.01740047j,
         -4.23159376e-01-0.12044556j,   1.61998853e-01-0.06698368j,
          6.70006712e-03-0.04771659j,  -8.28344893e-01-0.06656844j]]), array([[ -4.79641872e-01+0.02086569j,   2.22653328e-02+0.04353565j,
          5.99667571e-02+0.35626937j,  -1.03929504e-02-0.26049626j,
          8.84755238e-02+0.03125735j,   1.00252315e-01+0.03723126j,
         -3.54892278e-02+0.28096816j,   5.42468129e-02+0.01535756j,
          3.10916459e-01+0.48704778j,  -3.60304613e-01+0.03605843j],
       [ -2.22657906e-02+0.04353561j,  -4.79641983e-01-0.0208672j ,
         -2.12245787e-01+0.15138708j,  -3.18311030e-01+0.17088669j,
         -8.80517739e-02-0.06069624j,   7.63971742e-02+0.05448634j,
         -2.70589560e-03+0.05630935j,  -2.77659053e-01-0.05578895j,
          8.30582222e-02-0.35244605j,  -4.42003456e-01-0.3721762j ],
       [ -5.71313448e-02-0.03060553j,  -7.51955039e-02-0.01671096j,
         -6.21929361e-01-0.01870721j,   1.20952632e-02+0.00477829j,
          2.47112055e-02+0.07299977j,  -4.30658202e-01-0.37262166j,
          1.49725932e-01+0.34669164j,  -8.16973969e-02+0.01310696j,
          8.91980745e-02-0.03626355j,   9.98985892e-02+0.32184966j],
       [ -3.28650499e-02+0.06966732j,   1.08160983e-02-0.06390373j,
         -1.20951791e-02+0.00477883j,  -6.21930091e-01+0.018708j  ,
         -4.47970523e-01+0.35161838j,  -2.81711071e-02+0.07173522j,
          3.43652009e-02+0.07526813j,   3.71558421e-01-0.0675045j ,
         -2.99117835e-01+0.1552269j ,   3.69203792e-02+0.0889277j ],
       [  2.23988535e-01-0.08335541j,  -2.17144465e-01+0.15998371j,
          6.35516973e-02+0.05253642j,   2.84945089e-01+0.03209864j,
         -7.20986586e-01-0.04819066j,   9.51720079e-03+0.01406222j,
          7.02511857e-02-0.00411004j,  -1.83854804e-01-0.18687113j,
          3.23087842e-01+0.2501053j ,   1.31005977e-01+0.03004592j],
       [  2.55668901e-01-0.08590679j,   1.96863037e-01-0.13551226j,
          2.83079834e-01-0.04567694j,  -6.09653625e-02+0.05551399j,
         -9.51885728e-03+0.01406284j,  -7.20986701e-01+0.04819061j,
         -2.59511412e-01-0.0371224j ,  -3.83689997e-02-0.05898611j,
          1.16781118e-01+0.066539j  ,  -4.07124039e-01-0.03452657j],
       [ -2.59978727e-01+0.47478384j,  -3.89883366e-01+0.39586019j,
         -3.54221754e-04-0.25427606j,   9.63307160e-02-0.09239388j,
          5.50029780e-02+0.07138865j,  -2.64454718e-01+0.14350963j,
         -4.12389050e-01-0.07604216j,   7.33626829e-02-0.04471575j,
         -4.49631048e-02+0.03809792j,   1.70037922e-01-0.03920002j],
       [ -2.51173867e-01+0.49560663j,   3.67341417e-01-0.3975791j ,
         -1.30292814e-01+0.02897712j,   2.11460886e-01+0.14121235j,
         -2.72429741e-01+0.12772472j,   2.48289709e-02+0.08663306j,
         -7.33597304e-02-0.04471578j,  -4.12389454e-01+0.07604034j,
         -1.74395589e-01-0.00598708j,  -5.14134786e-02-0.0288042j ],
       [  5.71822852e-02-0.05424658j,  -1.35471011e-01+0.02879843j,
          2.71704878e-01+0.00301087j,  -2.30569070e-01-0.34015579j,
          1.53921021e-01+0.01245745j,  -2.65796031e-02-0.06218314j,
          8.45385993e-02+0.11827156j,  -6.38825878e-01-0.2846364j ,
         -3.59420910e-01+0.15507609j,   1.31796178e-01+0.15043757j],
       [ -1.07606373e-02+0.13808014j,  -4.62703306e-02+0.06381011j,
         -7.98022561e-02-0.40311509j,   1.88875389e-01-0.19533538j,
          2.25174018e-02+0.06376303j,  -1.04886328e-01+0.1133365j ,
          6.81447277e-01-0.1573218j ,   1.05584723e-01-0.09993727j,
         -1.31803534e-01+0.15043163j,  -3.59417103e-01-0.15507327j]]), array([[ -7.68080519e-01 -1.12648185e-05j,
          3.37733994e-06 +2.36757213e-05j,
         -2.12292912e-02 +1.22319032e-02j,
          2.05692548e-03 +1.08842525e-01j,
         -3.22155771e-02 +2.37613778e-02j,
          2.04079501e-02 +1.89609629e-03j,
         -5.07500475e-01 +1.68201956e-01j,
         -1.50233171e-01 +1.77346485e-02j,
          1.40584063e-01 -1.59510417e-01j,
          1.90896506e-02 +2.03158903e-01j],
       [ -6.08160616e-06 +2.32858510e-05j,
         -7.68080184e-01 -1.40876926e-06j,
         -1.00916200e-01 +4.08284810e-02j,
          2.91695006e-03 -2.43241510e-02j,
         -2.03361781e-02 -2.55263014e-03j,
         -2.63098116e-02 -3.01472161e-02j,
          1.91611456e-02 -1.50057745e-01j,
         -1.73009569e-01 +5.05875383e-01j,
          2.04016899e-01 +4.14961355e-03j,
          1.48786224e-01 -1.51908956e-01j],
       [  2.12489224e-02 +1.22000507e-02j,
          1.00917076e-01 +4.08214067e-02j,
         -3.24678122e-01 -5.60004325e-06j,
         -1.30510352e-05 -9.05181427e-06j,
          1.72291776e-01 +8.72643104e-02j,
          2.08577923e-02 +3.08789246e-01j,
         -9.81013135e-02 -1.74153145e-01j,
         -2.34395369e-01 +3.80252125e-01j,
         -6.32792196e-01 -9.21896527e-03j,
         -2.58065445e-01 +2.06041194e-01j],
       [ -2.08652921e-03 +1.08840093e-01j,
         -2.87625413e-03 -2.43302062e-02j,
          1.40213438e-05 -7.36399374e-06j,
         -3.24679244e-01 +1.54308739e-05j,
          2.38908631e-01 +1.96772249e-01j,
          2.93651361e-02 -1.90882646e-01j,
         -6.20861890e-02 -4.42350914e-01j,
          1.59749950e-01 -1.20144593e-01j,
         -1.77358129e-01 -2.78550644e-01j,
          6.01622347e-01 +1.96361599e-01j],
       [ -3.22073876e-02 -2.37512151e-02j,
         -2.03255333e-02 +2.53068676e-03j,
         -1.72282611e-01 +8.72443410e-02j,
         -2.38890904e-01 +1.96764733e-01j,
         -8.74045305e-01 -3.27198577e-06j,
         -6.60035123e-06 +4.59458389e-06j,
          4.12467643e-02 -1.15957810e-02j,
          5.02033538e-02 -3.11634241e-02j,
         -2.67124382e-01 +3.45764073e-02j,
          1.47549772e-01 -3.60076083e-02j],
       [  2.03926427e-02 -1.94171465e-03j,
         -2.63086984e-02 +3.01815115e-02j,
         -2.08552915e-02 +3.08807158e-01j,
         -2.94127855e-02 -1.90867239e-01j,
          6.97212694e-06 +5.56281229e-06j,
         -8.74043603e-01 -2.28584033e-05j,
         -2.00886327e-02 +5.55759432e-02j,
          2.78806659e-03 -4.27518817e-02j,
          7.91727812e-03 +1.51662874e-01j,
          4.36221440e-02 +2.65777956e-01j],
       [  5.07504389e-01 +1.68195929e-01j,
         -1.91544872e-02 -1.50035765e-01j,
         -9.80897222e-02 +1.74167326e-01j,
         -6.20986288e-02 +4.42347358e-01j,
         -4.12550291e-02 -1.15835695e-02j,
          2.00976984e-02 +5.55537678e-02j,
         -3.76839660e-01 +3.88583979e-06j,
         -6.18285430e-06 +4.59819737e-06j,
          3.14587155e-01 -2.76032913e-01j,
         -2.02465684e-01 +2.97157363e-01j],
       [  1.50209034e-01 +1.77216426e-02j,
          1.73015522e-01 +5.05889234e-01j,
         -2.34394725e-01 -3.80239540e-01j,
          1.59730303e-01 +1.20163173e-01j,
         -5.01900764e-02 -3.11651356e-02j,
         -2.79939156e-03 -4.27657643e-02j,
          7.73607255e-06 +6.50243685e-06j,
         -3.76841563e-01 -1.21270468e-06j,
          2.26378874e-01 +2.79367106e-01j,
          3.36362007e-01 +2.49037255e-01j],
       [ -1.40598325e-01 -1.59488252e-01j,
         -2.04028513e-01 +4.19123507e-03j,
         -6.32799660e-01 +9.27121808e-03j,
         -1.77367832e-01 +2.78545286e-01j,
          2.67105318e-01 +3.45674289e-02j,
         -7.88868622e-03 +1.51659788e-01j,
          3.14592756e-01 +2.76031357e-01j,
          2.26358358e-01 -2.79377704e-01j,
          5.93903755e-02 -3.69400918e-05j,
         -6.94696146e-06 -9.86408625e-06j],
       [ -1.91689404e-02 +2.03177621e-01j,
         -1.48719304e-01 -1.51923690e-01j,
         -2.58046245e-01 -2.06046155e-01j,
          6.01668836e-01 -1.96262718e-01j,
         -1.47515310e-01 -3.60378141e-02j,
         -4.37102614e-02 +2.65785444e-01j,
         -2.02419816e-01 -2.97174800e-01j,
          3.36387735e-01 -2.49002635e-01j,
          7.89103977e-06 -5.64637813e-06j,
          5.93985823e-02 +7.59473487e-05j]])], 'kpt': [[0.0, 0.0, 0.0], [0.0, 0.0, 0.16666666666666666], [0.0, 0.0, 0.33333333333333331], [0.0, 0.0, 0.5]], 'gap': [0.21729771465752723, 0.75352315389412028, 0.23740408002469204, 0.19267742439350405]}
        self.assertFullAlmostEqual(res, surface.get_res())


if __name__ == "__main__":
    unittest.main()
