#!/usr/bin/env python3
# -*- coding: utf-8 -*-
#
# Author:  Dominik Gresch <greschd@gmx.ch>
# Date:    15.10.2014 10:22:43 CEST
# File:    tb_example.py

from common import *

import os
import types
import shutil

class TbExampleTestCase(BuildDirTestCase):

    def createH(self, t1, t2):

        builder = z2pack.em.tb.Builder()

        # create the two atoms
        builder.add_atom([1, 1], [0, 0, 0], 1)
        builder.add_atom([-1, -1], [0.5, 0.5, 0], 1)

        # add hopping between different atoms
        builder.add_hopping(((0, 0), (1, 1)),
                           z2pack.em.tb.vectors.combine([0, -1], [0, -1], 0),
                           t1,
                           phase=[1, -1j, 1j, -1])
        builder.add_hopping(((0, 1), (1, 0)),
                           z2pack.em.tb.vectors.combine([0, -1], [0, -1], 0),
                           t1,
                           phase=[1, 1j, -1j, -1])

        # add hopping between neighbouring orbitals of the same type
        builder.add_hopping((((0, 0), (0, 0)), ((0, 1), (0, 1))),
                           z2pack.em.tb.vectors.neighbours([0, 1],
                                                        forward_only=True),
                           t2,
                           phase=[1])
        builder.add_hopping((((1, 1), (1, 1)), ((1, 0), (1, 0))),
                           z2pack.em.tb.vectors.neighbours([0, 1],
                                                        forward_only=True),
                           -t2,
                           phase=[1])
        self.model = builder.create()

    # this test may produce false negatives due to small numerical differences
    def test_res1(self):
        self.createH(0.2, 0.3)
        # call to Z2Pack
        tb_system = z2pack.em.tb.System(self.model)
        tb_surface = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0])
        tb_surface.wcc_calc(verbose=False, num_strings=20, pickle_file=None)
        
        res = {'t_par': [0.0, 0.052631578947368418, 0.10526315789473684, 0.15789473684210525, 0.21052631578947367, 0.26315789473684209, 0.31578947368421051, 0.36842105263157893, 0.42105263157894735, 0.47368421052631576, 0.52631578947368418, 0.57894736842105265, 0.63157894736842102, 0.68421052631578938, 0.73684210526315785, 0.78947368421052633, 0.84210526315789469, 0.89473684210526305, 0.94736842105263153, 1.0], 'wcc': [[0.49969760416602749, 0.50030239583397262], [0.49880043805854513, 0.50119956194145499], [0.49773828651532415, 0.50226171348467608], [0.49473050423908532, 0.50526949576091473], [0.49401284618977198, 0.50598715381022796], [0.49075937388646534, 0.50924062611353471], [0.48837008585483471, 0.51162991414516534], [0.48451904842730742, 0.51548095157269258], [0.48246334933733581, 0.5175366506626643], [0.47592447770545915, 0.52407552229454091], [0.46594235813352736, 0.53405764186647287], [0.45778547722440222, 0.5422145227755979], [0.44322520961368744, 0.55677479038631272], [0.41935330374466429, 0.58064669625533583], [0.38092062985140185, 0.61907937014859815], [0.32737557006945889, 0.67262442993054128], [0.2510064964640899, 0.7489935035359101], [0.16336944227638622, 0.83663055772361372], [0.080972973009710153, 0.91902702699029004], [0.0011194259395927708, 0.99888057406040731]], 'lambda_': [array([[ -9.99998195e-01-0.00187074j,   1.91188843e-04+0.00027166j],
       [ -1.91188843e-04+0.00027166j,  -9.99998195e-01+0.00187074j]]), array([[ -9.99971596e-01+0.00752557j,   4.01269156e-04+0.0001057j ],
       [ -4.01269156e-04+0.0001057j ,  -9.99971596e-01-0.00752557j]]), array([[ -9.99899029e-01+0.01399121j,   1.46545984e-04+0.0024813j ],
       [ -1.46545984e-04+0.0024813j ,  -9.99899029e-01-0.01399121j]]), array([[ -9.99451940e-01+0.03306642j,  -8.84781128e-04+0.00128407j],
       [  8.84781128e-04+0.00128407j,  -9.99451940e-01-0.03306642j]]), array([[ -9.99292512e-01+0.03756884j,   3.16253478e-05-0.00174864j],
       [ -3.16253478e-05-0.00174864j,  -9.99292512e-01-0.03756884j]]), array([[-0.99831496+0.05786025j, -0.00433038+0.00082637j],
       [ 0.00433038+0.00082637j, -0.99831496-0.05786025j]]), array([[-0.99733136+0.07297063j, -0.00217078+0.00085297j],
       [ 0.00217078+0.00085297j, -0.99733136-0.07297063j]]), array([[-0.99527303+0.09680589j,  0.00296530-0.00717062j],
       [-0.00296530-0.00717062j, -0.99527303-0.09680589j]]), array([[-0.99393566+0.10978177j, -0.00628665-0.0005884j ],
       [ 0.00628665-0.0005884j , -0.99393566-0.10978177j]]), array([[-0.98858035+0.15044832j, -0.00815571-0.00277152j],
       [ 0.00815571-0.00277152j, -0.98858035-0.15044832j]]), array([[-0.97719128+0.20925065j, -0.03620934-0.000508j  ],
       [ 0.03620934-0.000508j  , -0.97719128-0.20925065j]]), array([[-0.96502918+0.26177163j, -0.01388072+0.00127431j],
       [ 0.01388072+0.00127431j, -0.96502918-0.26177163j]]), array([[ -9.37044967e-01 +3.49208690e-01j,
         -7.83797259e-05 +1.21624044e-04j],
       [  7.83797258e-05 +1.21624044e-04j,
         -9.37044967e-01 -3.49208690e-01j]]), array([[-0.87434194+0.48334976j, -0.04338009+0.0041659j ],
       [ 0.04338009+0.0041659j , -0.87434194-0.48334976j]]), array([[-0.73291616+0.64101745j,  0.22785540+0.00352802j],
       [-0.22785540+0.00352802j, -0.73291616-0.64101745j]]), array([[-0.46723873+0.88366353j,  0.02764009+0.00792225j],
       [-0.02764009+0.00792225j, -0.46723873-0.88366353j]]), array([[-0.00632396+0.99235247j,  0.02267943+0.12117023j],
       [-0.02267943+0.12117023j, -0.00632396-0.99235247j]]), array([[ 0.51783293+0.855361j  , -0.01269038-0.00675008j],
       [ 0.01269038-0.00675008j,  0.51783293-0.855361j  ]]), array([[  8.73345185e-01+0.48708565j,   7.11359330e-05+0.0039687j ],
       [ -7.11359330e-05+0.0039687j ,   8.73345185e-01-0.48708565j]]), array([[ 0.99997526-0.00667251j,  0.00185152+0.00123274j],
       [-0.00185152+0.00123274j,  0.99997526+0.00667251j]])], 'kpt': [[0.0, 0.0, 0], [0.026315789473684209, 0.0, 0], [0.052631578947368418, 0.0, 0], [0.078947368421052627, 0.0, 0], [0.10526315789473684, 0.0, 0], [0.13157894736842105, 0.0, 0], [0.15789473684210525, 0.0, 0], [0.18421052631578946, 0.0, 0], [0.21052631578947367, 0.0, 0], [0.23684210526315788, 0.0, 0], [0.26315789473684209, 0.0, 0], [0.28947368421052633, 0.0, 0], [0.31578947368421051, 0.0, 0], [0.34210526315789469, 0.0, 0], [0.36842105263157893, 0.0, 0], [0.39473684210526316, 0.0, 0], [0.42105263157894735, 0.0, 0], [0.44736842105263153, 0.0, 0], [0.47368421052631576, 0.0, 0], [0.5, 0.0, 0]], 'gap': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.49999999999999994, 0.50000000000000011, 0.5]}

        self.assertFullAlmostEqual(tb_surface.get_res(), res)

    def test_res2(self):
        """ test pos_check=False """
        self.createH(0, 0.3)
        # call to Z2Pack
        tb_system = z2pack.em.tb.System(self.model)
        tb_surface = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0])
        tb_surface.wcc_calc(verbose=False,
                            num_strings=20,
                            pickle_file=None,
                            pos_tol=None)

        res = {'t_par': [0.0, 0.052631578947368418, 0.10526315789473684, 0.15789473684210525, 0.21052631578947367, 0.26315789473684209, 0.31578947368421051, 0.36842105263157893, 0.42105263157894735, 0.47368421052631576, 0.52631578947368418, 0.57894736842105265, 0.63157894736842102, 0.68421052631578938, 0.73684210526315785, 0.78947368421052633, 0.84210526315789469, 0.89473684210526305, 0.94736842105263153, 1.0], 'wcc': [[0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.5, 0.5], [0.625, 0.625], [0.625, 0.625], [0.625, 0.625], [0.625, 0.625], [0.75, 0.75], [0.75, 0.75]], 'lambda_': [array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-1. -1.66533454e-16j,  0. +0.00000000e+00j],
       [ 0. +0.00000000e+00j, -1. -1.66533454e-16j]]), array([[-0.70710678+0.70710678j,  0.00000000+0.j        ],
       [ 0.00000000+0.j        , -0.70710678+0.70710678j]]), array([[-0.70710678+0.70710678j,  0.00000000+0.j        ],
       [ 0.00000000+0.j        , -0.70710678+0.70710678j]]), array([[-0.70710678+0.70710678j,  0.00000000+0.j        ],
       [ 0.00000000+0.j        , -0.70710678+0.70710678j]]), array([[-0.70710678+0.70710678j,  0.00000000+0.j        ],
       [ 0.00000000+0.j        , -0.70710678+0.70710678j]]), array([[ -1.11022302e-16+1.j,   0.00000000e+00+0.j],
       [  0.00000000e+00+0.j,  -1.11022302e-16+1.j]]), array([[ -1.11022302e-16+1.j,   0.00000000e+00+0.j],
       [  0.00000000e+00+0.j,  -1.11022302e-16+1.j]])], 'kpt': [[0.0, 0.0, 0], [0.026315789473684209, 0.0, 0], [0.052631578947368418, 0.0, 0], [0.078947368421052627, 0.0, 0], [0.10526315789473684, 0.0, 0], [0.13157894736842105, 0.0, 0], [0.15789473684210525, 0.0, 0], [0.18421052631578946, 0.0, 0], [0.21052631578947367, 0.0, 0], [0.23684210526315788, 0.0, 0], [0.26315789473684209, 0.0, 0], [0.28947368421052633, 0.0, 0], [0.31578947368421051, 0.0, 0], [0.34210526315789469, 0.0, 0], [0.36842105263157893, 0.0, 0], [0.39473684210526316, 0.0, 0], [0.42105263157894735, 0.0, 0], [0.44736842105263153, 0.0, 0], [0.47368421052631576, 0.0, 0], [0.5, 0.0, 0]], 'gap': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.125, 0.125, 0.125, 0.125, 0.25, 0.25]}

        self.assertFullAlmostEqual(tb_surface.get_res(), res)

    def test_res3(self):
        """ test gap_tol=None """
        self.createH(0.1, 0.3)
        # call to Z2Pack
        tb_system = z2pack.em.tb.System(self.model)
        tb_surface = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0])
        tb_surface.wcc_calc(verbose=False,
                            num_strings=20,
                            pickle_file=None,
                            gap_tol=None)

        res = {'t_par': [0.0, 0.052631578947368418, 0.10526315789473684, 0.15789473684210525, 0.21052631578947367, 0.26315789473684209, 0.31578947368421051, 0.36842105263157893, 0.42105263157894735, 0.47368421052631576, 0.52631578947368418, 0.57894736842105265, 0.63157894736842102, 0.68421052631578938, 0.73684210526315785, 0.78947368421052633, 0.84210526315789469, 0.89473684210526305, 0.94736842105263153, 1.0], 'wcc': [[0.49991853042386725, 0.50008146957613286], [0.49968033179007904, 0.50031966820992091], [0.49945915739782298, 0.50054084260217691], [0.49912731810352012, 0.50087268189648015], [0.49840861746748849, 0.50159138253251156], [0.49777900797017388, 0.50222099202982617], [0.49710234614617105, 0.50289765385382912], [0.49575581788013978, 0.50424418211986033], [0.49491179640161509, 0.50508820359838502], [0.49191770531427526, 0.50808229468572508], [0.49027576380229765, 0.50972423619770257], [0.48511552535529495, 0.51488447464470499], [0.47790097538481369, 0.52209902461518631], [0.46089190740235519, 0.53910809259764481], [0.42097693470264269, 0.57902306529735736], [0.32658685148699429, 0.67341314851300571], [0.22748507469695795, 0.77251492530304211], [0.14453538338495628, 0.8554646166150438], [0.067399261881237599, 0.93260073811876243], [0.0027474728039072836, 0.9972525271960927]], 'lambda_': [array([[ -9.99999869e-01 -5.08848218e-04j,
          3.25733077e-05 +4.51910023e-05j],
       [ -3.25733077e-05 +4.51910023e-05j,
         -9.99999869e-01 +5.08848218e-04j]]), array([[ -9.99997983e-01 +2.00739106e-03j,
          6.76772351e-05 -2.59629986e-06j],
       [ -6.76772351e-05 -2.59629986e-06j,
         -9.99997983e-01 -2.00739106e-03j]]), array([[ -9.99994226e-01+0.00337304j,   1.44366404e-05-0.00041256j],
       [ -1.44366404e-05-0.00041256j,  -9.99994226e-01-0.00337304j]]), array([[ -9.99984967e-01+0.00545904j,   1.94883941e-04-0.00047575j],
       [ -1.94883941e-04-0.00047575j,  -9.99984967e-01-0.00545904j]]), array([[ -9.99950011e-01 +9.99846771e-03j,
          7.92289064e-05 +7.89807754e-06j],
       [ -7.92289064e-05 +7.89807755e-06j,
         -9.99950011e-01 -9.99846771e-03j]]), array([[ -9.99902632e-01 +1.39516966e-02j,
         -2.77082750e-04 +1.02280728e-05j],
       [  2.77082750e-04 +1.02280728e-05j,
         -9.99902632e-01 -1.39516966e-02j]]), array([[ -9.99834266e-01+0.01819813j,  -4.17081771e-04+0.00030652j],
       [  4.17081771e-04+0.00030652j,  -9.99834266e-01-0.01819813j]]), array([[ -9.99644457e-01+0.02663694j,  -5.64950834e-04-0.00105525j],
       [  5.64950834e-04-0.00105525j,  -9.99644457e-01-0.02663694j]]), array([[ -9.99488999e-01 +3.19541041e-02j,
         -8.22191336e-04 +4.77577587e-06j],
       [  8.22191336e-04 +4.77577587e-06j,
         -9.99488999e-01 -3.19541041e-02j]]), array([[-0.99871084+0.05065094j, -0.00237885-0.00233982j],
       [ 0.00237885-0.00233982j, -0.99871084-0.05065094j]]), array([[-0.99813403+0.06099769j, -0.00224228-0.00164948j],
       [ 0.00224228-0.00164948j, -0.99813403-0.06099769j]]), array([[-0.99563001+0.09337116j, -0.00161219+0.00032639j],
       [ 0.00161219+0.00032639j, -0.99563001-0.09337116j]]), array([[ -9.90375502e-01+0.1384062j,   2.27776763e-04+0.00019j  ],
       [ -2.27776763e-04+0.00019j  ,  -9.90375502e-01-0.1384062j]]), array([[-0.96996161+0.24299983j, -0.01117899-0.00076977j],
       [ 0.01117899-0.00076977j, -0.96996161-0.24299983j]]), array([[-0.87924728+0.47000628j,  0.06916755-0.03513063j],
       [-0.06916755-0.03513063j, -0.87924728-0.47000628j]]), array([[-0.46285155+0.88643062j,  0.00202045-0.00226254j],
       [-0.00202045-0.00226254j, -0.46285155-0.88643062j]]), array([[ 0.14099407+0.98650187j, -0.03866915-0.07375244j],
       [ 0.03866915-0.07375244j,  0.14099407-0.98650187j]]), array([[ 0.61521112 +7.88361909e-01j, -0.00072536 +5.05898948e-04j],
       [ 0.00072536 +5.05898948e-04j,  0.61521112 -7.88361909e-01j]]), array([[ 0.91166356+0.41064404j, -0.00839516+0.01305905j],
       [ 0.00839516+0.01305905j,  0.91166356-0.41064404j]]), array([[ 0.99985100-0.01622965j,  0.00474889+0.00346757j],
       [-0.00474889+0.00346757j,  0.99985100+0.01622965j]])], 'kpt': [[0.0, 0.0, 0], [0.026315789473684209, 0.0, 0], [0.052631578947368418, 0.0, 0], [0.078947368421052627, 0.0, 0], [0.10526315789473684, 0.0, 0], [0.13157894736842105, 0.0, 0], [0.15789473684210525, 0.0, 0], [0.18421052631578946, 0.0, 0], [0.21052631578947367, 0.0, 0], [0.23684210526315788, 0.0, 0], [0.26315789473684209, 0.0, 0], [0.28947368421052633, 0.0, 0], [0.31578947368421051, 0.0, 0], [0.34210526315789469, 0.0, 0], [0.36842105263157893, 0.0, 0], [0.39473684210526316, 0.0, 0], [0.42105263157894735, 0.0, 0], [0.44736842105263153, 0.0, 0], [0.47368421052631576, 0.0, 0], [0.5, 0.0, 0]], 'gap': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.2204460492503131e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.5, 0.5, 0.5]}

        self.assertFullAlmostEqual(tb_surface.get_res(), res)

    def test_res4(self):
        """ test move_tol=None """
        self.createH(0.1, 0.3)
        # call to Z2Pack
        tb_system = z2pack.em.tb.System(self.model)
        tb_surface = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0])
        tb_surface.wcc_calc(verbose=False,
                          num_strings=20,
                          pickle_file=None,
                          move_tol=None)

        res = {'t_par': [0.0, 0.052631578947368418, 0.10526315789473684, 0.15789473684210525, 0.21052631578947367, 0.26315789473684209, 0.31578947368421051, 0.36842105263157893, 0.42105263157894735, 0.47368421052631576, 0.52631578947368418, 0.57894736842105265, 0.63157894736842102, 0.68421052631578938, 0.73684210526315785, 0.78947368421052633, 0.84210526315789469, 0.89473684210526305, 0.94736842105263153, 1.0], 'wcc': [[0.49991853042386725, 0.50008146957613286], [0.49968033179007904, 0.50031966820992091], [0.49945915739782298, 0.50054084260217691], [0.49912731810352012, 0.50087268189648015], [0.49840861746748849, 0.50159138253251156], [0.49777900797017388, 0.50222099202982617], [0.49710234614617105, 0.50289765385382912], [0.49575581788013978, 0.50424418211986033], [0.49491179640161509, 0.50508820359838502], [0.49191770531427526, 0.50808229468572508], [0.49027576380229765, 0.50972423619770257], [0.48511552535529495, 0.51488447464470499], [0.47790097538481369, 0.52209902461518631], [0.46089190740235519, 0.53910809259764481], [0.42097693470264269, 0.57902306529735736], [0.32658685148699429, 0.67341314851300571], [0.22748507469695795, 0.77251492530304211], [0.14453538338495628, 0.8554646166150438], [0.067399261881237599, 0.93260073811876243], [0.0027474728039072836, 0.9972525271960927]], 'lambda_': [array([[ -9.99999869e-01 -5.08848218e-04j,
          3.25733077e-05 +4.51910023e-05j],
       [ -3.25733077e-05 +4.51910023e-05j,
         -9.99999869e-01 +5.08848218e-04j]]), array([[ -9.99997983e-01 +2.00739106e-03j,
          6.76772351e-05 -2.59629986e-06j],
       [ -6.76772351e-05 -2.59629986e-06j,
         -9.99997983e-01 -2.00739106e-03j]]), array([[ -9.99994226e-01+0.00337304j,   1.44366404e-05-0.00041256j],
       [ -1.44366404e-05-0.00041256j,  -9.99994226e-01-0.00337304j]]), array([[ -9.99984967e-01+0.00545904j,   1.94883941e-04-0.00047575j],
       [ -1.94883941e-04-0.00047575j,  -9.99984967e-01-0.00545904j]]), array([[ -9.99950011e-01 +9.99846771e-03j,
          7.92289064e-05 +7.89807754e-06j],
       [ -7.92289064e-05 +7.89807755e-06j,
         -9.99950011e-01 -9.99846771e-03j]]), array([[ -9.99902632e-01 +1.39516966e-02j,
         -2.77082750e-04 +1.02280728e-05j],
       [  2.77082750e-04 +1.02280728e-05j,
         -9.99902632e-01 -1.39516966e-02j]]), array([[ -9.99834266e-01+0.01819813j,  -4.17081771e-04+0.00030652j],
       [  4.17081771e-04+0.00030652j,  -9.99834266e-01-0.01819813j]]), array([[ -9.99644457e-01+0.02663694j,  -5.64950834e-04-0.00105525j],
       [  5.64950834e-04-0.00105525j,  -9.99644457e-01-0.02663694j]]), array([[ -9.99488999e-01 +3.19541041e-02j,
         -8.22191336e-04 +4.77577587e-06j],
       [  8.22191336e-04 +4.77577587e-06j,
         -9.99488999e-01 -3.19541041e-02j]]), array([[-0.99871084+0.05065094j, -0.00237885-0.00233982j],
       [ 0.00237885-0.00233982j, -0.99871084-0.05065094j]]), array([[-0.99813403+0.06099769j, -0.00224228-0.00164948j],
       [ 0.00224228-0.00164948j, -0.99813403-0.06099769j]]), array([[-0.99563001+0.09337116j, -0.00161219+0.00032639j],
       [ 0.00161219+0.00032639j, -0.99563001-0.09337116j]]), array([[ -9.90375502e-01+0.1384062j,   2.27776763e-04+0.00019j  ],
       [ -2.27776763e-04+0.00019j  ,  -9.90375502e-01-0.1384062j]]), array([[-0.96996161+0.24299983j, -0.01117899-0.00076977j],
       [ 0.01117899-0.00076977j, -0.96996161-0.24299983j]]), array([[-0.87924728+0.47000628j,  0.06916755-0.03513063j],
       [-0.06916755-0.03513063j, -0.87924728-0.47000628j]]), array([[-0.46285155+0.88643062j,  0.00202045-0.00226254j],
       [-0.00202045-0.00226254j, -0.46285155-0.88643062j]]), array([[ 0.14099407+0.98650187j, -0.03866915-0.07375244j],
       [ 0.03866915-0.07375244j,  0.14099407-0.98650187j]]), array([[ 0.61521112 +7.88361909e-01j, -0.00072536 +5.05898948e-04j],
       [ 0.00072536 +5.05898948e-04j,  0.61521112 -7.88361909e-01j]]), array([[ 0.91166356+0.41064404j, -0.00839516+0.01305905j],
       [ 0.00839516+0.01305905j,  0.91166356-0.41064404j]]), array([[ 0.99985100-0.01622965j,  0.00474889+0.00346757j],
       [-0.00474889+0.00346757j,  0.99985100+0.01622965j]])], 'kpt': [[0.0, 0.0, 0], [0.026315789473684209, 0.0, 0], [0.052631578947368418, 0.0, 0], [0.078947368421052627, 0.0, 0], [0.10526315789473684, 0.0, 0], [0.13157894736842105, 0.0, 0], [0.15789473684210525, 0.0, 0], [0.18421052631578946, 0.0, 0], [0.21052631578947367, 0.0, 0], [0.23684210526315788, 0.0, 0], [0.26315789473684209, 0.0, 0], [0.28947368421052633, 0.0, 0], [0.31578947368421051, 0.0, 0], [0.34210526315789469, 0.0, 0], [0.36842105263157893, 0.0, 0], [0.39473684210526316, 0.0, 0], [0.42105263157894735, 0.0, 0], [0.44736842105263153, 0.0, 0], [0.47368421052631576, 0.0, 0], [0.5, 0.0, 0]], 'gap': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.2204460492503131e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.5, 0.5, 0.5]}

        self.assertFullAlmostEqual(tb_surface.get_res(), res)

    def test_res5(self):
        """ test gap_tol=None and move_tol=None"""
        self.createH(0.1, 0.3)
        # call to Z2Pack
        tb_system = z2pack.em.tb.System(self.model)
        tb_surface = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0])
        tb_surface.wcc_calc(verbose=False,
                            num_strings=20,
                            pickle_file=None,
                            gap_tol=None,
                            move_tol=None)

        res = {'t_par': [0.0, 0.052631578947368418, 0.10526315789473684, 0.15789473684210525, 0.21052631578947367, 0.26315789473684209, 0.31578947368421051, 0.36842105263157893, 0.42105263157894735, 0.47368421052631576, 0.52631578947368418, 0.57894736842105265, 0.63157894736842102, 0.68421052631578938, 0.73684210526315785, 0.78947368421052633, 0.84210526315789469, 0.89473684210526305, 0.94736842105263153, 1.0], 'wcc': [[0.49991853042386725, 0.50008146957613286], [0.49968033179007904, 0.50031966820992091], [0.49945915739782298, 0.50054084260217691], [0.49912731810352012, 0.50087268189648015], [0.49840861746748849, 0.50159138253251156], [0.49777900797017388, 0.50222099202982617], [0.49710234614617105, 0.50289765385382912], [0.49575581788013978, 0.50424418211986033], [0.49491179640161509, 0.50508820359838502], [0.49191770531427526, 0.50808229468572508], [0.49027576380229765, 0.50972423619770257], [0.48511552535529495, 0.51488447464470499], [0.47790097538481369, 0.52209902461518631], [0.46089190740235519, 0.53910809259764481], [0.42097693470264269, 0.57902306529735736], [0.32658685148699429, 0.67341314851300571], [0.22748507469695795, 0.77251492530304211], [0.14453538338495628, 0.8554646166150438], [0.067399261881237599, 0.93260073811876243], [0.0027474728039072836, 0.9972525271960927]], 'lambda_': [array([[ -9.99999869e-01 -5.08848218e-04j,
          3.25733077e-05 +4.51910023e-05j],
       [ -3.25733077e-05 +4.51910023e-05j,
         -9.99999869e-01 +5.08848218e-04j]]), array([[ -9.99997983e-01 +2.00739106e-03j,
          6.76772351e-05 -2.59629986e-06j],
       [ -6.76772351e-05 -2.59629986e-06j,
         -9.99997983e-01 -2.00739106e-03j]]), array([[ -9.99994226e-01+0.00337304j,   1.44366404e-05-0.00041256j],
       [ -1.44366404e-05-0.00041256j,  -9.99994226e-01-0.00337304j]]), array([[ -9.99984967e-01+0.00545904j,   1.94883941e-04-0.00047575j],
       [ -1.94883941e-04-0.00047575j,  -9.99984967e-01-0.00545904j]]), array([[ -9.99950011e-01 +9.99846771e-03j,
          7.92289064e-05 +7.89807754e-06j],
       [ -7.92289064e-05 +7.89807755e-06j,
         -9.99950011e-01 -9.99846771e-03j]]), array([[ -9.99902632e-01 +1.39516966e-02j,
         -2.77082750e-04 +1.02280728e-05j],
       [  2.77082750e-04 +1.02280728e-05j,
         -9.99902632e-01 -1.39516966e-02j]]), array([[ -9.99834266e-01+0.01819813j,  -4.17081771e-04+0.00030652j],
       [  4.17081771e-04+0.00030652j,  -9.99834266e-01-0.01819813j]]), array([[ -9.99644457e-01+0.02663694j,  -5.64950834e-04-0.00105525j],
       [  5.64950834e-04-0.00105525j,  -9.99644457e-01-0.02663694j]]), array([[ -9.99488999e-01 +3.19541041e-02j,
         -8.22191336e-04 +4.77577587e-06j],
       [  8.22191336e-04 +4.77577587e-06j,
         -9.99488999e-01 -3.19541041e-02j]]), array([[-0.99871084+0.05065094j, -0.00237885-0.00233982j],
       [ 0.00237885-0.00233982j, -0.99871084-0.05065094j]]), array([[-0.99813403+0.06099769j, -0.00224228-0.00164948j],
       [ 0.00224228-0.00164948j, -0.99813403-0.06099769j]]), array([[-0.99563001+0.09337116j, -0.00161219+0.00032639j],
       [ 0.00161219+0.00032639j, -0.99563001-0.09337116j]]), array([[ -9.90375502e-01+0.1384062j,   2.27776763e-04+0.00019j  ],
       [ -2.27776763e-04+0.00019j  ,  -9.90375502e-01-0.1384062j]]), array([[-0.96996161+0.24299983j, -0.01117899-0.00076977j],
       [ 0.01117899-0.00076977j, -0.96996161-0.24299983j]]), array([[-0.87924728+0.47000628j,  0.06916755-0.03513063j],
       [-0.06916755-0.03513063j, -0.87924728-0.47000628j]]), array([[-0.46285155+0.88643062j,  0.00202045-0.00226254j],
       [-0.00202045-0.00226254j, -0.46285155-0.88643062j]]), array([[ 0.14099407+0.98650187j, -0.03866915-0.07375244j],
       [ 0.03866915-0.07375244j,  0.14099407-0.98650187j]]), array([[ 0.61521112 +7.88361909e-01j, -0.00072536 +5.05898948e-04j],
       [ 0.00072536 +5.05898948e-04j,  0.61521112 -7.88361909e-01j]]), array([[ 0.91166356+0.41064404j, -0.00839516+0.01305905j],
       [ 0.00839516+0.01305905j,  0.91166356-0.41064404j]]), array([[ 0.99985100-0.01622965j,  0.00474889+0.00346757j],
       [-0.00474889+0.00346757j,  0.99985100+0.01622965j]])], 'kpt': [[0.0, 0.0, 0], [0.026315789473684209, 0.0, 0], [0.052631578947368418, 0.0, 0], [0.078947368421052627, 0.0, 0], [0.10526315789473684, 0.0, 0], [0.13157894736842105, 0.0, 0], [0.15789473684210525, 0.0, 0], [0.18421052631578946, 0.0, 0], [0.21052631578947367, 0.0, 0], [0.23684210526315788, 0.0, 0], [0.26315789473684209, 0.0, 0], [0.28947368421052633, 0.0, 0], [0.31578947368421051, 0.0, 0], [0.34210526315789469, 0.0, 0], [0.36842105263157893, 0.0, 0], [0.39473684210526316, 0.0, 0], [0.42105263157894735, 0.0, 0], [0.44736842105263153, 0.0, 0], [0.47368421052631576, 0.0, 0], [0.5, 0.0, 0]], 'gap': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.2204460492503131e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.5, 0.5, 0.5]}

        self.assertFullAlmostEqual(tb_surface.get_res(), res)
        
    def test_res6(self):
        """ Force convergence fails"""
        self.createH(0.1, 0.3)
        # call to Z2Pack
        tb_system = z2pack.em.tb.System(self.model)
        tb_surface = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0])
        tb_surface.wcc_calc(verbose=False,
                            num_strings=20,
                            pickle_file=None,
                            gap_tol=1.,
                            move_tol=1e-12,
                            pos_tol=1e-12,
                            min_neighbour_dist=5e-3)

        res = {'t_par': [0.0, 0.0032894736842105261, 0.0065789473684210523, 0.0098684210526315784, 0.013157894736842105, 0.016447368421052631, 0.019736842105263157, 0.023026315789473683, 0.026315789473684209, 0.029605263157894735, 0.032894736842105261, 0.036184210526315791, 0.039473684210526314, 0.042763157894736836, 0.046052631578947366, 0.049342105263157895, 0.052631578947368418, 0.055921052631578941, 0.05921052631578947, 0.0625, 0.065789473684210523, 0.069078947368421045, 0.072368421052631582, 0.075657894736842105, 0.078947368421052627, 0.08223684210526315, 0.085526315789473673, 0.088815789473684209, 0.092105263157894732, 0.095394736842105254, 0.098684210526315791, 0.10197368421052631, 0.10526315789473684, 0.10855263157894736, 0.11184210526315788, 0.11513157894736842, 0.11842105263157894, 0.12171052631578946, 0.125, 0.12828947368421051, 0.13157894736842105, 0.13486842105263158, 0.13815789473684209, 0.14144736842105263, 0.14473684210526316, 0.14802631578947367, 0.15131578947368421, 0.15460526315789475, 0.15789473684210525, 0.16118421052631576, 0.1644736842105263, 0.16776315789473684, 0.17105263157894735, 0.17434210526315788, 0.17763157894736842, 0.18092105263157893, 0.18421052631578946, 0.1875, 0.19078947368421051, 0.19407894736842105, 0.19736842105263158, 0.20065789473684209, 0.20394736842105263, 0.20723684210526316, 0.21052631578947367, 0.21381578947368418, 0.21710526315789472, 0.22039473684210525, 0.22368421052631576, 0.2269736842105263, 0.23026315789473684, 0.23355263157894735, 0.23684210526315788, 0.24013157894736842, 0.24342105263157893, 0.24671052631578946, 0.25, 0.25328947368421051, 0.25657894736842102, 0.25986842105263153, 0.26315789473684209, 0.26644736842105265, 0.26973684210526316, 0.27302631578947367, 0.27631578947368418, 0.27960526315789469, 0.28289473684210525, 0.28618421052631582, 0.28947368421052633, 0.29276315789473684, 0.29605263157894735, 0.29934210526315785, 0.30263157894736842, 0.30592105263157898, 0.30921052631578949, 0.3125, 0.31578947368421051, 0.31907894736842102, 0.32236842105263153, 0.32565789473684204, 0.3289473684210526, 0.33223684210526316, 0.33552631578947367, 0.33881578947368418, 0.34210526315789469, 0.3453947368421052, 0.34868421052631576, 0.35197368421052633, 0.35526315789473684, 0.35855263157894735, 0.36184210526315785, 0.36513157894736836, 0.36842105263157893, 0.37171052631578949, 0.375, 0.37828947368421051, 0.38157894736842102, 0.38486842105263153, 0.38815789473684209, 0.39144736842105265, 0.39473684210526316, 0.39802631578947367, 0.40131578947368418, 0.40460526315789469, 0.40789473684210525, 0.41118421052631582, 0.41447368421052633, 0.41776315789473684, 0.42105263157894735, 0.42434210526315785, 0.42763157894736836, 0.43092105263157887, 0.43421052631578944, 0.4375, 0.44078947368421051, 0.44407894736842102, 0.44736842105263153, 0.45065789473684204, 0.4539473684210526, 0.45723684210526316, 0.46052631578947367, 0.46381578947368418, 0.46710526315789469, 0.4703947368421052, 0.47368421052631576, 0.47697368421052633, 0.48026315789473684, 0.48355263157894735, 0.48684210526315785, 0.49013157894736836, 0.49342105263157893, 0.49671052631578949, 0.5, 0.50328947368421051, 0.50657894736842102, 0.50986842105263153, 0.51315789473684204, 0.51644736842105254, 0.51973684210526305, 0.52302631578947367, 0.52631578947368418, 0.52960526315789469, 0.53289473684210531, 0.53618421052631582, 0.53947368421052633, 0.54276315789473684, 0.54605263157894735, 0.54934210526315785, 0.55263157894736836, 0.55592105263157887, 0.55921052631578938, 0.5625, 0.56578947368421051, 0.56907894736842102, 0.57236842105263164, 0.57565789473684215, 0.57894736842105265, 0.58223684210526316, 0.58552631578947367, 0.58881578947368418, 0.59210526315789469, 0.5953947368421052, 0.59868421052631571, 0.60197368421052633, 0.60526315789473684, 0.60855263157894735, 0.61184210526315796, 0.61513157894736847, 0.61842105263157898, 0.62171052631578949, 0.625, 0.62828947368421051, 0.63157894736842102, 0.63486842105263153, 0.63815789473684204, 0.64144736842105254, 0.64473684210526305, 0.64802631578947356, 0.65131578947368407, 0.65460526315789469, 0.6578947368421052, 0.66118421052631571, 0.66447368421052633, 0.66776315789473684, 0.67105263157894735, 0.67434210526315785, 0.67763157894736836, 0.68092105263157887, 0.68421052631578938, 0.68749999999999989, 0.6907894736842104, 0.69407894736842102, 0.69736842105263153, 0.70065789473684204, 0.70394736842105265, 0.70723684210526316, 0.71052631578947367, 0.71381578947368418, 0.71710526315789469, 0.7203947368421052, 0.72368421052631571, 0.72697368421052622, 0.73026315789473673, 0.73355263157894735, 0.73684210526315785, 0.74013157894736836, 0.74342105263157898, 0.74671052631578949, 0.75, 0.75328947368421051, 0.75657894736842102, 0.75986842105263153, 0.76315789473684204, 0.76644736842105254, 0.76973684210526305, 0.77302631578947367, 0.77631578947368418, 0.77960526315789469, 0.78289473684210531, 0.78618421052631582, 0.78947368421052633, 0.79276315789473684, 0.79605263157894735, 0.79934210526315785, 0.80263157894736836, 0.80592105263157887, 0.80921052631578938, 0.8125, 0.81578947368421051, 0.81907894736842102, 0.82236842105263164, 0.82565789473684215, 0.82894736842105265, 0.83223684210526316, 0.83552631578947367, 0.83881578947368418, 0.84210526315789469, 0.8453947368421052, 0.84868421052631571, 0.85197368421052622, 0.85526315789473673, 0.85855263157894723, 0.86184210526315774, 0.86513157894736836, 0.86842105263157887, 0.87171052631578938, 0.875, 0.87828947368421051, 0.88157894736842102, 0.88486842105263153, 0.88815789473684204, 0.89144736842105254, 0.89473684210526305, 0.89802631578947356, 0.90131578947368407, 0.90460526315789469, 0.9078947368421052, 0.91118421052631571, 0.91447368421052633, 0.91776315789473684, 0.92105263157894735, 0.92434210526315785, 0.92763157894736836, 0.93092105263157887, 0.93421052631578938, 0.93749999999999989, 0.9407894736842104, 0.94407894736842102, 0.94736842105263153, 0.95065789473684204, 0.95394736842105265, 0.95723684210526316, 0.96052631578947367, 0.96381578947368418, 0.96710526315789469, 0.9703947368421052, 0.97368421052631571, 0.97697368421052622, 0.98026315789473673, 0.98355263157894735, 0.98684210526315785, 0.99013157894736836, 0.99342105263157898, 0.99671052631578949, 1.0], 'wcc': [[0.49989756445522526, 0.50010243554477474], [0.49954199459589071, 0.50045800540410901], [0.49995354399128217, 0.50004645600871789], [0.49994088407319265, 0.5000591159268073], [0.49948010650345903, 0.50051989349654091], [0.49986905304749812, 0.50013094695250171], [0.49989073928099098, 0.50010926071900885], [0.49988508807542242, 0.50011491192457769], [0.49994793385970909, 0.50005206614029085], [0.49972677034895219, 0.5002732296510477], [0.4998386846394044, 0.5001613153605956], [0.4996678766641281, 0.50033212333587196], [0.4992916430035097, 0.50070835699649008], [0.49976488504049815, 0.5002351149595019], [0.49966971673357402, 0.50033028326642603], [0.49931495709688201, 0.50068504290311777], [0.49967737169603987, 0.5003226283039599], [0.49960486560706091, 0.50039513439293914], [0.49949088434080341, 0.50050911565919631], [0.49974637316071391, 0.50025362683928565], [0.49948713475189011, 0.50051286524810989], [0.49890086340796291, 0.50109913659203698], [0.4994207863392407, 0.50057921366075908], [0.49932115539779293, 0.50067884460220702], [0.49942930343466063, 0.50057069656533915], [0.49932235132490843, 0.50067764867509157], [0.499184232468038, 0.500815767531962], [0.499248231607411, 0.50075176839258906], [0.49910201855567582, 0.50089798144432407], [0.49938477209643795, 0.50061522790356217], [0.49916171685254579, 0.50083828314745416], [0.49930733242025466, 0.50069266757974518], [0.4988237143128682, 0.50117628568713168], [0.49931043733867403, 0.50068956266132614], [0.49918406695114137, 0.50081593304885841], [0.49905284938101691, 0.50094715061898309], [0.49907808329067865, 0.5009219167093214], [0.49883156007709717, 0.50116843992290283], [0.49917664945076201, 0.50082335054923788], [0.4987729443534743, 0.5012270556465257], [0.49965436646105393, 0.50034563353894601], [0.49861481714948053, 0.5013851828505197], [0.49895709470727551, 0.50104290529272455], [0.49954940289667787, 0.50045059710332218], [0.4984400303847854, 0.50155996961521465], [0.49901838862480763, 0.50098161137519226], [0.49858958446484658, 0.50141041553515375], [0.49877863886223506, 0.50122136113776494], [0.49801903595470409, 0.50198096404529591], [0.49857879145801831, 0.5014212085419818], [0.49912745368498801, 0.50087254631501199], [0.49851257682087224, 0.50148742317912776], [0.49787203355215387, 0.50212796644784619], [0.49871925159335817, 0.50128074840664172], [0.49817958034286081, 0.50182041965713919], [0.49869448574088704, 0.50130551425911307], [0.49868358180104122, 0.50131641819895878], [0.49842257127475625, 0.50157742872524391], [0.49887399875773009, 0.50112600124226991], [0.49828248188610497, 0.5017175181138952], [0.49796472284824966, 0.50203527715175023], [0.49816515106777026, 0.50183484893222974], [0.49833361457887565, 0.50166638542112407], [0.49832476933040032, 0.50167523066959951], [0.49757393760977064, 0.50242606239022924], [0.49754413943194747, 0.50245586056805247], [0.49748235452522888, 0.50251764547477107], [0.49751713451587432, 0.50248286548412557], [0.49752137180207207, 0.5024786281979281], [0.49743979301645225, 0.50256020698354775], [0.49760127812637678, 0.50239872187362322], [0.497675637902673, 0.50232436209732712], [0.49815894439077207, 0.50184105560922787], [0.49803241052210362, 0.50196758947789655], [0.4983857662708906, 0.50161423372910918], [0.49849317875302579, 0.50150682124697443], [0.49726974718931349, 0.50273025281068651], [0.49766687738926069, 0.50233312261073926], [0.49727267969037409, 0.50272732030962575], [0.49689857951773575, 0.50310142048226414], [0.49718954802092175, 0.50281045197907814], [0.49776426466299578, 0.50223573533700427], [0.49752262672534731, 0.50247737327465258], [0.49735652264637403, 0.5026434773536258], [0.49732323672846346, 0.50267676327153643], [0.4970011857177663, 0.5029988142822337], [0.49761738853065868, 0.50238261146934149], [0.49749231881477241, 0.50250768118522759], [0.4971752508227022, 0.50282474917729769], [0.49794190429872565, 0.50205809570127458], [0.49767262522671252, 0.50232737477328726], [0.49697199938849368, 0.50302800061150643], [0.49724293847934198, 0.50275706152065813], [0.49656458570143019, 0.50343541429856975], [0.49739059288087456, 0.50260940711912572], [0.49719946067641591, 0.50280053932358393], [0.49721638050790512, 0.50278361949209471], [0.49647660184964126, 0.50352339815035863], [0.49641378075816756, 0.50358621924183233], [0.49592203137571222, 0.50407796862428766], [0.49647646690314462, 0.50352353309685549], [0.49647861551815142, 0.50352138448184858], [0.49641178771124289, 0.50358821228875694], [0.49675496836923932, 0.50324503163076062], [0.49711259631651461, 0.5028874036834855], [0.49635587027851219, 0.50364412972148753], [0.49613872033877704, 0.50386127966122285], [0.49599775213958208, 0.50400224786041792], [0.49612820546738895, 0.50387179453261077], [0.49649712577796379, 0.50350287422203621], [0.49653463179802243, 0.50346536820197763], [0.4958035958891952, 0.5041964041108048], [0.49677342098452748, 0.50322657901547252], [0.4956491135911012, 0.50435088640889891], [0.49575547281316684, 0.50424452718683344], [0.49567825492829798, 0.50432174507170191], [0.49499338439448526, 0.50500661560551452], [0.49519065791924294, 0.5048093420807569], [0.49663018206447213, 0.5033698179355276], [0.49711060932706019, 0.5028893906729397], [0.49490859637072643, 0.50509140362927329], [0.49528351738768867, 0.50471648261231139], [0.49510949964979434, 0.50489050035020577], [0.49492668491291808, 0.50507331508708164], [0.49476859635864207, 0.50523140364135766], [0.49488586099507892, 0.50511413900492119], [0.49430893106462953, 0.50569106893537041], [0.49462104493877107, 0.50537895506122887], [0.49434006532574948, 0.50565993467425041], [0.49419805082845647, 0.50580194917154353], [0.49518191418606683, 0.50481808581393306], [0.49473024293540241, 0.50526975706459742], [0.49444902677858193, 0.50555097322141818], [0.49396417279357291, 0.50603582720642692], [0.49390432468494616, 0.50609567531505384], [0.49371678083378118, 0.50628321916621877], [0.49346459314469188, 0.50653540685530796], [0.49315660799412525, 0.50684339200587458], [0.49293992267959968, 0.50706007732040037], [0.49306722348619986, 0.5069327765138002], [0.49330005276453281, 0.50669994723546719], [0.49261765431753962, 0.50738234568246043], [0.49351809522105961, 0.50648190477894017], [0.49232256691806253, 0.50767743308193747], [0.49175760312289396, 0.50824239687710604], [0.49344264302696372, 0.50655735697303617], [0.49283661605897577, 0.50716338394102412], [0.49169732752059686, 0.50830267247940331], [0.48981474523190111, 0.51018525476809895], [0.49189093122814076, 0.50810906877185913], [0.49134717182481785, 0.50865282817518209], [0.4915397255286244, 0.50846027447137554], [0.49126535969927548, 0.50873464030072446], [0.49131439419346962, 0.50868560580653055], [0.49037579071088344, 0.50962420928911634], [0.48956147997717692, 0.51043852002282286], [0.49077148053317465, 0.50922851946682535], [0.49043653422489836, 0.50956346577510137], [0.49038936965960139, 0.50961063034039855], [0.48978083443782627, 0.51021916556217395], [0.48965833699225009, 0.51034166300774997], [0.48663645747413287, 0.51336354252586713], [0.49055864828366241, 0.50944135171633753], [0.49020007365254992, 0.50979992634744986], [0.48835760884719792, 0.51164239115280219], [0.48873722202974829, 0.51126277797025188], [0.48779201528997163, 0.51220798471002849], [0.48803671154113248, 0.5119632884588674], [0.48874946151160947, 0.51125053848839042], [0.4857403811590229, 0.51425961884097704], [0.48431398614777071, 0.51568601385222923], [0.48834552598898739, 0.51165447401101261], [0.48550168531957294, 0.51449831468042706], [0.48607829720496082, 0.51392170279503913], [0.48597620784705686, 0.51402379215294303], [0.48343270035127078, 0.51656729964872905], [0.48456860581896172, 0.51543139418103823], [0.4864710796490786, 0.51352892035092146], [0.48351752271625931, 0.51648247728374064], [0.48342708089530617, 0.51657291910469394], [0.48275991605313862, 0.5172400839468615], [0.4818381004869855, 0.51816189951301461], [0.48270979265791103, 0.51729020734208908], [0.48124584915995755, 0.51875415084004262], [0.48140252681270063, 0.51859747318729932], [0.48033307297571781, 0.51966692702428219], [0.47894145362402119, 0.5210585463759787], [0.47878181118087249, 0.52121818881912763], [0.47715629059351033, 0.52284370940648994], [0.47818352498652961, 0.52181647501347017], [0.47745291490882763, 0.52254708509117243], [0.47809460519432539, 0.52190539480567444], [0.47455860774285119, 0.52544139225714903], [0.47541174932488922, 0.5245882506751105], [0.47669524646942635, 0.52330475353057371], [0.47442376916503037, 0.52557623083496952], [0.47105760946980374, 0.5289423905301962], [0.46539382366703436, 0.53460617633296548], [0.47145481359249464, 0.52854518640750536], [0.46843152234365187, 0.53156847765634796], [0.46789854026890659, 0.53210145973109335], [0.46260242392844902, 0.53739757607155081], [0.46818052259954385, 0.5318194774004561], [0.46396927494843426, 0.5360307250515659], [0.4607085141718576, 0.53929148582814235], [0.46229986868534834, 0.53770013131465166], [0.46002134797142158, 0.53997865202857831], [0.45143237096627992, 0.54856762903372003], [0.45191529089737376, 0.54808470910262641], [0.45423068316570658, 0.54576931683429319], [0.44564309830503046, 0.55435690169496954], [0.44979219571011497, 0.55020780428988503], [0.44684523733776149, 0.5531547626622384], [0.44472205376157403, 0.55527794623842563], [0.44094770683493256, 0.55905229316506699], [0.43766036278902631, 0.56233963721097346], [0.43439061270700513, 0.5656093872929947], [0.42828546588991218, 0.57171453411008755], [0.42757721458654885, 0.57242278541345082], [0.42748028173245889, 0.57251971826754111], [0.42715641368935564, 0.57284358631064436], [0.42181612160868098, 0.57818387839131891], [0.4123265447213782, 0.58767345527862136], [0.41285911220720889, 0.58714088779279094], [0.40723233077226928, 0.59276766922773039], [0.39704615854137904, 0.60295384145862108], [0.39653248042140504, 0.60346751957859479], [0.39344022229242304, 0.60655977770757707], [0.38938229291184245, 0.61061770708815744], [0.37784482562222238, 0.62215517437777745], [0.37626283023030982, 0.62373716976969007], [0.3740973727516187, 0.62590262724838142], [0.36962543007073712, 0.63037456992926288], [0.36210465100677158, 0.63789534899322842], [0.35638297801490049, 0.64361702198509974], [0.34610921630773528, 0.65389078369226472], [0.34132398528205238, 0.65867601471794768], [0.33396197031142383, 0.66603802968857617], [0.33032308454868159, 0.66967691545131836], [0.33059015537897884, 0.66940984462102104], [0.31390560106242377, 0.68609439893757584], [0.30865606888688829, 0.69134393111311154], [0.30498623339839392, 0.69501376660160608], [0.3016655659738644, 0.69833443402613571], [0.29074249073036529, 0.70925750926963449], [0.2855140226653044, 0.71448597733469543], [0.27391252840050467, 0.72608747159949516], [0.27136846230919676, 0.72863153769080313], [0.26623525130960479, 0.7337647486903951], [0.25846740454988687, 0.74153259545011307], [0.25378956145303577, 0.74621043854696412], [0.24555236705490613, 0.75444763294509376], [0.24420860533041067, 0.75579139466958933], [0.23629855704184266, 0.76370144295815745], [0.23395142978943201, 0.76604857021056771], [0.22737821505505101, 0.77262178494494904], [0.21898344290336483, 0.7810165570966352], [0.21055483747533221, 0.7894451625246679], [0.21333899093665284, 0.78666100906334702], [0.20264741641459671, 0.79735258358540351], [0.19893664628226621, 0.80106335371773385], [0.19213080372039207, 0.80786919627960785], [0.18578894087461942, 0.81421105912538039], [0.18406630406301971, 0.81593369593698029], [0.1759699414462477, 0.82403005855375222], [0.1729005340509025, 0.82709946594909733], [0.1717931021670133, 0.8282068978329864], [0.1606876339974499, 0.8393123660025501], [0.15728328094582439, 0.84271671905417556], [0.15265981516657728, 0.84734018483342255], [0.14579476236249367, 0.85420523763750644], [0.14010227037209771, 0.85989772962790201], [0.13737075628297638, 0.86262924371702387], [0.13613804894295367, 0.86386195105704622], [0.1290756419664067, 0.87092435803359325], [0.12328835774706025, 0.87671164225293974], [0.11381808915984581, 0.88618191084015407], [0.11297519543872542, 0.88702480456127475], [0.10826609889079138, 0.89173390110920858], [0.10524088051881052, 0.89475911948118947], [0.099965236275898414, 0.90003476372410163], [0.099078695248494733, 0.90092130475150523], [0.091864012456807795, 0.90813598754319214], [0.092775552922244903, 0.90722444707775507], [0.080359262709233548, 0.91964073729076645], [0.078126032307208312, 0.9218739676927914], [0.073515306168168343, 0.92648469383183141], [0.069439304242625358, 0.93056069575737443], [0.066832234370169913, 0.93316776562983006], [0.061722599217434546, 0.93827740078256527], [0.058936415997027876, 0.94106358400297208], [0.053617612584616219, 0.94638238741538372], [0.049242344184104073, 0.95075765581589589], [0.043978534402990412, 0.95602146559700951], [0.042961111926436563, 0.95703888807356341], [0.03717342900700852, 0.96282657099299152], [0.035231187410881278, 0.96476881258911873], [0.034382888342423486, 0.96561711165757658], [0.023044553933865574, 0.97695544606613427], [0.014645910847815101, 0.98535408915218492], [0.013102457712776339, 0.98689754228722348], [0.020375951953080437, 0.97962404804691949], [0.0066371485002683769, 0.99336285149973169], [0.0020406959483158242, 0.99795930405168443], [0.00046297266350683484, 0.99953702733649352]], 'lambda_': [array([[ -9.99999793e-01 +6.42395895e-04j,
          1.49243473e-05 -3.67881559e-05j],
       [ -1.49243473e-05 -3.67881559e-05j,
         -9.99999793e-01 -6.42395895e-04j]]), array([[ -9.99995859e-01-0.00282025j,  -2.60964176e-04+0.00050932j],
       [  2.60964176e-04+0.00050932j,  -9.99995859e-01+0.00282025j]]), array([[ -9.99999957e-01 +2.80522060e-04j,
          1.21699322e-05 -7.97498301e-05j],
       [ -1.21699322e-05 -7.97498301e-05j,
         -9.99999957e-01 -2.80522060e-04j]]), array([[ -9.99999931e-01-0.00034311j,  -2.79948057e-05-0.00013948j],
       [  2.79948057e-05-0.00013948j,  -9.99999931e-01+0.00034311j]]), array([[ -9.99994665e-01-0.00316218j,  -4.14274431e-04-0.00070679j],
       [  4.14274431e-04-0.00070679j,  -9.99994665e-01+0.00316218j]]), array([[ -9.99999662e-01 +8.22761959e-04j,
         -1.67613749e-06 -5.86462107e-07j],
       [  1.67613749e-06 -5.86462108e-07j,
         -9.99999662e-01 -8.22761959e-04j]]), array([[ -9.99999764e-01 +6.83506723e-04j,
          2.56624965e-06 -6.40428597e-05j],
       [ -2.56624965e-06 -6.40428597e-05j,
         -9.99999764e-01 -6.83506723e-04j]]), array([[ -9.99999739e-01 +4.06828925e-05j,
          4.76512429e-04 -5.40909759e-04j],
       [ -4.76512429e-04 -5.40909759e-04j,
         -9.99999739e-01 -4.06828925e-05j]]), array([[ -9.99999946e-01 -3.13542949e-04j,
         -4.66984690e-05 -8.08173116e-05j],
       [  4.66984690e-05 -8.08173116e-05j,
         -9.99999946e-01 +3.13542949e-04j]]), array([[ -9.99998526e-01 +1.71600795e-03j,
         -2.25838917e-05 +4.52000076e-05j],
       [  2.25838917e-05 +4.52000076e-05j,
         -9.99998526e-01 -1.71600795e-03j]]), array([[ -9.99999486e-01+0.00052032j,   8.59192590e-05+0.00086557j],
       [ -8.59192590e-05+0.00086557j,  -9.99999486e-01-0.00052032j]]), array([[ -9.99997823e-01+0.00207186j,   5.51933217e-05+0.00024299j],
       [ -5.51933217e-05+0.00024299j,  -9.99997823e-01-0.00207186j]]), array([[ -9.99990095e-01+0.00438478j,  -3.41989886e-05-0.00076252j],
       [  3.41989886e-05-0.00076252j,  -9.99990095e-01-0.00438478j]]), array([[ -9.99998909e-01 +1.47633241e-03j,
         -5.18106897e-05 +9.26661349e-06j],
       [  5.18106897e-05 +9.26661349e-06j,
         -9.99998909e-01 -1.47633241e-03j]]), array([[ -9.99997847e-01 +2.07463219e-03j,
          9.68424682e-06 +4.88351376e-05j],
       [ -9.68424682e-06 +4.88351376e-05j,
         -9.99997847e-01 -2.07463219e-03j]]), array([[ -9.99990737e-01+0.00429406j,  -2.56465819e-04-0.0001474j ],
       [  2.56465819e-04-0.0001474j ,  -9.99990737e-01-0.00429406j]]), array([[ -9.99997945e-01+0.00179031j,   7.34194542e-05-0.00094798j],
       [ -7.34194542e-05-0.00094798j,  -9.99997945e-01-0.00179031j]]), array([[ -9.99996918e-01+0.00246804j,   2.35521165e-05-0.0002684j ],
       [ -2.35521165e-05-0.0002684j ,  -9.99996918e-01-0.00246804j]]), array([[ -9.99994884e-01 +3.19854862e-03j,
         -3.73122312e-05 +2.48249932e-05j],
       [  3.73122312e-05 +2.48249932e-05j,
         -9.99994884e-01 -3.19854862e-03j]]), array([[ -9.99998730e-01+0.00150513j,   1.76265096e-04+0.00049296j],
       [ -1.76265096e-04+0.00049296j,  -9.99998730e-01-0.00150513j]]), array([[ -9.99994808e-01 +3.22241583e-03j,
         -6.15162056e-06 +8.38858018e-07j],
       [  6.15162056e-06 +8.38858019e-07j,
         -9.99994808e-01 -3.22241583e-03j]]), array([[ -9.99976153e-01+0.00682354j,  -4.32558443e-04+0.00097233j],
       [  4.32558443e-04+0.00097233j,  -9.99976153e-01-0.00682354j]]), array([[ -9.99993378e-01+0.00363788j,   9.00122837e-06+0.00010111j],
       [ -9.00122837e-06+0.00010111j,  -9.99993378e-01-0.00363788j]]), array([[ -9.99990904e-01+0.004263j ,  -3.72243848e-05-0.0001348j],
       [  3.72243848e-05-0.0001348j,  -9.99990904e-01-0.004263j ]]), array([[ -9.99993571e-01+0.00356536j,  -1.76119186e-04+0.00033914j],
       [  1.76119186e-04+0.00033914j,  -9.99993571e-01-0.00356536j]]), array([[ -9.99990936e-01+0.00424675j,   1.01395572e-04-0.00028906j],
       [ -1.01395572e-04-0.00028906j,  -9.99990936e-01-0.00424675j]]), array([[ -9.99986864e-01 +5.12515025e-03j,
         -2.63726562e-05 -6.22503097e-05j],
       [  2.63726562e-05 -6.22503097e-05j,
         -9.99986864e-01 -5.12515025e-03j]]), array([[ -9.99988844e-01 +4.72186216e-03j,
         -1.20854662e-04 +2.64452513e-05j],
       [  1.20854662e-04 +2.64452513e-05j,
         -9.99988844e-01 -4.72186216e-03j]]), array([[ -9.99984083e-01 +5.63693801e-03j,
          2.39673885e-04 -3.72386616e-05j],
       [ -2.39673885e-04 -3.72386616e-05j,
         -9.99984083e-01 -5.63693801e-03j]]), array([[ -9.99992529e-01 +3.86536059e-03j,
          2.80178217e-05 +3.03523138e-05j],
       [ -2.80178217e-05 +3.03523138e-05j,
         -9.99992529e-01 -3.86536059e-03j]]), array([[ -9.99986129e-01 +5.26678702e-03j,
         -5.33552320e-05 -8.41791205e-06j],
       [  5.33552320e-05 -8.41791205e-06j,
         -9.99986129e-01 -5.26678702e-03j]]), array([[ -9.99990529e-01 +4.34564227e-03j,
         -2.32035206e-04 +5.21462870e-05j],
       [  2.32035206e-04 +5.21462870e-05j,
         -9.99990529e-01 -4.34564227e-03j]]), array([[ -9.99972688e-01+0.00737568j,  -3.10087989e-04-0.00035559j],
       [  3.10087989e-04-0.00035559j,  -9.99972688e-01-0.00737568j]]), array([[ -9.99990614e-01+0.00432466j,   2.77018113e-05-0.00026125j],
       [ -2.77018113e-05-0.00026125j,  -9.99990614e-01-0.00432466j]]), array([[ -9.99986859e-01+0.00510521j,   2.29512689e-04-0.00040811j],
       [ -2.29512689e-04-0.00040811j,  -9.99986859e-01-0.00510521j]]), array([[ -9.99982292e-01+0.00594585j,  -1.29540077e-04-0.0002134j ],
       [  1.29540077e-04-0.0002134j ,  -9.99982292e-01-0.00594585j]]), array([[ -9.99983223e-01+0.00575789j,   4.84269150e-04-0.00040714j],
       [ -4.84269150e-04-0.00040714j,  -9.99983223e-01-0.00575789j]]), array([[ -9.99973051e-01+0.00733179j,  -2.45969957e-04-0.00028528j],
       [  2.45969957e-04-0.00028528j,  -9.99973051e-01-0.00733179j]]), array([[ -9.99986619e-01+0.00514208j,   8.08187101e-05+0.0005612j ],
       [ -8.08187101e-05+0.0005612j ,  -9.99986619e-01-0.00514208j]]), array([[ -9.99970280e-01+0.00770489j,  -2.41530120e-04+0.00012851j],
       [  2.41530120e-04+0.00012851j,  -9.99970280e-01-0.00770489j]]), array([[ -9.99997642e-01+0.00214095j,  -3.49100110e-04+0.00010311j],
       [  3.49100110e-04+0.00010311j,  -9.99997642e-01-0.00214095j]]), array([[ -9.99962126e-01+0.00870088j,  -1.34667699e-04-0.00015222j],
       [  1.34667699e-04-0.00015222j,  -9.99962126e-01-0.00870088j]]), array([[ -9.99978531e-01+0.00649524j,  -2.13757468e-04-0.00083924j],
       [  2.13757468e-04-0.00083924j,  -9.99978531e-01-0.00649524j]]), array([[ -9.99995992e-01+0.00266273j,   6.26528226e-04+0.00073001j],
       [ -6.26528226e-04+0.00073001j,  -9.99995992e-01-0.00266273j]]), array([[ -9.99951965e-01+0.0097926j ,  -2.17067665e-04-0.00035468j],
       [  2.17067665e-04-0.00035468j,  -9.99951965e-01-0.0097926j ]]), array([[ -9.99980980e-01+0.00533307j,  -5.73509327e-04+0.00304447j],
       [  5.73509327e-04+0.00304447j,  -9.99980980e-01-0.00533307j]]), array([[ -9.99960734e-01 +8.85925091e-03j,
         -2.10583847e-04 -2.41227973e-05j],
       [  2.10583847e-04 -2.41227973e-05j,
         -9.99960734e-01 -8.85925091e-03j]]), array([[ -9.99970555e-01 +7.67374547e-03j,
         -4.02117262e-05 -4.14984643e-05j],
       [  4.02117262e-05 -4.14984643e-05j,
         -9.99970555e-01 -7.67374547e-03j]]), array([[ -9.99922540e-01+0.01243821j,  -4.25919980e-04+0.00015341j],
       [  4.25919980e-04+0.00015341j,  -9.99922540e-01-0.01243821j]]), array([[ -9.99960130e-01 +8.92808292e-03j,
         -1.34615813e-04 -9.45177564e-05j],
       [  1.34615813e-04 -9.45177564e-05j,
         -9.99960130e-01 -8.92808292e-03j]]), array([[ -9.99984972e-01+0.00547331j,   7.24699183e-05-0.00030608j],
       [ -7.24699183e-05-0.00030608j,  -9.99984972e-01-0.00547331j]]), array([[ -9.99956329e-01 +9.34499402e-03j,
         -9.59549537e-05 +4.98160853e-05j],
       [  9.59549537e-05 +4.98160853e-05j,
         -9.99956329e-01 -9.34499402e-03j]]), array([[ -9.99910617e-01+0.01328116j,   5.57850304e-04+0.00143412j],
       [ -5.57850304e-04+0.00143412j,  -9.99910617e-01-0.01328116j]]), array([[ -9.99967622e-01+0.00804206j,  -2.42367467e-04+0.00014883j],
       [  2.42367467e-04+0.00014883j,  -9.99967622e-01-0.00804206j]]), array([[ -9.99934586e-01+0.01143408j,   9.28791740e-05-0.00027589j],
       [ -9.28791740e-05-0.00027589j,  -9.99934586e-01-0.01143408j]]), array([[ -9.99966357e-01+0.00819817j,  -6.90962353e-05-0.0002634j ],
       [  6.90962353e-05-0.0002634j ,  -9.99966357e-01-0.00819817j]]), array([[ -9.99965793e-01 +8.27096425e-03j,
         -5.24646661e-05 +3.51113476e-05j],
       [  5.24646661e-05 +3.51113476e-05j,
         -9.99965793e-01 -8.27096425e-03j]]), array([[ -9.99950884e-01+0.00984733j,  -4.40978370e-04+0.0010324j ],
       [  4.40978370e-04+0.0010324j ,  -9.99950884e-01-0.00984733j]]), array([[ -9.99974973e-01+0.00705798j,  -1.40406955e-05-0.00048764j],
       [  1.40406955e-05-0.00048764j,  -9.99974973e-01-0.00705798j]]), array([[ -9.99941772e-01 +1.07843009e-02j,
         -3.87906724e-04 -6.17356360e-07j],
       [  3.87906724e-04 -6.17356360e-07j,
         -9.99941772e-01 -1.07843009e-02j]]), array([[ -9.99918234e-01+0.01275151j,  -3.43138169e-04-0.0008977j ],
       [  3.43138169e-04-0.0008977j ,  -9.99918234e-01-0.01275151j]]), array([[ -9.99933545e-01+0.01150965j,   8.63829650e-05+0.00065226j],
       [ -8.63829650e-05+0.00065226j,  -9.99933545e-01-0.01150965j]]), array([[ -9.99945188e-01+0.01039623j,  -1.74442936e-04+0.00122849j],
       [  1.74442936e-04+0.00122849j,  -9.99945188e-01-0.01039623j]]), array([[ -9.99944604e-01 +1.05255399e-02j,
         -3.00823888e-05 +1.25832974e-05j],
       [  3.00823888e-05 +1.25832974e-05j,
         -9.99944604e-01 -1.05255399e-02j]]), array([[ -9.99883822e-01+0.01523107j,  -2.16559491e-04+0.00055742j],
       [  2.16559491e-04+0.00055742j,  -9.99883822e-01-0.01523107j]]), array([[ -9.99880950e-01+0.01542443j,  -3.97154553e-04+0.00012019j],
       [  3.97154553e-04+0.00012019j,  -9.99880950e-01-0.01542443j]]), array([[ -9.99874885e-01+0.01578482j,  -7.08272522e-07-0.00102662j],
       [  7.08272522e-07-0.00102662j,  -9.99874885e-01-0.01578482j]]), array([[ -9.99878318e-01 +1.55890246e-02j,
         -5.72844606e-04 +6.24533545e-05j],
       [  5.72844606e-04 +6.24533545e-05j,
         -9.99878318e-01 -1.55890246e-02j]]), array([[ -9.99878733e-01+0.01550778j,   2.45283539e-05+0.00142414j],
       [ -2.45283539e-05+0.00142414j,  -9.99878733e-01-0.01550778j]]), array([[ -9.99870619e-01+0.01608053j,   2.33692327e-04+0.00032755j],
       [ -2.33692327e-04+0.00032755j,  -9.99870619e-01-0.01608053j]]), array([[ -9.99886425e-01+0.01506847j,   1.67312706e-04+0.00022283j],
       [ -1.67312706e-04+0.00022283j,  -9.99886425e-01-0.01506847j]]), array([[ -9.99893358e-01+0.01460136j,   1.94514207e-04-0.0001891j ],
       [ -1.94514207e-04-0.0001891j ,  -9.99893358e-01-0.01460136j]]), array([[ -9.99933095e-01+0.01153973j,   3.60708018e-04+0.00071422j],
       [ -3.60708018e-04+0.00071422j,  -9.99933095e-01-0.01153973j]]), array([[ -9.99923582e-01+0.01236027j,   1.74063044e-04+0.00015068j],
       [ -1.74063044e-04+0.00015068j,  -9.99923582e-01-0.01236027j]]), array([[ -9.99948565e-01 +1.01382511e-02j,
         -2.76516152e-04 +8.23651290e-05j],
       [  2.76516152e-04 +8.23651290e-05j,
         -9.99948565e-01 -1.01382511e-02j]]), array([[ -9.99955182e-01+0.00942307j,   8.39327390e-05-0.00091219j],
       [ -8.39327390e-05-0.00091219j,  -9.99955182e-01-0.00942307j]]), array([[ -9.99852862e-01+0.01714624j,   1.26116480e-05+0.00051038j],
       [ -1.26116480e-05+0.00051038j,  -9.99852862e-01-0.01714624j]]), array([[ -9.99892552e-01+0.01462733j,  -3.70799077e-04+0.0008874j ],
       [  3.70799077e-04+0.0008874j ,  -9.99892552e-01-0.01462733j]]), array([[-0.99985318+0.01710203j, -0.00104531-0.00022456j],
       [ 0.00104531-0.00022456j, -0.99985318-0.01710203j]]), array([[ -9.99810138e-01+0.01947623j,  -3.70435210e-04+0.00047576j],
       [  3.70435210e-04+0.00047576j,  -9.99810138e-01-0.01947623j]]), array([[ -9.99844091e-01+0.01764295j,  -5.28494637e-04+0.00049042j],
       [  5.28494637e-04+0.00049042j,  -9.99844091e-01-0.01764295j]]), array([[ -9.99901335e-01+0.01402411j,  -4.70563236e-05+0.00080161j],
       [  4.70563236e-05+0.00080161j,  -9.99901335e-01-0.01402411j]]), array([[ -9.99878855e-01+0.01555097j,  -5.96357578e-04+0.00029326j],
       [  5.96357578e-04+0.00029326j,  -9.99878855e-01-0.01555097j]]), array([[ -9.99862066e-01+0.01660287j,  -3.61121435e-04+0.00025134j],
       [  3.61121435e-04+0.00025134j,  -9.99862066e-01-0.01660287j]]), array([[ -9.99858571e-01 +1.68008773e-02j,
          7.54282616e-04 +1.42714067e-05j],
       [ -7.54282616e-04 +1.42714067e-05j,
         -9.99858571e-01 -1.68008773e-02j]]), array([[ -9.99822493e-01+0.01883904j,  -2.31849931e-04-0.00014011j],
       [  2.31849931e-04-0.00014011j,  -9.99822493e-01-0.01883904j]]), array([[ -9.99887946e-01+0.01496859j,   1.25889778e-04-0.00014571j],
       [ -1.25889778e-04-0.00014571j,  -9.99887946e-01-0.01496859j]]), array([[ -9.99875873e-01+0.01575266j,  -1.16991224e-04+0.00027937j],
       [  1.16991224e-04+0.00027937j,  -9.99875873e-01-0.01575266j]]), array([[ -9.99842501e-01+0.0177319j ,  -4.80121438e-04-0.00056812j],
       [  4.80121438e-04-0.00056812j,  -9.99842501e-01-0.0177319j ]]), array([[ -9.99916391e-01+0.01277007j,  -4.02784492e-04+0.00199368j],
       [  4.02784492e-04+0.00199368j,  -9.99916391e-01-0.01277007j]]), array([[ -9.99893081e-01+0.01385042j,   5.28585219e-04-0.00465971j],
       [ -5.28585219e-04-0.00465971j,  -9.99893081e-01-0.01385042j]]), array([[ -9.99819021e-01+0.01901746j,  -4.63392653e-04-0.0002165j ],
       [  4.63392653e-04-0.0002165j ,  -9.99819021e-01-0.01901746j]]), array([[ -9.99849958e-01+0.01731927j,  -2.70133050e-04-0.00017564j],
       [  2.70133050e-04-0.00017564j,  -9.99849958e-01-0.01731927j]]), array([[ -9.99767045e-01+0.02155117j,  -7.32745103e-04-0.00093j   ],
       [  7.32745103e-04-0.00093j   ,  -9.99767045e-01-0.02155117j]]), array([[ -9.99865599e-01+0.01639059j,   3.43277802e-04-0.00012382j],
       [ -3.43277802e-04-0.00012382j,  -9.99865599e-01-0.01639059j]]), array([[ -9.99845189e-01+0.01759293j,  -1.47631089e-04-0.00025545j],
       [  1.47631089e-04-0.00025545j,  -9.99845189e-01-0.01759293j]]), array([[ -9.99847054e-01+0.01748479j,  -3.46561408e-04-0.00017583j],
       [  3.46561408e-04-0.00017583j,  -9.99847054e-01-0.01748479j]]), array([[-0.99975496+0.02204986j, -0.00123042-0.00151921j],
       [ 0.00123042-0.00151921j, -0.99975496-0.02204986j]]), array([[-0.99974615 +2.25065949e-02j, -0.00104742 +2.91722161e-05j],
       [ 0.00104742 +2.91722161e-05j, -0.99974615 -2.25065949e-02j]]), array([[ -9.99671758e-01+0.02561423j,  -2.31344165e-04-0.0004832j ],
       [  2.31344165e-04-0.0004832j ,  -9.99671758e-01-0.02561423j]]), array([[ -9.99754942e-01 +2.21369460e-02j,
         -3.89881217e-05 -9.92720041e-05j],
       [  3.89881217e-05 -9.92720041e-05j,
         -9.99754942e-01 -2.21369460e-02j]]), array([[ -9.99755241e-01+0.022118j  ,   4.19413031e-04+0.00027665j],
       [ -4.19413031e-04+0.00027665j,  -9.99755241e-01-0.022118j  ]]), array([[ -9.99745863e-01+0.02253738j,  -5.12295776e-04-0.00011518j],
       [  5.12295776e-04-0.00011518j,  -9.99745863e-01-0.02253738j]]), array([[ -9.99792149e-01+0.02037261j,  -7.17871251e-04+0.00031737j],
       [  7.17871251e-04+0.00031737j,  -9.99792149e-01-0.02037261j]]), array([[-0.99983544+0.01785179j, -0.00156748+0.00282062j],
       [ 0.00156748+0.00282062j, -0.99983544-0.01785179j]]), array([[ -9.99737881e-01+0.02289353j,  -2.11330784e-04+0.00010336j],
       [  2.11330784e-04+0.00010336j,  -9.99737881e-01-0.02289353j]]), array([[-0.99970571 +2.42373433e-02j,  0.00101870 -2.59167394e-05j],
       [-0.00101870 -2.59167394e-05j, -0.99970571 -2.42373433e-02j]]), array([[-0.99968383+0.02498544j, -0.00143266-0.0024304j ],
       [ 0.00143266-0.0024304j , -0.99968383-0.02498544j]]), array([[ -9.99704108e-01+0.0243244j ,   6.85405172e-07-0.00014026j],
       [ -6.85405172e-07-0.00014026j,  -9.99704108e-01-0.0243244j ]]), array([[ -9.99757807e-01+0.0220019j ,   3.82894673e-04+0.00031141j],
       [ -3.82894673e-04+0.00031141j,  -9.99757807e-01-0.0220019j ]]), array([[ -9.99762966e-01 +2.17717656e-02j,
         -4.17775204e-05 +3.26803195e-05j],
       [  4.17775204e-05 +3.26803195e-05j,
         -9.99762966e-01 -2.17717656e-02j]]), array([[ -9.99652416e-01+0.02635913j,   1.67235459e-04+0.00046326j],
       [ -1.67235459e-04+0.00046326j,  -9.99652416e-01-0.02635913j]]), array([[ -9.99794506e-01+0.02025832j,  -6.26533860e-04-0.00039239j],
       [  6.26533860e-04-0.00039239j,  -9.99794506e-01-0.02025832j]]), array([[ -9.99626356e-01 +2.73263067e-02j,
         -6.41803809e-04 +9.86768983e-05j],
       [  6.41803809e-04 +9.86768983e-05j,
         -9.99626356e-01 -2.73263067e-02j]]), array([[ -9.99644399e-01+0.02666524j,   1.61665044e-04-0.00011689j],
       [ -1.61665044e-04-0.00011689j,  -9.99644399e-01-0.02666524j]]), array([[ -9.99631344e-01+0.02714762j,   3.31364330e-04+0.00027056j],
       [ -3.31364330e-04+0.00027056j,  -9.99631344e-01-0.02714762j]]), array([[ -9.99505254e-01+0.03143694j,  -9.26733870e-04+0.00032794j],
       [  9.26733870e-04+0.00032794j,  -9.99505254e-01-0.03143694j]]), array([[-0.99954347+0.03017809j, -0.00127813-0.00070558j],
       [ 0.00127813-0.00070558j, -0.99954347-0.03017809j]]), array([[-0.99977586+0.02098615j, -0.00253032-0.00118997j],
       [ 0.00253032-0.00118997j, -0.99977586-0.02098615j]]), array([[ -9.99835210e-01+0.01804009j,   1.24151253e-04-0.00202293j],
       [ -1.24151253e-04-0.00202293j,  -9.99835210e-01-0.01804009j]]), array([[ -9.99488356e-01+0.03197691j,   6.32001624e-04+0.00032171j],
       [ -6.32001624e-04+0.00032171j,  -9.99488356e-01-0.03197691j]]), array([[ -9.99560929e-01+0.02962665j,  -3.42884305e-04+0.00030428j],
       [  3.42884305e-04+0.00030428j,  -9.99560929e-01-0.02962665j]]), array([[-0.99952793+0.03066079j, -0.00193622+0.00027354j],
       [ 0.00193622+0.00027354j, -0.99952793-0.03066079j]]), array([[-0.99949198+0.03183662j, -0.00141619-0.00044273j],
       [ 0.00141619-0.00044273j, -0.99949198-0.03183662j]]), array([[ -9.99459834e-01+0.03286301j,   1.87974399e-04-0.00016448j],
       [ -1.87974399e-04-0.00016448j,  -9.99459834e-01-0.03286301j]]), array([[ -9.99483777e-01+0.03211992j,  -6.55818126e-04+0.00024552j],
       [  6.55818126e-04+0.00024552j,  -9.99483777e-01-0.03211992j]]), array([[ -9.99360749e-01 +3.57503496e-02j,
          3.97747997e-05 -5.93372412e-05j],
       [ -3.97747997e-05 -5.93372412e-05j,
         -9.99360749e-01 -3.57503496e-02j]]), array([[ -9.99428937e-01 +3.37835267e-02j,
          6.85488986e-04 -6.22036482e-05j],
       [ -6.85488986e-04 -6.22036482e-05j,
         -9.99428937e-01 -3.37835267e-02j]]), array([[ -9.99367724e-01+0.03554028j,  -8.49313857e-04+0.00056547j],
       [  8.49313857e-04+0.00056547j,  -9.99367724e-01-0.03554028j]]), array([[ -9.99335600e-01+0.03643803j,   3.40973017e-04+0.00071528j],
       [ -3.40973017e-04+0.00071528j,  -9.99335600e-01-0.03643803j]]), array([[-0.99954181+0.02964441j, -0.00167277+0.00588057j],
       [ 0.00167277+0.00588057j, -0.99954181-0.02964441j]]), array([[-0.99945189+0.03306936j,  0.00138130+0.0006615j ],
       [-0.00138130+0.0006615j , -0.99945189-0.03306936j]]), array([[-0.99939183+0.03481861j, -0.00168372+0.00089278j],
       [ 0.00168372+0.00089278j, -0.99939183-0.03481861j]]), array([[ -9.99280963e-01 +3.79143726e-02j,
          2.23059024e-04 -8.79397723e-05j],
       [ -2.23059024e-04 -8.79397723e-05j,
         -9.99280963e-01 -3.79143726e-02j]]), array([[-0.99926663+0.03826671j,  0.00100213-0.0009203j ],
       [-0.00100213-0.0009203j , -0.99926663-0.03826671j]]), array([[-0.99922082+0.03943324j,  0.00102296+0.00131377j],
       [-0.00102296+0.00131377j, -0.99922082-0.03943324j]]), array([[ -9.99157026e-01 +4.10514767e-02j,
         -1.12416814e-04 -1.47228550e-05j],
       [  1.12416814e-04 -1.47228550e-05j,
         -9.99157026e-01 -4.10514767e-02j]]), array([[ -9.99075716e-01+0.04297762j,   3.92073852e-04+0.00069641j],
       [ -3.92073852e-04+0.00069641j,  -9.99075716e-01-0.04297762j]]), array([[-0.99901627+0.04432628j,  0.00129002+0.00012643j],
       [-0.00129002+0.00012643j, -0.99901627-0.04432628j]]), array([[-0.99905142 +4.35257528e-02j, -0.00133233 -2.24996365e-05j],
       [ 0.00133233 -2.24996365e-05j, -0.99905142 -4.35257528e-02j]]), array([[-0.99911405+0.04206397j, -0.00126951-0.00034953j],
       [ 0.00126951-0.00034953j, -0.99911405-0.04206397j]]), array([[ -9.98924425e-01+0.04629695j,  -4.53728050e-04-0.00252569j],
       [  4.53728050e-04-0.00252569j,  -9.98924425e-01-0.04629695j]]), array([[-0.99917077+0.04068619j,  0.00109028+0.0011033j ],
       [-0.00109028+0.0011033j , -0.99917077-0.04068619j]]), array([[-0.99883674+0.04808937j,  0.00202558+0.00291214j],
       [-0.00202558+0.00291214j, -0.99883674-0.04808937j]]), array([[ -9.98659275e-01+0.05154893j,  -1.76149228e-04-0.00472543j],
       [  1.76149228e-04-0.00472543j,  -9.98659275e-01-0.05154893j]]), array([[ -9.99151355e-01+0.04118815j,   4.05270066e-05-0.00032199j],
       [ -4.05270066e-05-0.00032199j,  -9.99151355e-01-0.04118815j]]), array([[-0.99898727+0.04494197j,  0.00204527+0.00068302j],
       [-0.00204527+0.00068302j, -0.99898727-0.04494197j]]), array([[-0.99863960+0.05211602j,  0.00158784+0.00059307j],
       [-0.00158784+0.00059307j, -0.99863960-0.05211602j]]), array([[-0.99795296+0.06393681j,  0.00125010-0.00063399j],
       [-0.00125010-0.00063399j, -0.99795296-0.06393681j]]), array([[-0.99870229+0.05088425j,  0.00190307-0.00095262j],
       [-0.00190307-0.00095262j, -0.99870229-0.05088425j]]), array([[-0.99852246+0.05431946j, -0.00136941+0.00064483j],
       [ 0.00136941+0.00064483j, -0.99852246-0.05431946j]]), array([[-0.99858747+0.05304036j, -0.00302517-0.00079018j],
       [ 0.00302517-0.00079018j, -0.99858747-0.05304036j]]), array([[ -9.98494396e-01 +5.48538176e-02j,
          1.12346106e-16 +5.68455103e-18j],
       [ -5.59748850e-17 -3.43926060e-17j,
         -9.98494396e-01 -5.48538176e-02j]]), array([[ -9.98511249e-01 +5.45460716e-02j,
         -8.35960233e-05 +7.42045441e-05j],
       [  8.35960233e-05 +7.42045441e-05j,
         -9.98511249e-01 -5.45460716e-02j]]), array([[-0.99817220+0.06019741j, -0.00325712+0.00423226j],
       [ 0.00325712+0.00423226j, -0.99817220-0.06019741j]]), array([[-0.99784993+0.06541306j,  0.00184349+0.00363914j],
       [-0.00184349+0.00363914j, -0.99784993-0.06541306j]]), array([[-0.99831937+0.05777601j, -0.00396447-0.00215661j],
       [ 0.00396447-0.00215661j, -0.99831937-0.05777601j]]), array([[-0.99819520+0.05991077j,  0.00261695-0.00319352j],
       [-0.00261695-0.00319352j, -0.99819520-0.05991077j]]), array([[-0.99817736+0.05995618j,  0.00684181-0.00063972j],
       [-0.00684181-0.00063972j, -0.99817736-0.05995618j]]), array([[-0.99793932 +6.40975603e-02j, -0.00293551 +8.43731673e-05j],
       [ 0.00293551 +8.43731673e-05j, -0.99793932 -6.40975603e-02j]]), array([[-0.99788963+0.06487039j, -0.00258065-0.00120417j],
       [ 0.00258065-0.00120417j, -0.99788963-0.06487039j]]), array([[ -9.96476958e-01+0.08373409j,   1.89969909e-04-0.00471559j],
       [ -1.89969909e-04-0.00471559j,  -9.96476958e-01-0.08373409j]]), array([[-0.99824098 +5.91484642e-02j,  0.00404917 -9.43548075e-05j],
       [-0.00404917 -9.43548075e-05j, -0.99824098 -5.91484642e-02j]]), array([[-0.99810487+0.06148913j,  0.00137456+0.0019642j ],
       [-0.00137456+0.0019642j , -0.99810487-0.06148913j]]), array([[-0.99732564+0.07287703j, -0.00323166+0.00447999j],
       [ 0.00323166+0.00447999j, -0.99732564-0.07287703j]]), array([[ -9.97497123e-01+0.07070113j,   5.39057815e-04+0.00074133j],
       [ -5.39057815e-04+0.00074133j,  -9.97497123e-01-0.07070113j]]), array([[-0.99705961 +7.65155138e-02j,  0.00418422 -9.93327858e-07j],
       [-0.00418422 -9.93327858e-07j, -0.99705961 -7.65155138e-02j]]), array([[-0.99717625+0.07494227j,  0.00468441+0.00111409j],
       [-0.00468441+0.00111409j, -0.99717625-0.07494227j]]), array([[-0.99750256+0.07030146j, -0.00680720-0.0001203j ],
       [ 0.00680720-0.0001203j , -0.99750256-0.07030146j]]), array([[-0.99598898+0.08908569j, -0.00571282+0.00608754j],
       [ 0.00571282+0.00608754j, -0.99598898-0.08908569j]]), array([[-0.99514708+0.09666656j, -0.00797026-0.01656338j],
       [ 0.00797026-0.01656338j, -0.99514708-0.09666656j]]), array([[ -9.97320085e-01+0.07313779j,   5.51675443e-04+0.00179098j],
       [ -5.51675443e-04+0.00179098j,  -9.97320085e-01-0.07313779j]]), array([[-0.99585366+0.09084922j, -0.00426455+0.00192659j],
       [ 0.00426455+0.00192659j, -0.99585366-0.09084922j]]), array([[-0.99617671 +8.73372445e-02j, -0.00204224 -4.90943852e-05j],
       [ 0.00204224 -4.90943852e-05j, -0.99617671 -8.73372445e-02j]]), array([[-0.99612047+0.08784819j,  0.00492401-0.00157128j],
       [-0.00492401-0.00157128j, -0.99612047-0.08784819j]]), array([[-0.99458696+0.10386371j, -0.00265544-0.0014322j ],
       [ 0.00265544-0.0014322j , -0.99458696-0.10386371j]]), array([[-0.99530322+0.09675073j, -0.00314027+0.00096225j],
       [ 0.00314027+0.00096225j, -0.99530322-0.09675073j]]), array([[-0.99638927+0.08476953j,  0.00387198-0.00274735j],
       [-0.00387198-0.00274735j, -0.99638927-0.08476953j]]), array([[-0.99464220+0.10323437j,  0.00446885+0.0030965j ],
       [-0.00446885+0.0030965j , -0.99464220-0.10323437j]]), array([[-0.99458329+0.10322154j, -0.00628231-0.01048415j],
       [ 0.00628231-0.01048415j, -0.99458329-0.10322154j]]), array([[-0.99413884+0.1080928j , -0.00179075+0.00084354j],
       [ 0.00179075+0.00084354j, -0.99413884-0.1080928j ]]), array([[-0.99349599+0.1137127j , -0.00541665-0.00240681j],
       [ 0.00541665-0.00240681j, -0.99349599-0.1137127j ]]), array([[-0.99410474+0.1081981j , -0.00390543+0.00580377j],
       [ 0.00390543+0.00580377j, -0.99410474-0.1081981j ]]), array([[ -9.93065391e-01+0.11754126j,   9.68406747e-04-0.00206001j],
       [ -9.68406747e-04-0.00206001j,  -9.93065391e-01-0.11754126j]]), array([[-0.99318064+0.11651183j, -0.00354814-0.00214784j],
       [ 0.00354814-0.00214784j, -0.99318064-0.11651183j]]), array([[-0.99237482+0.12277241j, -0.01090452+0.00049158j],
       [ 0.01090452+0.00049158j, -0.99237482-0.12277241j]]), array([[ -9.91259167e-01+0.13192883j,  -8.56965353e-05+0.00019844j],
       [  8.56965353e-05+0.00019844j,  -9.91259167e-01-0.13192883j]]), array([[-0.99112634+0.13281718j,  0.00530239+0.00026075j],
       [-0.00530239+0.00026075j, -0.99112634-0.13281718j]]), array([[-0.98971706+0.14271664j,  0.00930052-0.00236695j],
       [-0.00930052-0.00236695j, -0.98971706-0.14271664j]]), array([[-0.99061966+0.13639838j,  0.00703593-0.00432152j],
       [-0.00703593-0.00432152j, -0.99061966-0.13639838j]]), array([[-0.98998193+0.1404658j ,  0.00597002+0.01301908j],
       [-0.00597002+0.01301908j, -0.98998193-0.1404658j ]]), array([[-0.99054316+0.1366426j , -0.01175068+0.00387011j],
       [ 0.01175068+0.00387011j, -0.99054316-0.1366426j ]]), array([[ -9.87250695e-01+0.15917074j,   1.12134599e-04-0.00085212j],
       [ -1.12134599e-04-0.00085212j,  -9.87250695e-01-0.15917074j]]), array([[-0.98808975+0.15367946j,  0.00556592-0.00550447j],
       [-0.00556592-0.00550447j, -0.98808975-0.15367946j]]), array([[-0.98929855+0.14360984j,  0.02567157-0.00235856j],
       [-0.02567157-0.00235856j, -0.98929855-0.14360984j]]), array([[-0.98711549+0.1596638j , -0.00950912-0.00447913j],
       [ 0.00950912-0.00447913j, -0.98711549-0.1596638j ]]), array([[ -9.83510732e-01+0.18084891j,  -2.91034798e-04+0.00047646j],
       [  2.91034798e-04+0.00047646j,  -9.83510732e-01-0.18084891j]]), array([[-0.97645356+0.2141316j , -0.02322294-0.01211596j],
       [ 0.02322294-0.01211596j, -0.97645356-0.2141316j ]]), array([[-0.98395902+0.17833051j, -0.00443645+0.00178886j],
       [ 0.00443645+0.00178886j, -0.98395902-0.17833051j]]), array([[-0.98039293+0.19698669j,  0.00155173-0.00485143j],
       [-0.00155173-0.00485143j, -0.98039293-0.19698669j]]), array([[-0.97972754+0.20030667j, -0.00122859+0.00311081j],
       [ 0.00122859+0.00311081j, -0.97972754-0.20030667j]]), array([[-0.97251995+0.2320339j ,  0.01821738-0.00577393j],
       [-0.01821738-0.00577393j, -0.97251995-0.2320339j ]]), array([[-0.98008094 +1.96794109e-01j, -0.02670975 -9.98787602e-05j],
       [ 0.02670975 -9.98787602e-05j, -0.98008094 -1.96794109e-01j]]), array([[-0.97448356+0.22414107j, -0.01186641+0.00132793j],
       [ 0.01186641+0.00132793j, -0.97448356-0.22414107j]]), array([[ -9.69680659e-01+0.24437291j,   5.17342471e-04-0.00101627j],
       [ -5.17342471e-04-0.00101627j,  -9.69680659e-01-0.24437291j]]), array([[-0.97207560+0.23391285j,  0.00210645-0.01869124j],
       [-0.00210645-0.01869124j, -0.97207560-0.23391285j]]), array([[-0.96861651+0.24849913j,  0.00511336-0.0020226j ],
       [-0.00511336-0.0020226j , -0.96861651-0.24849913j]]), array([[-0.95379907+0.30020567j, -0.01015689-0.00638165j],
       [ 0.01015689-0.00638165j, -0.95379907-0.30020567j]]), array([[-0.95470631+0.29697615j, -0.01561368-0.00986084j],
       [ 0.01561368-0.00986084j, -0.95470631-0.29697615j]]), array([[-0.9589339+0.28267911j, -0.0231960+0.0005011j ],
       [ 0.0231960+0.0005011j , -0.9589339-0.28267911j]]), array([[-0.94224182+0.33286866j,  0.03629676-0.00783233j],
       [-0.03629676-0.00783233j, -0.94224182-0.33286866j]]), array([[-0.95065223+0.31008608j,  0.00401764-0.00952972j],
       [-0.00401764-0.00952972j, -0.95065223-0.31008608j]]), array([[-0.94474476+0.32777148j,  0.00451320-0.00168113j],
       [-0.00451320-0.00168113j, -0.94474476-0.32777148j]]), array([[-0.94028777+0.34006323j, -0.00431430-0.01404644j],
       [ 0.00431430-0.01404644j, -0.94028777-0.34006323j]]), array([[-0.93195203+0.36207848j,  0.00782708+0.01741622j],
       [-0.00782708+0.01741622j, -0.93195203-0.36207848j]]), array([[-0.92426465+0.37902883j, -0.03398403-0.03028344j],
       [ 0.03398403-0.03028344j, -0.92426465-0.37902883j]]), array([[-0.91622727+0.39943427j, -0.01721222-0.02614581j],
       [ 0.01721222-0.02614581j, -0.91622727-0.39943427j]]), array([[-0.90018783+0.43368678j, -0.03950469-0.00412637j],
       [ 0.03950469-0.00412637j, -0.90018783-0.43368678j]]), array([[-0.89824091+0.43900245j, -0.01820706+0.0104224j ],
       [ 0.01820706+0.0104224j , -0.89824091-0.43900245j]]), array([[-0.89797306+0.43650442j, -0.02961736-0.04723432j],
       [ 0.02961736-0.04723432j, -0.89797306-0.43650442j]]), array([[-0.89707574+0.44187095j, -0.00105271+0.00201969j],
       [ 0.00105271+0.00201969j, -0.89707574-0.44187095j]]), array([[-0.88174681+0.47138351j, -0.01709787-0.00527302j],
       [ 0.01709787-0.00527302j, -0.88174681-0.47138351j]]), array([[-0.85207021 +5.22147218e-01j, -0.03658696 +1.75096023e-04j],
       [ 0.03658696 +1.75096023e-04j, -0.85207021 -5.22147218e-01j]]), array([[-0.85381694+0.52056637j,  0.00254917+0.00088673j],
       [-0.00254917+0.00088673j, -0.85381694-0.52056637j]]), array([[-0.83488282+0.54166057j,  0.09726806+0.01065001j],
       [-0.09726806+0.01065001j, -0.83488282-0.54166057j]]), array([[-0.79796927+0.60230783j, -0.02162539+0.00163428j],
       [ 0.02162539+0.00163428j, -0.79796927-0.60230783j]]), array([[-0.79601989+0.60252581j,  0.05675430+0.00969182j],
       [-0.05675430+0.00969182j, -0.79601989-0.60252581j]]), array([[-0.78411045+0.6175648j , -0.06139141-0.00395292j],
       [ 0.06139141-0.00395292j, -0.78411045-0.6175648j ]]), array([[-0.76803350+0.64023154j, -0.00969969+0.01157753j],
       [ 0.00969969+0.01157753j, -0.76803350-0.64023154j]]), array([[-0.71963238+0.68796425j, -0.06954186+0.06323254j],
       [ 0.06954186+0.06323254j, -0.71963238-0.68796425j]]), array([[-0.71269507+0.70112262j, -0.01261855+0.0182643j ],
       [ 0.01261855+0.0182643j , -0.71269507-0.70112262j]]), array([[-0.70308516 +7.11069966e-01j,  0.00712096 -2.18480384e-04j],
       [-0.00712096 -2.18480384e-04j, -0.70308516 -7.11069966e-01j]]), array([[-0.68282959+0.72908154j, -0.04669019-0.00197266j],
       [ 0.04669019-0.00197266j, -0.68282959-0.72908154j]]), array([[-0.64755716+0.75556136j, -0.09894707-0.0024973j ],
       [ 0.09894707-0.0024973j , -0.64755716-0.75556136j]]), array([[-0.61974989+0.78156906j, -0.06786162+0.0213232j ],
       [ 0.06786162+0.0213232j , -0.61974989-0.78156906j]]), array([[-0.56783395+0.81920409j, -0.01745272-0.07851541j],
       [ 0.01745272-0.07851541j, -0.56783395-0.81920409j]]), array([[-0.54283201+0.8396393j , -0.00222626+0.01828389j],
       [ 0.00222626+0.01828389j, -0.54283201-0.8396393j ]]), array([[-0.50341675+0.85616886j,  0.10434330-0.05156487j],
       [-0.10434330-0.05156487j, -0.50341675-0.85616886j]]), array([[-0.48353158+0.86287652j, -0.14708903+0.00247623j],
       [ 0.14708903+0.00247623j, -0.48353158-0.86287652j]]), array([[-0.48499975+0.86513101j, -0.12331102+0.03343602j],
       [ 0.12331102+0.03343602j, -0.48499975-0.86513101j]]), array([[-0.39082778+0.92031596j,  0.00507632-0.01569713j],
       [-0.00507632-0.01569713j, -0.39082778-0.92031596j]]), array([[-0.36026033+0.92828282j, -0.07741510+0.05010389j],
       [ 0.07741510+0.05010389j, -0.36026033-0.92828282j]]), array([[-0.33865653 +9.34945340e-01j, -0.10577695 -4.47469051e-04j],
       [ 0.10577695 -4.47469051e-04j, -0.33865653 -9.34945340e-01j]]), array([[-0.31895275+0.94776113j, -0.00412134+0.0009951j ],
       [ 0.00412134+0.0009951j , -0.31895275-0.94776113j]]), array([[-0.25320581+0.96734989j,  0.00227145-0.01076302j],
       [-0.00227145-0.01076302j, -0.25320581-0.96734989j]]), array([[-0.22129402+0.97513215j, -0.01001481-0.00677925j],
       [ 0.01001481-0.00677925j, -0.22129402-0.97513215j]]), array([[-0.14968220+0.98868009j,  0.00346233+0.00974318j],
       [-0.00346233+0.00974318j, -0.14968220-0.98868009j]]), array([[-0.1338590 +9.90998363e-01j,  0.0018829 +6.84026907e-04j],
       [-0.0018829 +6.84026907e-04j, -0.1338590 -9.90998363e-01j]]), array([[-0.10183227+0.98730032j, -0.12163132-0.00860785j],
       [ 0.12163132-0.00860785j, -0.10183227-0.98730032j]]), array([[-0.05317718+0.99046337j,  0.12620994+0.01501831j],
       [-0.12620994+0.01501831j, -0.05317718-0.99046337j]]), array([[-0.02380827+0.9981346j , -0.05615911+0.00257816j],
       [ 0.05615911+0.00257816j, -0.02380827-0.9981346j ]]), array([[ 0.02794166+0.99819016j, -0.05297704+0.00539385j],
       [ 0.05297704+0.00539385j,  0.02794166-0.99819016j]]), array([[ 0.03638038+0.99767345j, -0.05762199+0.00196268j],
       [ 0.05762199+0.00196268j,  0.03638038-0.99767345j]]), array([[ 0.08598241+0.98581804j,  0.12881943+0.06461717j],
       [-0.12881943+0.06461717j,  0.08598241-0.98581804j]]), array([[ 0.10066534+0.99467165j, -0.01204941-0.01869803j],
       [ 0.01204941-0.01869803j,  0.10066534-0.99467165j]]), array([[ 0.14165875+0.98991013j, -0.00053131-0.00323207j],
       [ 0.00053131-0.00323207j,  0.14165875-0.98991013j]]), array([[ 0.19365153+0.97728947j, -0.04002008-0.07617591j],
       [ 0.04002008-0.07617591j,  0.19365153-0.97728947j]]), array([[ 0.24531176+0.96941703j,  0.00079999+0.00721968j],
       [-0.00079999+0.00721968j,  0.24531176-0.96941703j]]), array([[ 0.22831626+0.97154427j, -0.05562708+0.02964867j],
       [ 0.05562708+0.02964867j,  0.22831626-0.97154427j]]), array([[ 0.29315490+0.95605435j, -0.00370903-0.00255527j],
       [ 0.00370903-0.00255527j,  0.29315490-0.95605435j]]), array([[ 0.31536429+0.94896249j, -0.00143891-0.00367204j],
       [ 0.00143891-0.00367204j,  0.31536429-0.94896249j]]), array([[ 0.35564387+0.93461783j,  0.00235947-0.00117578j],
       [-0.00235947-0.00117578j,  0.35564387-0.93461783j]]), array([[ 0.39259366+0.91964567j, -0.00624806+0.00911152j],
       [ 0.00624806+0.00911152j,  0.39259366-0.91964567j]]), array([[ 0.40252511+0.90565851j, -0.11852434+0.06089477j],
       [ 0.11852434+0.06089477j,  0.40252511-0.90565851j]]), array([[ 0.44855202+0.8937421j ,  0.00324414-0.00395202j],
       [-0.00324414-0.00395202j,  0.44855202-0.8937421j ]]), array([[ 0.46570422+0.88460569j,  0.00377706+0.0240433j ],
       [-0.00377706+0.0240433j ,  0.46570422-0.88460569j]]), array([[ 0.47185049+0.87411797j,  0.11499235+0.00718655j],
       [-0.11499235+0.00718655j,  0.47185049-0.87411797j]]), array([[ 0.53217386 +8.46628209e-01j,  0.00341451 -2.58944138e-05j],
       [-0.00341451 -2.58944138e-05j,  0.53217386 -8.46628209e-01j]]), array([[ 0.55016042+0.83499958j, -0.00455305-0.00885972j],
       [ 0.00455305-0.00885972j,  0.55016042-0.83499958j]]), array([[ 0.57418342+0.81872459j,  0.00154581+0.0010303j ],
       [-0.00154581+0.0010303j ,  0.57418342-0.81872459j]]), array([[ 0.60895368+0.79319656j, -0.00300414-0.00236992j],
       [ 0.00300414-0.00236992j,  0.60895368-0.79319656j]]), array([[  6.36928739e-01+0.77077041j,  -1.10229786e-04-0.01532115j],
       [  1.10229786e-04-0.01532115j,   6.36928739e-01-0.77077041j]]), array([[ 0.65006533 +7.59875081e-01j,  0.00221917 -4.74065983e-05j],
       [-0.00221917 -4.74065983e-05j,  0.65006533 -7.59875081e-01j]]), array([[  6.55931281e-01+0.75351355j,  -5.93779535e-04-0.04439738j],
       [  5.93779535e-04-0.04439738j,   6.55931281e-01-0.75351355j]]), array([[ 0.68876932+0.7249735j , -0.00186075-0.00260436j],
       [ 0.00186075-0.00260436j,  0.68876932-0.7249735j ]]), array([[ 0.71467037+0.69936967j, -0.00207907+0.01113571j],
       [ 0.00207907+0.01113571j,  0.71467037-0.69936967j]]), array([[ 0.75500135+0.652178j  ,  0.06210687-0.02792037j],
       [-0.06210687-0.02792037j,  0.75500135-0.652178j  ]]), array([[ 0.75846350+0.65165542j, -0.00273835-0.00841686j],
       [ 0.00273835-0.00841686j,  0.75846350-0.65165542j]]), array([[ 0.77741175 +6.28976558e-01j, -0.00440463 -2.56679540e-04j],
       [ 0.00440463 -2.56679540e-04j,  0.77741175 -6.28976558e-01j]]), array([[ 0.78922647+0.61365928j, -0.00154686+0.02326936j],
       [ 0.00154686+0.02326936j,  0.78922647-0.61365928j]]), array([[ 0.80914536+0.58758476j,  0.00335463+0.00408433j],
       [-0.00335463+0.00408433j,  0.80914536-0.58758476j]]), array([[ 0.81240595+0.58253127j,  0.00184805+0.02550446j],
       [-0.00184805+0.02550446j,  0.81240595-0.58253127j]]), array([[ 0.83799459+0.53960671j, -0.07697005-0.02579283j],
       [ 0.07697005-0.02579283j,  0.83799459-0.53960671j]]), array([[ 0.83485556+0.54501655j, -0.05934227+0.0495141j ],
       [ 0.05934227+0.0495141j ,  0.83485556-0.54501655j]]), array([[ 0.87521698+0.48356169j, -0.01151229-0.00554966j],
       [ 0.01151229-0.00554966j,  0.87521698-0.48356169j]]), array([[  8.81918207e-01 +4.71402455e-01j,
          2.44101939e-05 +3.89295241e-05j],
       [ -2.44101939e-05 +3.89295241e-05j,
          8.81918207e-01 -4.71402455e-01j]]), array([[ 0.89520279+0.44539239j,  0.00231746-0.01523835j],
       [-0.00231746-0.01523835j,  0.89520279-0.44539239j]]), array([[ 0.90632144+0.42256932j, -0.00373702+0.0016317j ],
       [ 0.00373702+0.0016317j ,  0.90632144-0.42256932j]]), array([[  9.13121838e-01+0.40748594j,   8.57405224e-04-0.01276653j],
       [ -8.57405224e-04-0.01276653j,   9.13121838e-01-0.40748594j]]), array([[  9.25737741e-01+0.37769747j,  -5.78043459e-04-0.01881271j],
       [  5.78043459e-04-0.01881271j,   9.25737741e-01-0.37769747j]]), array([[ 0.93221577+0.36176507j, -0.00592240+0.00804485j],
       [ 0.00592240+0.00804485j,  0.93221577-0.36176507j]]), array([[ 0.94378745+0.33030189j, -0.00994875-0.00818132j],
       [ 0.00994875-0.00818132j,  0.94378745-0.33030189j]]), array([[  9.52516807e-01+0.3044749j ,  -3.25908243e-04-0.00258039j],
       [  3.25908243e-04-0.00258039j,   9.52516807e-01-0.3044749j ]]), array([[ 0.96206448+0.27269685j, -0.00374160+0.00737381j],
       [ 0.00374160+0.00737381j,  0.96206448-0.27269685j]]), array([[ 0.96378886+0.26663955j, -0.00304097-0.00226449j],
       [ 0.00304097-0.00226449j,  0.96378886-0.26663955j]]), array([[ 0.97284688+0.23142485j, -0.00110262+0.00320479j],
       [ 0.00110262+0.00320479j,  0.97284688-0.23142485j]]), array([[ 0.97559886+0.21954625j,  0.00144990-0.00205183j],
       [-0.00144990-0.00205183j,  0.97559886-0.21954625j]]), array([[ 0.97675526+0.19982171j, -0.01174375-0.07669768j],
       [ 0.01174375-0.07669768j,  0.97675526-0.19982171j]]), array([[ 0.98953577+0.1441217j ,  0.00181253-0.00667969j],
       [-0.00181253-0.00667969j,  0.98953577-0.1441217j ]]), array([[ 0.99576887+0.09159815j,  0.00350095+0.00647089j],
       [-0.00350095+0.00647089j,  0.99576887-0.09159815j]]), array([[ 0.99661320+0.08174737j, -0.00193097+0.0087049j ],
       [ 0.00193097+0.0087049j ,  0.99661320-0.08174737j]]), array([[ 0.99181587+0.12604029j, -0.02033371+0.00128681j],
       [ 0.02033371+0.00128681j,  0.99181587-0.12604029j]]), array([[ 0.99913058+0.03283184j, -0.00179019+0.02563104j],
       [ 0.00179019+0.02563104j,  0.99913058-0.03283184j]]), array([[ 0.99991780+0.01162756j, -0.00158369-0.00516607j],
       [ 0.00158369-0.00516607j,  0.99991780-0.01162756j]]), array([[  9.99995769e-01-0.00200265j,   1.38088335e-04-0.00210529j],
       [ -1.38088335e-04-0.00210529j,   9.99995769e-01+0.00200265j]])], 'kpt': [[0.0, 0.0, 0], [0.0016447368421052631, 0.0, 0], [0.0032894736842105261, 0.0, 0], [0.0049342105263157892, 0.0, 0], [0.0065789473684210523, 0.0, 0], [0.0082236842105263153, 0.0, 0], [0.0098684210526315784, 0.0, 0], [0.011513157894736841, 0.0, 0], [0.013157894736842105, 0.0, 0], [0.014802631578947368, 0.0, 0], [0.016447368421052631, 0.0, 0], [0.018092105263157895, 0.0, 0], [0.019736842105263157, 0.0, 0], [0.021381578947368418, 0.0, 0], [0.023026315789473683, 0.0, 0], [0.024671052631578948, 0.0, 0], [0.026315789473684209, 0.0, 0], [0.02796052631578947, 0.0, 0], [0.029605263157894735, 0.0, 0], [0.03125, 0.0, 0], [0.032894736842105261, 0.0, 0], [0.034539473684210523, 0.0, 0], [0.036184210526315791, 0.0, 0], [0.037828947368421052, 0.0, 0], [0.039473684210526314, 0.0, 0], [0.041118421052631575, 0.0, 0], [0.042763157894736836, 0.0, 0], [0.044407894736842105, 0.0, 0], [0.046052631578947366, 0.0, 0], [0.047697368421052627, 0.0, 0], [0.049342105263157895, 0.0, 0], [0.050986842105263157, 0.0, 0], [0.052631578947368418, 0.0, 0], [0.054276315789473679, 0.0, 0], [0.055921052631578941, 0.0, 0], [0.057565789473684209, 0.0, 0], [0.05921052631578947, 0.0, 0], [0.060855263157894732, 0.0, 0], [0.0625, 0.0, 0], [0.064144736842105254, 0.0, 0], [0.065789473684210523, 0.0, 0], [0.067434210526315791, 0.0, 0], [0.069078947368421045, 0.0, 0], [0.070723684210526314, 0.0, 0], [0.072368421052631582, 0.0, 0], [0.074013157894736836, 0.0, 0], [0.075657894736842105, 0.0, 0], [0.077302631578947373, 0.0, 0], [0.078947368421052627, 0.0, 0], [0.080592105263157882, 0.0, 0], [0.08223684210526315, 0.0, 0], [0.083881578947368418, 0.0, 0], [0.085526315789473673, 0.0, 0], [0.087171052631578941, 0.0, 0], [0.088815789473684209, 0.0, 0], [0.090460526315789463, 0.0, 0], [0.092105263157894732, 0.0, 0], [0.09375, 0.0, 0], [0.095394736842105254, 0.0, 0], [0.097039473684210523, 0.0, 0], [0.098684210526315791, 0.0, 0], [0.10032894736842105, 0.0, 0], [0.10197368421052631, 0.0, 0], [0.10361842105263158, 0.0, 0], [0.10526315789473684, 0.0, 0], [0.10690789473684209, 0.0, 0], [0.10855263157894736, 0.0, 0], [0.11019736842105263, 0.0, 0], [0.11184210526315788, 0.0, 0], [0.11348684210526315, 0.0, 0], [0.11513157894736842, 0.0, 0], [0.11677631578947367, 0.0, 0], [0.11842105263157894, 0.0, 0], [0.12006578947368421, 0.0, 0], [0.12171052631578946, 0.0, 0], [0.12335526315789473, 0.0, 0], [0.125, 0.0, 0], [0.12664473684210525, 0.0, 0], [0.12828947368421051, 0.0, 0], [0.12993421052631576, 0.0, 0], [0.13157894736842105, 0.0, 0], [0.13322368421052633, 0.0, 0], [0.13486842105263158, 0.0, 0], [0.13651315789473684, 0.0, 0], [0.13815789473684209, 0.0, 0], [0.13980263157894735, 0.0, 0], [0.14144736842105263, 0.0, 0], [0.14309210526315791, 0.0, 0], [0.14473684210526316, 0.0, 0], [0.14638157894736842, 0.0, 0], [0.14802631578947367, 0.0, 0], [0.14967105263157893, 0.0, 0], [0.15131578947368421, 0.0, 0], [0.15296052631578949, 0.0, 0], [0.15460526315789475, 0.0, 0], [0.15625, 0.0, 0], [0.15789473684210525, 0.0, 0], [0.15953947368421051, 0.0, 0], [0.16118421052631576, 0.0, 0], [0.16282894736842102, 0.0, 0], [0.1644736842105263, 0.0, 0], [0.16611842105263158, 0.0, 0], [0.16776315789473684, 0.0, 0], [0.16940789473684209, 0.0, 0], [0.17105263157894735, 0.0, 0], [0.1726973684210526, 0.0, 0], [0.17434210526315788, 0.0, 0], [0.17598684210526316, 0.0, 0], [0.17763157894736842, 0.0, 0], [0.17927631578947367, 0.0, 0], [0.18092105263157893, 0.0, 0], [0.18256578947368418, 0.0, 0], [0.18421052631578946, 0.0, 0], [0.18585526315789475, 0.0, 0], [0.1875, 0.0, 0], [0.18914473684210525, 0.0, 0], [0.19078947368421051, 0.0, 0], [0.19243421052631576, 0.0, 0], [0.19407894736842105, 0.0, 0], [0.19572368421052633, 0.0, 0], [0.19736842105263158, 0.0, 0], [0.19901315789473684, 0.0, 0], [0.20065789473684209, 0.0, 0], [0.20230263157894735, 0.0, 0], [0.20394736842105263, 0.0, 0], [0.20559210526315791, 0.0, 0], [0.20723684210526316, 0.0, 0], [0.20888157894736842, 0.0, 0], [0.21052631578947367, 0.0, 0], [0.21217105263157893, 0.0, 0], [0.21381578947368418, 0.0, 0], [0.21546052631578944, 0.0, 0], [0.21710526315789472, 0.0, 0], [0.21875, 0.0, 0], [0.22039473684210525, 0.0, 0], [0.22203947368421051, 0.0, 0], [0.22368421052631576, 0.0, 0], [0.22532894736842102, 0.0, 0], [0.2269736842105263, 0.0, 0], [0.22861842105263158, 0.0, 0], [0.23026315789473684, 0.0, 0], [0.23190789473684209, 0.0, 0], [0.23355263157894735, 0.0, 0], [0.2351973684210526, 0.0, 0], [0.23684210526315788, 0.0, 0], [0.23848684210526316, 0.0, 0], [0.24013157894736842, 0.0, 0], [0.24177631578947367, 0.0, 0], [0.24342105263157893, 0.0, 0], [0.24506578947368418, 0.0, 0], [0.24671052631578946, 0.0, 0], [0.24835526315789475, 0.0, 0], [0.25, 0.0, 0], [0.25164473684210525, 0.0, 0], [0.25328947368421051, 0.0, 0], [0.25493421052631576, 0.0, 0], [0.25657894736842102, 0.0, 0], [0.25822368421052627, 0.0, 0], [0.25986842105263153, 0.0, 0], [0.26151315789473684, 0.0, 0], [0.26315789473684209, 0.0, 0], [0.26480263157894735, 0.0, 0], [0.26644736842105265, 0.0, 0], [0.26809210526315791, 0.0, 0], [0.26973684210526316, 0.0, 0], [0.27138157894736842, 0.0, 0], [0.27302631578947367, 0.0, 0], [0.27467105263157893, 0.0, 0], [0.27631578947368418, 0.0, 0], [0.27796052631578944, 0.0, 0], [0.27960526315789469, 0.0, 0], [0.28125, 0.0, 0], [0.28289473684210525, 0.0, 0], [0.28453947368421051, 0.0, 0], [0.28618421052631582, 0.0, 0], [0.28782894736842107, 0.0, 0], [0.28947368421052633, 0.0, 0], [0.29111842105263158, 0.0, 0], [0.29276315789473684, 0.0, 0], [0.29440789473684209, 0.0, 0], [0.29605263157894735, 0.0, 0], [0.2976973684210526, 0.0, 0], [0.29934210526315785, 0.0, 0], [0.30098684210526316, 0.0, 0], [0.30263157894736842, 0.0, 0], [0.30427631578947367, 0.0, 0], [0.30592105263157898, 0.0, 0], [0.30756578947368424, 0.0, 0], [0.30921052631578949, 0.0, 0], [0.31085526315789475, 0.0, 0], [0.3125, 0.0, 0], [0.31414473684210525, 0.0, 0], [0.31578947368421051, 0.0, 0], [0.31743421052631576, 0.0, 0], [0.31907894736842102, 0.0, 0], [0.32072368421052627, 0.0, 0], [0.32236842105263153, 0.0, 0], [0.32401315789473678, 0.0, 0], [0.32565789473684204, 0.0, 0], [0.32730263157894735, 0.0, 0], [0.3289473684210526, 0.0, 0], [0.33059210526315785, 0.0, 0], [0.33223684210526316, 0.0, 0], [0.33388157894736842, 0.0, 0], [0.33552631578947367, 0.0, 0], [0.33717105263157893, 0.0, 0], [0.33881578947368418, 0.0, 0], [0.34046052631578944, 0.0, 0], [0.34210526315789469, 0.0, 0], [0.34374999999999994, 0.0, 0], [0.3453947368421052, 0.0, 0], [0.34703947368421051, 0.0, 0], [0.34868421052631576, 0.0, 0], [0.35032894736842102, 0.0, 0], [0.35197368421052633, 0.0, 0], [0.35361842105263158, 0.0, 0], [0.35526315789473684, 0.0, 0], [0.35690789473684209, 0.0, 0], [0.35855263157894735, 0.0, 0], [0.3601973684210526, 0.0, 0], [0.36184210526315785, 0.0, 0], [0.36348684210526311, 0.0, 0], [0.36513157894736836, 0.0, 0], [0.36677631578947367, 0.0, 0], [0.36842105263157893, 0.0, 0], [0.37006578947368418, 0.0, 0], [0.37171052631578949, 0.0, 0], [0.37335526315789475, 0.0, 0], [0.375, 0.0, 0], [0.37664473684210525, 0.0, 0], [0.37828947368421051, 0.0, 0], [0.37993421052631576, 0.0, 0], [0.38157894736842102, 0.0, 0], [0.38322368421052627, 0.0, 0], [0.38486842105263153, 0.0, 0], [0.38651315789473684, 0.0, 0], [0.38815789473684209, 0.0, 0], [0.38980263157894735, 0.0, 0], [0.39144736842105265, 0.0, 0], [0.39309210526315791, 0.0, 0], [0.39473684210526316, 0.0, 0], [0.39638157894736842, 0.0, 0], [0.39802631578947367, 0.0, 0], [0.39967105263157893, 0.0, 0], [0.40131578947368418, 0.0, 0], [0.40296052631578944, 0.0, 0], [0.40460526315789469, 0.0, 0], [0.40625, 0.0, 0], [0.40789473684210525, 0.0, 0], [0.40953947368421051, 0.0, 0], [0.41118421052631582, 0.0, 0], [0.41282894736842107, 0.0, 0], [0.41447368421052633, 0.0, 0], [0.41611842105263158, 0.0, 0], [0.41776315789473684, 0.0, 0], [0.41940789473684209, 0.0, 0], [0.42105263157894735, 0.0, 0], [0.4226973684210526, 0.0, 0], [0.42434210526315785, 0.0, 0], [0.42598684210526311, 0.0, 0], [0.42763157894736836, 0.0, 0], [0.42927631578947362, 0.0, 0], [0.43092105263157887, 0.0, 0], [0.43256578947368418, 0.0, 0], [0.43421052631578944, 0.0, 0], [0.43585526315789469, 0.0, 0], [0.4375, 0.0, 0], [0.43914473684210525, 0.0, 0], [0.44078947368421051, 0.0, 0], [0.44243421052631576, 0.0, 0], [0.44407894736842102, 0.0, 0], [0.44572368421052627, 0.0, 0], [0.44736842105263153, 0.0, 0], [0.44901315789473678, 0.0, 0], [0.45065789473684204, 0.0, 0], [0.45230263157894735, 0.0, 0], [0.4539473684210526, 0.0, 0], [0.45559210526315785, 0.0, 0], [0.45723684210526316, 0.0, 0], [0.45888157894736842, 0.0, 0], [0.46052631578947367, 0.0, 0], [0.46217105263157893, 0.0, 0], [0.46381578947368418, 0.0, 0], [0.46546052631578944, 0.0, 0], [0.46710526315789469, 0.0, 0], [0.46874999999999994, 0.0, 0], [0.4703947368421052, 0.0, 0], [0.47203947368421051, 0.0, 0], [0.47368421052631576, 0.0, 0], [0.47532894736842102, 0.0, 0], [0.47697368421052633, 0.0, 0], [0.47861842105263158, 0.0, 0], [0.48026315789473684, 0.0, 0], [0.48190789473684209, 0.0, 0], [0.48355263157894735, 0.0, 0], [0.4851973684210526, 0.0, 0], [0.48684210526315785, 0.0, 0], [0.48848684210526311, 0.0, 0], [0.49013157894736836, 0.0, 0], [0.49177631578947367, 0.0, 0], [0.49342105263157893, 0.0, 0], [0.49506578947368418, 0.0, 0], [0.49671052631578949, 0.0, 0], [0.49835526315789475, 0.0, 0], [0.5, 0.0, 0]], 'gap': [0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.99999999999999989, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.99999999999999989, 0.99999999999999989, 0.0, 0.99999999999999989, 0.99999999999999978, 0.0, 0.0, 0.99999999999999989, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.2204460492503131e-16, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.99999999999999989, 0.99999999999999989, 0.0, 0.99999999999999989, 0.0, 0.0, 0.99999999999999989, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.99999999999999989, 0.0, 0.0, 0.99999999999999989, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.99999999999999989, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.99999999999999989, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.99999999999999989, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.99999999999999978, 0.99999999999999978, 0.99999999999999989, 0.99999999999999989, 0.99999999999999989, 0.99999999999999978, 0.0, 0.0, 0.0, 0.99999999999999978, 0.99999999999999989, 0.99999999999999978, 0.0, 0.99999999999999989, 0.0, 0.0, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.99999999999999978, 0.99999999999999989, 0.0, 0.0, 0.99999999999999989, 0.99999999999999989, 0.99999999999999989, 0.0, 0.0, 0.0, 0.0, 0.49999999999999994, 0.5, 0.5, 0.49999999999999983, 0.5, 0.5, 0.5, 0.49999999999999989, 0.50000000000000011, 0.5, 0.5, 0.49999999999999989, 0.5, 0.5, 0.49999999999999994, 0.49999999999999989, 0.5, 0.49999999999999994, 0.49999999999999994, 0.5, 0.49999999999999983, 0.50000000000000011, 0.49999999999999994, 0.49999999999999994, 0.5, 0.49999999999999994, 0.5, 0.49999999999999994, 0.5, 0.5, 0.49999999999999994, 0.5, 0.5, 0.5, 0.49999999999999989, 0.49999999999999989, 0.49999999999999989, 0.5, 0.49999999999999994, 0.49999999999999994, 0.5, 0.49999999999999994, 0.5, 0.5, 0.5, 0.5, 0.5, 0.49999999999999989, 0.5, 0.49999999999999994, 0.5, 0.5, 0.50000000000000011, 0.50000000000000022]}

        self.assertFullAlmostEqual(tb_surface.get_res(), res)

    def test_warning(self):
        """ test the warning that is given when string_vec != None"""
        self.createH(0.1, 0.3)
        # call to Z2Pack
        tb_system = z2pack.em.tb.System(self.model)
        with warnings.catch_warnings(record=True) as w:
            warnings.simplefilter('always')
            tb_surface = tb_system.surface(lambda kx: [kx / 2, 0, 0], [0, 1, 0])
            assert len(w) == 1
            assert w[-1].category == DeprecationWarning
            assert "string_vec" in str(w[-1].message)

    def test_saveload(self):
        self.createH(0.1, 0.3)
        tb_system = z2pack.em.tb.System(self.model)
        surface1 = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0], pickle_file=self._build_folder + '/tb_pickle.txt')
        surface2 = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0], pickle_file=self._build_folder + '/tb_pickle.txt')
        surface1.wcc_calc(verbose=False)
        surface2.load()
        self.assertFullAlmostEqual(surface1.get_res(), surface2.get_res())

    def testkwargcheck1(self):
        """ test kwarg check on wcc_calc """
        self.createH(0.1, 0.3)
        # call to Z2Pack
        tb_system = z2pack.em.tb.System(self.model)
        tb_surface = tb_system.surface(lambda kx, ky: [kx / 2, ky, 0])
        self.assertRaises(
            TypeError,
            tb_surface.wcc_calc,
            invalid_kwarg = 3)

    def testkwargcheck2(self):
        """ test kwarg check on __init__ """
        self.createH(0, 0.3)
        # call to Z2Pack
        tb_system = z2pack.em.tb.System(self.model)
        self.assertRaises(
            TypeError,
            tb_system.surface,
            1, 2, 0, invalid_kwarg = 3)

if __name__ == "__main__":
    unittest.main()
